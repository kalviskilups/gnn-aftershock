2025-04-15 19:57:35,689 - INFO - Logging to logs/hyperparameter_tuning_20250415_195735.log
2025-04-15 19:57:35,690 - INFO - Starting hyperparameter optimization...
[I 2025-04-15 19:57:36,229] A new study created in RDB with name: earthquake_gnn_tuning
2025-04-15 19:57:36,397 - INFO - 
Trial 0:
2025-04-15 19:57:36,398 - INFO - Graph params: time_window=168, spatial_threshold=100, min_connections=2
2025-04-15 19:57:36,398 - INFO - Model params: gnn_type=gat, hidden_dim=256, num_layers=6
2025-04-15 19:57:36,398 - INFO - Training params: lr=0.007361112023714301, batch_size=8, weight_decay=1.022567344710794e-06
2025-04-15 19:57:36,675 - INFO - Creating graphs with time_window=168h, spatial_threshold=100km, min_connections=2...
Creating causal relative spatiotemporal graphs (time window: 168h, spatial threshold: 100km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 124.30it/s]  7%|▋         | 27/411 [00:00<00:02, 130.22it/s] 10%|▉         | 41/411 [00:00<00:02, 124.33it/s] 13%|█▎        | 54/411 [00:00<00:02, 125.77it/s] 17%|█▋        | 68/411 [00:00<00:02, 126.16it/s] 20%|█▉        | 81/411 [00:00<00:02, 124.54it/s] 23%|██▎       | 95/411 [00:00<00:02, 127.46it/s] 26%|██▋       | 108/411 [00:00<00:02, 126.21it/s] 29%|██▉       | 121/411 [00:00<00:02, 122.80it/s] 33%|███▎      | 134/411 [00:01<00:02, 122.98it/s] 36%|███▌      | 147/411 [00:01<00:02, 122.63it/s] 39%|███▉      | 160/411 [00:01<00:02, 121.44it/s] 42%|████▏     | 173/411 [00:01<00:01, 119.05it/s] 45%|████▌     | 186/411 [00:01<00:01, 119.41it/s] 49%|████▊     | 200/411 [00:01<00:01, 122.37it/s] 52%|█████▏    | 213/411 [00:01<00:01, 122.38it/s] 55%|█████▍    | 226/411 [00:01<00:01, 121.61it/s] 58%|█████▊    | 239/411 [00:01<00:01, 122.61it/s] 61%|██████▏   | 252/411 [00:02<00:01, 122.62it/s] 65%|██████▍   | 266/411 [00:02<00:01, 126.33it/s] 68%|██████▊   | 279/411 [00:02<00:01, 124.03it/s] 71%|███████▏  | 293/411 [00:02<00:00, 126.24it/s] 74%|███████▍  | 306/411 [00:02<00:00, 116.39it/s] 78%|███████▊  | 319/411 [00:02<00:00, 118.59it/s] 81%|████████  | 331/411 [00:02<00:00, 118.18it/s] 83%|████████▎ | 343/411 [00:02<00:00, 116.06it/s] 86%|████████▋ | 355/411 [00:02<00:00, 115.51it/s] 90%|████████▉ | 369/411 [00:03<00:00, 120.76it/s] 93%|█████████▎| 382/411 [00:03<00:00, 118.79it/s] 96%|█████████▌| 395/411 [00:03<00:00, 119.91it/s] 99%|█████████▉| 408/411 [00:03<00:00, 121.18it/s]100%|██████████| 411/411 [00:03<00:00, 121.72it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 11%|█         | 46/409 [00:00<00:00, 454.82it/s] 22%|██▏       | 92/409 [00:00<00:00, 344.12it/s] 33%|███▎      | 135/409 [00:00<00:00, 375.12it/s] 43%|████▎     | 174/409 [00:00<00:00, 311.29it/s] 51%|█████     | 208/409 [00:00<00:00, 268.41it/s] 58%|█████▊    | 237/409 [00:00<00:00, 264.51it/s] 65%|██████▍   | 265/409 [00:00<00:00, 239.40it/s] 71%|███████   | 290/409 [00:01<00:00, 207.08it/s] 76%|███████▋  | 312/409 [00:01<00:00, 183.90it/s] 81%|████████  | 332/409 [00:01<00:00, 166.99it/s] 86%|████████▌ | 350/409 [00:01<00:00, 152.44it/s] 89%|████████▉ | 366/409 [00:01<00:00, 148.07it/s] 93%|█████████▎| 382/409 [00:01<00:00, 149.13it/s] 98%|█████████▊| 400/409 [00:01<00:00, 154.65it/s]100%|██████████| 409/409 [00:01<00:00, 208.53it/s]
2025-04-15 19:57:42,037 - INFO - Created 406 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 19:57:42,216 - INFO - Training GAT model...
2025-04-15 19:57:42,216 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 19:57:46,477 - INFO - Epoch 1/50, Train Loss: 63.4607, Val Loss: 70.2021
2025-04-15 19:57:50,636 - INFO - Epoch 2/50, Train Loss: 62.3447, Val Loss: 74.8722
2025-04-15 19:57:54,683 - INFO - Epoch 3/50, Train Loss: 62.4140, Val Loss: 72.1557
2025-04-15 19:57:58,942 - INFO - Epoch 4/50, Train Loss: 58.3671, Val Loss: 69.8310
2025-04-15 19:58:03,298 - INFO - Epoch 5/50, Train Loss: 57.8380, Val Loss: 68.1892
2025-04-15 19:58:07,485 - INFO - Epoch 6/50, Train Loss: 56.9555, Val Loss: 69.7804
2025-04-15 19:58:11,278 - INFO - Epoch 7/50, Train Loss: 57.4236, Val Loss: 72.0950
[W 2025-04-15 19:58:11,709] Trial 0 failed with parameters: {'time_window': 168, 'spatial_threshold': 100, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 256, 'num_layers': 6, 'learning_rate': 0.007361112023714301, 'batch_size': 8, 'weight_decay': 1.022567344710794e-06} because of the following error: KeyboardInterrupt().
Traceback (most recent call last):
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/hyperparameter.py", line 123, in objective
    predictor.train(num_epochs=50, patience=10)
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/relative_gnn.py", line 1079, in train
    train_loss = self.train_epoch()
                 ^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/relative_gnn.py", line 857, in train_epoch
    pred = self.model(data)
           ^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/relative_gnn.py", line 640, in forward
    x = self.conv1(x, edge_index, edge_weight)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/nn/conv/gat_conv.py", line 335, in forward
    alpha_src = (x_src * self.att_src).sum(dim=-1)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[W 2025-04-15 19:58:11,711] Trial 0 failed with value None.
2025-04-15 19:58:11,711 - INFO - Optimization interrupted by user.
2025-04-15 19:58:11,711 - INFO - 
Optimization completed in 0.01 hours
2025-04-15 19:58:11,711 - INFO - 
Best hyperparameters:
Created 406 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 284, Val: 61, Test: 61 graphs
Traceback (most recent call last):
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/hyperparameter.py", line 282, in <module>
    main()
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/hyperparameter.py", line 191, in main
    for key, value in study.best_params.items():
                      ^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/optuna/study/study.py", line 119, in best_params
    return self.best_trial.params
           ^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/optuna/study/study.py", line 162, in best_trial
    best_trial = self._storage.get_best_trial(self._study_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/optuna/storages/_cached_storage.py", line 180, in get_best_trial
    return self._backend.get_best_trial(study_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/optuna/storages/_rdb/storage.py", line 909, in get_best_trial
    trial_id = models.TrialModel.find_min_value_trial_id(study_id, 0, session)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/optuna/storages/_rdb/models.py", line 236, in find_min_value_trial_id
    raise ValueError(NOT_FOUND_MSG)
ValueError: Record does not exist.
2025-04-15 20:00:08,502 - INFO - Logging to logs/hyperparameter_tuning_20250415_200008.log
2025-04-15 20:00:08,502 - INFO - Starting hyperparameter optimization...
[I 2025-04-15 20:00:09,034] A new study created in RDB with name: earthquake_gnn_tuning
2025-04-15 20:00:09,222 - INFO - 
Trial 0:
2025-04-15 20:00:09,222 - INFO - Graph params: time_window=336, spatial_threshold=50, min_connections=7
2025-04-15 20:00:09,222 - INFO - Model params: gnn_type=gat, hidden_dim=256, num_layers=5
2025-04-15 20:00:09,222 - INFO - Training params: lr=0.005093910212039314, batch_size=16, weight_decay=4.4612758642334126e-05
2025-04-15 20:00:09,511 - INFO - Creating graphs with time_window=336h, spatial_threshold=50km, min_connections=7...
Creating causal relative spatiotemporal graphs (time window: 336h, spatial threshold: 50km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 121.06it/s]  6%|▋         | 26/411 [00:00<00:03, 122.90it/s]  9%|▉         | 39/411 [00:00<00:03, 123.72it/s] 13%|█▎        | 53/411 [00:00<00:02, 126.10it/s] 16%|█▋        | 67/411 [00:00<00:02, 126.90it/s] 19%|█▉        | 80/411 [00:00<00:02, 123.26it/s] 23%|██▎       | 94/411 [00:00<00:02, 124.91it/s] 26%|██▌       | 107/411 [00:00<00:02, 121.61it/s] 29%|██▉       | 120/411 [00:00<00:02, 118.36it/s] 32%|███▏      | 132/411 [00:01<00:02, 118.59it/s] 35%|███▌      | 144/411 [00:01<00:02, 118.07it/s] 38%|███▊      | 156/411 [00:01<00:02, 117.11it/s] 41%|████      | 168/411 [00:01<00:02, 114.99it/s] 44%|████▍     | 181/411 [00:01<00:01, 116.96it/s] 47%|████▋     | 193/411 [00:01<00:01, 117.20it/s] 50%|████▉     | 205/411 [00:01<00:01, 117.22it/s] 53%|█████▎    | 218/411 [00:01<00:01, 118.42it/s] 56%|█████▌    | 230/411 [00:01<00:01, 117.41it/s] 59%|█████▉    | 243/411 [00:02<00:01, 119.62it/s] 62%|██████▏   | 255/411 [00:02<00:01, 117.29it/s] 65%|██████▌   | 268/411 [00:02<00:01, 120.21it/s] 68%|██████▊   | 281/411 [00:02<00:01, 120.18it/s] 72%|███████▏  | 294/411 [00:02<00:00, 117.91it/s] 74%|███████▍  | 306/411 [00:02<00:00, 113.62it/s] 78%|███████▊  | 319/411 [00:02<00:00, 114.59it/s] 81%|████████  | 331/411 [00:02<00:00, 114.61it/s] 83%|████████▎ | 343/411 [00:02<00:00, 113.60it/s] 86%|████████▋ | 355/411 [00:03<00:00, 110.27it/s] 90%|████████▉ | 369/411 [00:03<00:00, 115.10it/s] 93%|█████████▎| 381/411 [00:03<00:00, 114.20it/s] 96%|█████████▌| 393/411 [00:03<00:00, 115.68it/s] 99%|█████████▉| 406/411 [00:03<00:00, 118.49it/s]100%|██████████| 411/411 [00:03<00:00, 117.93it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 13%|█▎        | 54/409 [00:00<00:00, 528.68it/s] 26%|██▌       | 107/409 [00:00<00:00, 312.86it/s] 35%|███▌      | 144/409 [00:00<00:00, 308.02it/s] 44%|████▎     | 178/409 [00:00<00:00, 265.67it/s] 51%|█████     | 207/409 [00:00<00:00, 233.35it/s] 57%|█████▋    | 232/409 [00:00<00:00, 207.30it/s] 62%|██████▏   | 254/409 [00:01<00:00, 186.63it/s] 67%|██████▋   | 274/409 [00:01<00:00, 177.12it/s] 71%|███████▏  | 292/409 [00:01<00:00, 167.74it/s] 76%|███████▌  | 309/409 [00:01<00:00, 158.11it/s] 79%|███████▉  | 325/409 [00:01<00:00, 146.46it/s] 83%|████████▎ | 340/409 [00:01<00:00, 137.84it/s] 87%|████████▋ | 354/409 [00:01<00:00, 128.64it/s] 90%|████████▉ | 367/409 [00:01<00:00, 120.37it/s] 93%|█████████▎| 379/409 [00:02<00:00, 114.94it/s] 96%|█████████▌| 391/409 [00:02<00:00, 112.71it/s] 99%|█████████▊| 403/409 [00:02<00:00, 111.71it/s]100%|██████████| 409/409 [00:02<00:00, 171.32it/s]
2025-04-15 20:00:15,408 - INFO - Created 313 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:00:15,559 - INFO - Training GAT model...
2025-04-15 20:00:15,559 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:00:16,828 - INFO - Epoch 1/50, Train Loss: 48.5151, Val Loss: 56.9939
2025-04-15 20:00:19,193 - INFO - Epoch 2/50, Train Loss: 45.1632, Val Loss: 42.1099
2025-04-15 20:00:21,237 - INFO - Epoch 3/50, Train Loss: 40.8464, Val Loss: 48.2106
2025-04-15 20:00:23,181 - INFO - Epoch 4/50, Train Loss: 39.1588, Val Loss: 43.7282
2025-04-15 20:00:25,140 - INFO - Epoch 5/50, Train Loss: 34.9437, Val Loss: 36.6681
2025-04-15 20:00:27,097 - INFO - Epoch 6/50, Train Loss: 31.5991, Val Loss: 32.7341
2025-04-15 20:00:29,242 - INFO - Epoch 7/50, Train Loss: 35.0585, Val Loss: 34.3315
2025-04-15 20:00:31,204 - INFO - Epoch 8/50, Train Loss: 32.6879, Val Loss: 27.3032
2025-04-15 20:00:33,012 - INFO - Epoch 9/50, Train Loss: 34.6950, Val Loss: 29.5135
2025-04-15 20:00:34,684 - INFO - Epoch 10/50, Train Loss: 33.3987, Val Loss: 33.8399
2025-04-15 20:00:36,443 - INFO - Epoch 11/50, Train Loss: 32.9833, Val Loss: 35.8585
2025-04-15 20:00:38,275 - INFO - Epoch 12/50, Train Loss: 32.0862, Val Loss: 29.7397
2025-04-15 20:00:39,957 - INFO - Epoch 13/50, Train Loss: 32.4693, Val Loss: 34.9085
2025-04-15 20:00:41,671 - INFO - Epoch 14/50, Train Loss: 34.5265, Val Loss: 36.8372
2025-04-15 20:00:43,346 - INFO - Epoch 15/50, Train Loss: 31.5303, Val Loss: 32.1488
2025-04-15 20:00:45,097 - INFO - Epoch 16/50, Train Loss: 32.6775, Val Loss: 32.6027
2025-04-15 20:00:46,774 - INFO - Epoch 17/50, Train Loss: 32.7393, Val Loss: 30.6693
2025-04-15 20:00:48,422 - INFO - Epoch 18/50, Train Loss: 28.3112, Val Loss: 28.4764
2025-04-15 20:00:48,422 - INFO - Early stopping at epoch 18. Best epoch: 8
2025-04-15 20:00:49,063 - INFO - Validation metrics - Horizontal: 25.20km, Depth: 8.43km, 3D: 27.30km
[I 2025-04-15 20:00:49,097] Trial 0 finished with value: 25.201162338256836 and parameters: {'time_window': 336, 'spatial_threshold': 50, 'min_connections': 7, 'gnn_type': 'gat', 'hidden_dim': 256, 'num_layers': 5, 'learning_rate': 0.005093910212039314, 'batch_size': 16, 'weight_decay': 4.4612758642334126e-05}. Best is trial 0 with value: 25.201162338256836.
2025-04-15 20:00:49,235 - INFO - 
Trial 1:
2025-04-15 20:00:49,236 - INFO - Graph params: time_window=72, spatial_threshold=75, min_connections=2
2025-04-15 20:00:49,236 - INFO - Model params: gnn_type=sage, hidden_dim=128, num_layers=4
2025-04-15 20:00:49,236 - INFO - Training params: lr=0.00021132888166025833, batch_size=32, weight_decay=3.874448320452052e-06
2025-04-15 20:00:49,285 - INFO - Creating graphs with time_window=72h, spatial_threshold=75km, min_connections=2...
Created 313 causal graphs
First graph has 8 nodes and 7 edges
Chronological split - Train: 219, Val: 47, Test: 47 graphs
Creating causal relative spatiotemporal graphs (time window: 72h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 125.43it/s]  7%|▋         | 27/411 [00:00<00:02, 133.58it/s] 10%|▉         | 41/411 [00:00<00:02, 130.92it/s] 13%|█▎        | 55/411 [00:00<00:02, 127.78it/s] 17%|█▋        | 68/411 [00:00<00:02, 128.27it/s] 20%|█▉        | 81/411 [00:00<00:02, 126.47it/s] 23%|██▎       | 95/411 [00:00<00:02, 128.28it/s] 26%|██▋       | 108/411 [00:00<00:02, 126.46it/s] 29%|██▉       | 121/411 [00:00<00:02, 122.58it/s] 33%|███▎      | 134/411 [00:01<00:02, 122.20it/s] 36%|███▌      | 147/411 [00:01<00:02, 122.19it/s] 39%|███▉      | 160/411 [00:01<00:02, 121.85it/s] 42%|████▏     | 173/411 [00:01<00:01, 120.06it/s] 45%|████▌     | 186/411 [00:01<00:01, 120.56it/s] 49%|████▊     | 200/411 [00:01<00:01, 123.33it/s] 52%|█████▏    | 213/411 [00:01<00:01, 123.94it/s] 55%|█████▍    | 226/411 [00:01<00:01, 122.86it/s] 58%|█████▊    | 239/411 [00:01<00:01, 122.50it/s] 61%|██████▏   | 252/411 [00:02<00:01, 122.52it/s] 65%|██████▍   | 266/411 [00:02<00:01, 126.57it/s] 68%|██████▊   | 279/411 [00:02<00:01, 125.17it/s] 71%|███████   | 292/411 [00:02<00:00, 126.27it/s] 74%|███████▍  | 305/411 [00:02<00:00, 120.75it/s] 77%|███████▋  | 318/411 [00:02<00:00, 122.80it/s] 81%|████████  | 331/411 [00:02<00:00, 120.99it/s] 84%|████████▎ | 344/411 [00:02<00:00, 118.18it/s] 87%|████████▋ | 356/411 [00:02<00:00, 117.20it/s] 90%|█████████ | 370/411 [00:02<00:00, 122.23it/s] 93%|█████████▎| 383/411 [00:03<00:00, 121.50it/s] 96%|█████████▋| 396/411 [00:03<00:00, 121.27it/s]100%|█████████▉| 409/411 [00:03<00:00, 123.41it/s]100%|██████████| 411/411 [00:03<00:00, 123.28it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 17%|█▋        | 69/409 [00:00<00:00, 685.27it/s] 34%|███▍      | 140/409 [00:00<00:00, 695.53it/s] 51%|█████▏    | 210/409 [00:00<00:00, 477.44it/s] 65%|██████▍   | 264/409 [00:00<00:00, 419.09it/s] 76%|███████▌  | 310/409 [00:00<00:00, 344.90it/s] 85%|████████▌ | 348/409 [00:00<00:00, 310.38it/s] 93%|█████████▎| 382/409 [00:01<00:00, 296.16it/s]100%|██████████| 409/409 [00:01<00:00, 359.74it/s]
2025-04-15 20:00:53,778 - INFO - Created 367 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:00:53,889 - INFO - Training SAGE model...
2025-04-15 20:00:53,889 - INFO - Training Causal Relative GNN model (sage) for 50 epochs...
2025-04-15 20:00:53,983 - INFO - Epoch 1/50, Train Loss: 61.1110, Val Loss: 74.4941
2025-04-15 20:00:54,077 - INFO - Epoch 2/50, Train Loss: 60.8643, Val Loss: 74.0134
2025-04-15 20:00:54,173 - INFO - Epoch 3/50, Train Loss: 60.5774, Val Loss: 73.5089
2025-04-15 20:00:54,272 - INFO - Epoch 4/50, Train Loss: 60.2782, Val Loss: 72.9793
2025-04-15 20:00:54,368 - INFO - Epoch 5/50, Train Loss: 59.9602, Val Loss: 72.4155
2025-04-15 20:00:54,465 - INFO - Epoch 6/50, Train Loss: 59.6633, Val Loss: 71.8269
2025-04-15 20:00:54,561 - INFO - Epoch 7/50, Train Loss: 59.2556, Val Loss: 71.2202
2025-04-15 20:00:54,654 - INFO - Epoch 8/50, Train Loss: 58.7530, Val Loss: 70.5913
2025-04-15 20:00:54,748 - INFO - Epoch 9/50, Train Loss: 58.2453, Val Loss: 69.9291
2025-04-15 20:00:54,845 - INFO - Epoch 10/50, Train Loss: 57.7537, Val Loss: 69.2548
2025-04-15 20:00:54,940 - INFO - Epoch 11/50, Train Loss: 57.2569, Val Loss: 68.5647
2025-04-15 20:00:55,034 - INFO - Epoch 12/50, Train Loss: 56.6783, Val Loss: 67.8537
2025-04-15 20:00:55,129 - INFO - Epoch 13/50, Train Loss: 56.0404, Val Loss: 67.1146
2025-04-15 20:00:55,223 - INFO - Epoch 14/50, Train Loss: 55.4600, Val Loss: 66.3594
2025-04-15 20:00:55,319 - INFO - Epoch 15/50, Train Loss: 54.6846, Val Loss: 65.5736
2025-04-15 20:00:55,413 - INFO - Epoch 16/50, Train Loss: 54.0623, Val Loss: 64.7561
2025-04-15 20:00:55,508 - INFO - Epoch 17/50, Train Loss: 53.3771, Val Loss: 63.9435
2025-04-15 20:00:55,601 - INFO - Epoch 18/50, Train Loss: 52.6363, Val Loss: 63.1139
2025-04-15 20:00:55,696 - INFO - Epoch 19/50, Train Loss: 52.0418, Val Loss: 62.2686
2025-04-15 20:00:55,791 - INFO - Epoch 20/50, Train Loss: 51.0582, Val Loss: 61.4197
2025-04-15 20:00:55,885 - INFO - Epoch 21/50, Train Loss: 50.3241, Val Loss: 60.5633
2025-04-15 20:00:55,980 - INFO - Epoch 22/50, Train Loss: 49.6595, Val Loss: 59.7173
2025-04-15 20:00:56,075 - INFO - Epoch 23/50, Train Loss: 48.9220, Val Loss: 58.8347
2025-04-15 20:00:56,173 - INFO - Epoch 24/50, Train Loss: 48.2497, Val Loss: 58.0175
2025-04-15 20:00:56,268 - INFO - Epoch 25/50, Train Loss: 47.3815, Val Loss: 57.2444
2025-04-15 20:00:56,361 - INFO - Epoch 26/50, Train Loss: 46.6834, Val Loss: 56.5500
2025-04-15 20:00:56,455 - INFO - Epoch 27/50, Train Loss: 46.1552, Val Loss: 55.7143
2025-04-15 20:00:56,549 - INFO - Epoch 28/50, Train Loss: 44.9934, Val Loss: 54.8453
2025-04-15 20:00:56,641 - INFO - Epoch 29/50, Train Loss: 44.5870, Val Loss: 54.0996
2025-04-15 20:00:56,733 - INFO - Epoch 30/50, Train Loss: 44.0936, Val Loss: 53.1473
2025-04-15 20:00:56,825 - INFO - Epoch 31/50, Train Loss: 43.4900, Val Loss: 52.1969
2025-04-15 20:00:56,923 - INFO - Epoch 32/50, Train Loss: 42.6670, Val Loss: 51.3214
2025-04-15 20:00:57,022 - INFO - Epoch 33/50, Train Loss: 42.2176, Val Loss: 50.5146
2025-04-15 20:00:57,117 - INFO - Epoch 34/50, Train Loss: 41.2880, Val Loss: 49.8962
2025-04-15 20:00:57,212 - INFO - Epoch 35/50, Train Loss: 41.0888, Val Loss: 49.1845
2025-04-15 20:00:57,307 - INFO - Epoch 36/50, Train Loss: 40.1213, Val Loss: 48.3815
2025-04-15 20:00:57,403 - INFO - Epoch 37/50, Train Loss: 39.6210, Val Loss: 47.3687
2025-04-15 20:00:57,500 - INFO - Epoch 38/50, Train Loss: 39.6057, Val Loss: 46.6915
2025-04-15 20:00:57,592 - INFO - Epoch 39/50, Train Loss: 38.6316, Val Loss: 46.1300
2025-04-15 20:00:57,688 - INFO - Epoch 40/50, Train Loss: 38.1964, Val Loss: 45.4352
2025-04-15 20:00:57,787 - INFO - Epoch 41/50, Train Loss: 37.4126, Val Loss: 44.8709
2025-04-15 20:00:57,883 - INFO - Epoch 42/50, Train Loss: 36.6637, Val Loss: 44.0996
2025-04-15 20:00:57,978 - INFO - Epoch 43/50, Train Loss: 36.8124, Val Loss: 43.2719
2025-04-15 20:00:58,075 - INFO - Epoch 44/50, Train Loss: 36.6679, Val Loss: 42.5973
2025-04-15 20:00:58,172 - INFO - Epoch 45/50, Train Loss: 36.2361, Val Loss: 42.0232
2025-04-15 20:00:58,268 - INFO - Epoch 46/50, Train Loss: 35.7359, Val Loss: 41.6027
2025-04-15 20:00:58,362 - INFO - Epoch 47/50, Train Loss: 34.9361, Val Loss: 41.0170
2025-04-15 20:00:58,455 - INFO - Epoch 48/50, Train Loss: 35.5790, Val Loss: 40.5262
2025-04-15 20:00:58,549 - INFO - Epoch 49/50, Train Loss: 33.7584, Val Loss: 40.1270
2025-04-15 20:00:58,645 - INFO - Epoch 50/50, Train Loss: 34.0527, Val Loss: 39.8751
2025-04-15 20:00:59,184 - INFO - Validation metrics - Horizontal: 37.17km, Depth: 11.79km, 3D: 39.88km
[I 2025-04-15 20:00:59,217] Trial 1 finished with value: 37.17204284667969 and parameters: {'time_window': 72, 'spatial_threshold': 75, 'min_connections': 2, 'gnn_type': 'sage', 'hidden_dim': 128, 'num_layers': 4, 'learning_rate': 0.00021132888166025833, 'batch_size': 32, 'weight_decay': 3.874448320452052e-06}. Best is trial 0 with value: 25.201162338256836.
2025-04-15 20:00:59,365 - INFO - 
Trial 2:
2025-04-15 20:00:59,365 - INFO - Graph params: time_window=72, spatial_threshold=150, min_connections=1
2025-04-15 20:00:59,365 - INFO - Model params: gnn_type=sage, hidden_dim=64, num_layers=5
2025-04-15 20:00:59,365 - INFO - Training params: lr=0.00046968566436375066, batch_size=8, weight_decay=4.856083963390096e-05
2025-04-15 20:00:59,417 - INFO - Creating graphs with time_window=72h, spatial_threshold=150km, min_connections=1...
Created 367 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 256, Val: 55, Test: 56 graphs
Creating causal relative spatiotemporal graphs (time window: 72h, spatial threshold: 150km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 123.87it/s]  7%|▋         | 27/411 [00:00<00:02, 132.72it/s] 10%|▉         | 41/411 [00:00<00:02, 129.87it/s] 13%|█▎        | 55/411 [00:00<00:02, 128.95it/s] 17%|█▋        | 69/411 [00:00<00:02, 130.53it/s] 20%|██        | 83/411 [00:00<00:02, 124.97it/s] 23%|██▎       | 96/411 [00:00<00:02, 125.35it/s] 27%|██▋       | 109/411 [00:00<00:02, 124.03it/s] 30%|██▉       | 122/411 [00:00<00:02, 121.77it/s] 33%|███▎      | 135/411 [00:01<00:02, 120.45it/s] 36%|███▌      | 148/411 [00:01<00:02, 120.88it/s] 39%|███▉      | 161/411 [00:01<00:02, 120.61it/s] 42%|████▏     | 174/411 [00:01<00:01, 119.22it/s] 45%|████▌     | 187/411 [00:01<00:01, 121.29it/s] 49%|████▊     | 200/411 [00:01<00:01, 121.89it/s] 52%|█████▏    | 213/411 [00:01<00:01, 120.67it/s] 55%|█████▍    | 226/411 [00:01<00:01, 120.32it/s] 58%|█████▊    | 239/411 [00:01<00:01, 121.31it/s] 61%|██████▏   | 252/411 [00:02<00:01, 121.59it/s] 65%|██████▍   | 266/411 [00:02<00:01, 125.73it/s] 68%|██████▊   | 279/411 [00:02<00:01, 123.77it/s] 71%|███████   | 292/411 [00:02<00:00, 124.21it/s] 74%|███████▍  | 305/411 [00:02<00:00, 119.52it/s] 77%|███████▋  | 318/411 [00:02<00:00, 120.97it/s] 81%|████████  | 331/411 [00:02<00:00, 118.62it/s] 83%|████████▎ | 343/411 [00:02<00:00, 116.23it/s] 86%|████████▋ | 355/411 [00:02<00:00, 115.94it/s] 90%|████████▉ | 369/411 [00:03<00:00, 120.61it/s] 93%|█████████▎| 382/411 [00:03<00:00, 118.62it/s] 96%|█████████▌| 395/411 [00:03<00:00, 119.94it/s] 99%|█████████▉| 408/411 [00:03<00:00, 122.19it/s]100%|██████████| 411/411 [00:03<00:00, 121.88it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▍        | 58/409 [00:00<00:00, 579.08it/s] 29%|██▉       | 120/409 [00:00<00:00, 600.93it/s] 44%|████▍     | 181/409 [00:00<00:00, 412.57it/s] 56%|█████▌    | 228/409 [00:00<00:00, 389.86it/s] 66%|██████▌   | 270/409 [00:00<00:00, 340.64it/s] 75%|███████▌  | 307/409 [00:00<00:00, 286.21it/s] 83%|████████▎ | 338/409 [00:01<00:00, 250.73it/s] 89%|████████▉ | 365/409 [00:01<00:00, 244.66it/s] 96%|█████████▌| 391/409 [00:01<00:00, 248.08it/s]100%|██████████| 409/409 [00:01<00:00, 304.90it/s]
2025-04-15 20:01:04,153 - INFO - Created 409 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:01:04,244 - INFO - Training SAGE model...
2025-04-15 20:01:04,244 - INFO - Training Causal Relative GNN model (sage) for 50 epochs...
2025-04-15 20:01:04,506 - INFO - Epoch 1/50, Train Loss: 67.7588, Val Loss: 79.6636
2025-04-15 20:01:04,760 - INFO - Epoch 2/50, Train Loss: 67.1416, Val Loss: 78.8580
2025-04-15 20:01:05,023 - INFO - Epoch 3/50, Train Loss: 66.1911, Val Loss: 77.5022
2025-04-15 20:01:05,289 - INFO - Epoch 4/50, Train Loss: 64.6817, Val Loss: 76.0386
2025-04-15 20:01:05,549 - INFO - Epoch 5/50, Train Loss: 62.7427, Val Loss: 74.4747
2025-04-15 20:01:05,805 - INFO - Epoch 6/50, Train Loss: 61.3966, Val Loss: 73.7716
2025-04-15 20:01:06,065 - INFO - Epoch 7/50, Train Loss: 60.0293, Val Loss: 72.3616
2025-04-15 20:01:06,330 - INFO - Epoch 8/50, Train Loss: 58.5786, Val Loss: 71.1402
2025-04-15 20:01:06,585 - INFO - Epoch 9/50, Train Loss: 57.7875, Val Loss: 69.1792
2025-04-15 20:01:06,840 - INFO - Epoch 10/50, Train Loss: 56.9679, Val Loss: 67.4504
2025-04-15 20:01:07,106 - INFO - Epoch 11/50, Train Loss: 56.2180, Val Loss: 66.3581
2025-04-15 20:01:07,364 - INFO - Epoch 12/50, Train Loss: 54.2670, Val Loss: 64.9592
2025-04-15 20:01:07,619 - INFO - Epoch 13/50, Train Loss: 54.0609, Val Loss: 64.2160
2025-04-15 20:01:07,879 - INFO - Epoch 14/50, Train Loss: 52.6477, Val Loss: 63.7895
2025-04-15 20:01:08,143 - INFO - Epoch 15/50, Train Loss: 51.5005, Val Loss: 62.7710
2025-04-15 20:01:08,403 - INFO - Epoch 16/50, Train Loss: 50.6590, Val Loss: 62.1111
2025-04-15 20:01:08,657 - INFO - Epoch 17/50, Train Loss: 50.7328, Val Loss: 62.4675
2025-04-15 20:01:08,918 - INFO - Epoch 18/50, Train Loss: 49.8817, Val Loss: 60.7925
2025-04-15 20:01:09,180 - INFO - Epoch 19/50, Train Loss: 49.9666, Val Loss: 60.4544
2025-04-15 20:01:09,442 - INFO - Epoch 20/50, Train Loss: 50.3577, Val Loss: 60.7647
2025-04-15 20:01:09,695 - INFO - Epoch 21/50, Train Loss: 49.4824, Val Loss: 60.8997
2025-04-15 20:01:09,955 - INFO - Epoch 22/50, Train Loss: 48.2079, Val Loss: 59.2671
2025-04-15 20:01:10,215 - INFO - Epoch 23/50, Train Loss: 46.9579, Val Loss: 58.6055
2025-04-15 20:01:10,474 - INFO - Epoch 24/50, Train Loss: 48.3260, Val Loss: 57.2944
2025-04-15 20:01:10,731 - INFO - Epoch 25/50, Train Loss: 46.1236, Val Loss: 57.1185
2025-04-15 20:01:10,986 - INFO - Epoch 26/50, Train Loss: 46.8748, Val Loss: 55.3749
2025-04-15 20:01:11,248 - INFO - Epoch 27/50, Train Loss: 46.1911, Val Loss: 55.5311
2025-04-15 20:01:11,501 - INFO - Epoch 28/50, Train Loss: 45.8394, Val Loss: 56.4345
2025-04-15 20:01:11,767 - INFO - Epoch 29/50, Train Loss: 46.2140, Val Loss: 53.7991
2025-04-15 20:01:12,024 - INFO - Epoch 30/50, Train Loss: 44.3998, Val Loss: 54.8716
2025-04-15 20:01:12,283 - INFO - Epoch 31/50, Train Loss: 44.8950, Val Loss: 53.7438
2025-04-15 20:01:12,544 - INFO - Epoch 32/50, Train Loss: 44.0347, Val Loss: 53.5979
2025-04-15 20:01:12,800 - INFO - Epoch 33/50, Train Loss: 44.9718, Val Loss: 53.6178
2025-04-15 20:01:13,057 - INFO - Epoch 34/50, Train Loss: 43.2930, Val Loss: 53.8808
2025-04-15 20:01:13,330 - INFO - Epoch 35/50, Train Loss: 43.1057, Val Loss: 53.1215
2025-04-15 20:01:13,586 - INFO - Epoch 36/50, Train Loss: 42.7958, Val Loss: 53.0197
2025-04-15 20:01:13,842 - INFO - Epoch 37/50, Train Loss: 44.1430, Val Loss: 52.5626
2025-04-15 20:01:14,099 - INFO - Epoch 38/50, Train Loss: 42.2231, Val Loss: 52.4483
2025-04-15 20:01:14,353 - INFO - Epoch 39/50, Train Loss: 43.3821, Val Loss: 53.2498
2025-04-15 20:01:14,608 - INFO - Epoch 40/50, Train Loss: 42.5088, Val Loss: 51.7514
2025-04-15 20:01:14,870 - INFO - Epoch 41/50, Train Loss: 42.0397, Val Loss: 52.2184
2025-04-15 20:01:15,137 - INFO - Epoch 42/50, Train Loss: 41.8192, Val Loss: 50.9510
2025-04-15 20:01:15,398 - INFO - Epoch 43/50, Train Loss: 42.8751, Val Loss: 52.3311
2025-04-15 20:01:15,658 - INFO - Epoch 44/50, Train Loss: 42.5930, Val Loss: 52.0431
2025-04-15 20:01:15,915 - INFO - Epoch 45/50, Train Loss: 42.2937, Val Loss: 52.2019
2025-04-15 20:01:16,175 - INFO - Epoch 46/50, Train Loss: 42.3108, Val Loss: 51.8133
2025-04-15 20:01:16,431 - INFO - Epoch 47/50, Train Loss: 40.9870, Val Loss: 52.0543
2025-04-15 20:01:16,683 - INFO - Epoch 48/50, Train Loss: 41.4499, Val Loss: 51.6187
2025-04-15 20:01:16,937 - INFO - Epoch 49/50, Train Loss: 41.1914, Val Loss: 51.2316
2025-04-15 20:01:17,198 - INFO - Epoch 50/50, Train Loss: 41.4293, Val Loss: 51.7808
2025-04-15 20:01:17,753 - INFO - Validation metrics - Horizontal: 48.01km, Depth: 13.19km, 3D: 50.95km
[I 2025-04-15 20:01:17,785] Trial 2 finished with value: 48.011505126953125 and parameters: {'time_window': 72, 'spatial_threshold': 150, 'min_connections': 1, 'gnn_type': 'sage', 'hidden_dim': 64, 'num_layers': 5, 'learning_rate': 0.00046968566436375066, 'batch_size': 8, 'weight_decay': 4.856083963390096e-05}. Best is trial 0 with value: 25.201162338256836.
2025-04-15 20:01:17,940 - INFO - 
Trial 3:
2025-04-15 20:01:17,940 - INFO - Graph params: time_window=336, spatial_threshold=50, min_connections=7
2025-04-15 20:01:17,940 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=3
2025-04-15 20:01:17,940 - INFO - Training params: lr=0.0001348516706943806, batch_size=16, weight_decay=0.0004335255628267583
2025-04-15 20:01:17,988 - INFO - Creating graphs with time_window=336h, spatial_threshold=50km, min_connections=7...
Created 409 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 286, Val: 61, Test: 62 graphs
Creating causal relative spatiotemporal graphs (time window: 336h, spatial threshold: 50km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 124.75it/s]  7%|▋         | 27/411 [00:00<00:02, 131.87it/s] 10%|▉         | 41/411 [00:00<00:02, 128.81it/s] 13%|█▎        | 54/411 [00:00<00:02, 127.99it/s] 16%|█▋        | 67/411 [00:00<00:02, 128.53it/s] 19%|█▉        | 80/411 [00:00<00:02, 125.89it/s] 23%|██▎       | 94/411 [00:00<00:02, 127.19it/s] 26%|██▌       | 107/411 [00:00<00:02, 124.45it/s] 29%|██▉       | 120/411 [00:00<00:02, 120.94it/s] 32%|███▏      | 133/411 [00:01<00:02, 120.37it/s] 36%|███▌      | 146/411 [00:01<00:02, 119.26it/s] 38%|███▊      | 158/411 [00:01<00:02, 119.32it/s] 41%|████▏     | 170/411 [00:01<00:02, 117.56it/s] 45%|████▍     | 183/411 [00:01<00:01, 119.08it/s] 48%|████▊     | 196/411 [00:01<00:01, 120.91it/s] 51%|█████     | 209/411 [00:01<00:01, 122.40it/s] 54%|█████▍    | 222/411 [00:01<00:01, 119.16it/s] 57%|█████▋    | 235/411 [00:01<00:01, 120.36it/s] 60%|██████    | 248/411 [00:02<00:01, 121.93it/s] 64%|██████▎   | 261/411 [00:02<00:01, 124.01it/s] 67%|██████▋   | 274/411 [00:02<00:01, 124.53it/s] 70%|██████▉   | 287/411 [00:02<00:00, 124.03it/s] 73%|███████▎  | 300/411 [00:02<00:00, 118.31it/s] 76%|███████▌  | 313/411 [00:02<00:00, 118.10it/s] 79%|███████▉  | 326/411 [00:02<00:00, 119.86it/s] 82%|████████▏ | 339/411 [00:02<00:00, 116.91it/s] 85%|████████▌ | 351/411 [00:02<00:00, 116.15it/s] 89%|████████▉ | 365/411 [00:02<00:00, 122.70it/s] 92%|█████████▏| 378/411 [00:03<00:00, 118.82it/s] 95%|█████████▍| 390/411 [00:03<00:00, 118.71it/s] 98%|█████████▊| 403/411 [00:03<00:00, 120.22it/s]100%|██████████| 411/411 [00:03<00:00, 121.29it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 546.60it/s] 27%|██▋       | 111/409 [00:00<00:00, 325.76it/s] 36%|███▋      | 149/409 [00:00<00:00, 316.96it/s] 45%|████▍     | 184/409 [00:00<00:00, 271.15it/s] 52%|█████▏    | 213/409 [00:00<00:00, 238.68it/s] 58%|█████▊    | 239/409 [00:00<00:00, 209.29it/s] 64%|██████▍   | 261/409 [00:01<00:00, 192.50it/s] 69%|██████▊   | 281/409 [00:01<00:00, 181.29it/s] 73%|███████▎  | 300/409 [00:01<00:00, 172.35it/s] 78%|███████▊  | 318/409 [00:01<00:00, 160.96it/s] 82%|████████▏ | 335/409 [00:01<00:00, 147.87it/s] 86%|████████▌ | 350/409 [00:01<00:00, 137.72it/s] 89%|████████▉ | 364/409 [00:01<00:00, 128.89it/s] 92%|█████████▏| 377/409 [00:02<00:00, 121.17it/s] 95%|█████████▌| 390/409 [00:02<00:00, 117.81it/s] 98%|█████████▊| 402/409 [00:02<00:00, 116.57it/s]100%|██████████| 409/409 [00:02<00:00, 178.00it/s]
2025-04-15 20:01:23,696 - INFO - Created 313 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:01:23,768 - INFO - Training GAT model...
2025-04-15 20:01:23,768 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:01:24,069 - INFO - Epoch 1/50, Train Loss: 53.4220, Val Loss: 65.7052
2025-04-15 20:01:24,366 - INFO - Epoch 2/50, Train Loss: 52.9745, Val Loss: 64.9767
2025-04-15 20:01:24,652 - INFO - Epoch 3/50, Train Loss: 52.5585, Val Loss: 64.2674
2025-04-15 20:01:24,943 - INFO - Epoch 4/50, Train Loss: 52.1319, Val Loss: 63.5652
2025-04-15 20:01:25,236 - INFO - Epoch 5/50, Train Loss: 51.6454, Val Loss: 62.8478
2025-04-15 20:01:25,527 - INFO - Epoch 6/50, Train Loss: 51.1294, Val Loss: 62.1117
2025-04-15 20:01:25,817 - INFO - Epoch 7/50, Train Loss: 50.5825, Val Loss: 61.3543
2025-04-15 20:01:26,113 - INFO - Epoch 8/50, Train Loss: 49.9678, Val Loss: 60.5755
2025-04-15 20:01:26,401 - INFO - Epoch 9/50, Train Loss: 49.3775, Val Loss: 59.7834
2025-04-15 20:01:26,685 - INFO - Epoch 10/50, Train Loss: 48.5549, Val Loss: 58.9904
2025-04-15 20:01:26,974 - INFO - Epoch 11/50, Train Loss: 47.8612, Val Loss: 58.1609
2025-04-15 20:01:27,264 - INFO - Epoch 12/50, Train Loss: 47.0500, Val Loss: 57.2673
2025-04-15 20:01:27,555 - INFO - Epoch 13/50, Train Loss: 46.2080, Val Loss: 56.4106
2025-04-15 20:01:27,843 - INFO - Epoch 14/50, Train Loss: 45.3690, Val Loss: 55.5920
2025-04-15 20:01:28,141 - INFO - Epoch 15/50, Train Loss: 44.3014, Val Loss: 54.6205
2025-04-15 20:01:28,428 - INFO - Epoch 16/50, Train Loss: 43.3458, Val Loss: 53.6701
2025-04-15 20:01:28,719 - INFO - Epoch 17/50, Train Loss: 42.6218, Val Loss: 52.8216
2025-04-15 20:01:29,011 - INFO - Epoch 18/50, Train Loss: 41.4355, Val Loss: 51.7588
2025-04-15 20:01:29,315 - INFO - Epoch 19/50, Train Loss: 40.5498, Val Loss: 50.9662
2025-04-15 20:01:29,603 - INFO - Epoch 20/50, Train Loss: 39.9990, Val Loss: 49.9091
2025-04-15 20:01:29,891 - INFO - Epoch 21/50, Train Loss: 38.8785, Val Loss: 49.2591
2025-04-15 20:01:30,185 - INFO - Epoch 22/50, Train Loss: 38.0554, Val Loss: 48.2777
2025-04-15 20:01:30,474 - INFO - Epoch 23/50, Train Loss: 37.2892, Val Loss: 47.4762
2025-04-15 20:01:30,757 - INFO - Epoch 24/50, Train Loss: 36.4399, Val Loss: 46.4182
2025-04-15 20:01:31,044 - INFO - Epoch 25/50, Train Loss: 35.1321, Val Loss: 45.9079
2025-04-15 20:01:31,333 - INFO - Epoch 26/50, Train Loss: 34.7136, Val Loss: 44.8950
2025-04-15 20:01:31,621 - INFO - Epoch 27/50, Train Loss: 34.0721, Val Loss: 44.0634
2025-04-15 20:01:31,924 - INFO - Epoch 28/50, Train Loss: 33.5029, Val Loss: 43.5700
2025-04-15 20:01:32,234 - INFO - Epoch 29/50, Train Loss: 32.7403, Val Loss: 43.0529
2025-04-15 20:01:32,529 - INFO - Epoch 30/50, Train Loss: 31.9922, Val Loss: 42.6542
2025-04-15 20:01:32,821 - INFO - Epoch 31/50, Train Loss: 31.4173, Val Loss: 41.7548
2025-04-15 20:01:33,122 - INFO - Epoch 32/50, Train Loss: 30.7422, Val Loss: 41.6730
2025-04-15 20:01:33,421 - INFO - Epoch 33/50, Train Loss: 30.5211, Val Loss: 40.3273
2025-04-15 20:01:33,723 - INFO - Epoch 34/50, Train Loss: 29.7203, Val Loss: 39.7679
2025-04-15 20:01:34,020 - INFO - Epoch 35/50, Train Loss: 28.9025, Val Loss: 38.8693
2025-04-15 20:01:34,328 - INFO - Epoch 36/50, Train Loss: 28.4601, Val Loss: 37.8886
2025-04-15 20:01:34,627 - INFO - Epoch 37/50, Train Loss: 27.7323, Val Loss: 37.0525
2025-04-15 20:01:34,925 - INFO - Epoch 38/50, Train Loss: 27.5233, Val Loss: 36.9495
2025-04-15 20:01:35,229 - INFO - Epoch 39/50, Train Loss: 26.9777, Val Loss: 35.4140
2025-04-15 20:01:35,539 - INFO - Epoch 40/50, Train Loss: 26.0257, Val Loss: 35.3373
2025-04-15 20:01:35,829 - INFO - Epoch 41/50, Train Loss: 25.8387, Val Loss: 34.6281
2025-04-15 20:01:36,136 - INFO - Epoch 42/50, Train Loss: 25.1639, Val Loss: 34.0689
2025-04-15 20:01:36,430 - INFO - Epoch 43/50, Train Loss: 24.5890, Val Loss: 34.3742
2025-04-15 20:01:36,715 - INFO - Epoch 44/50, Train Loss: 24.2942, Val Loss: 32.9935
2025-04-15 20:01:37,011 - INFO - Epoch 45/50, Train Loss: 23.9131, Val Loss: 32.7570
2025-04-15 20:01:37,315 - INFO - Epoch 46/50, Train Loss: 23.3028, Val Loss: 32.5141
2025-04-15 20:01:37,606 - INFO - Epoch 47/50, Train Loss: 23.6591, Val Loss: 32.0819
2025-04-15 20:01:37,902 - INFO - Epoch 48/50, Train Loss: 22.4094, Val Loss: 32.1435
2025-04-15 20:01:38,194 - INFO - Epoch 49/50, Train Loss: 22.2900, Val Loss: 31.9449
2025-04-15 20:01:38,478 - INFO - Epoch 50/50, Train Loss: 22.1443, Val Loss: 31.5684
2025-04-15 20:01:39,009 - INFO - Validation metrics - Horizontal: 29.76km, Depth: 8.70km, 3D: 31.57km
[I 2025-04-15 20:01:39,044] Trial 3 finished with value: 29.75971794128418 and parameters: {'time_window': 336, 'spatial_threshold': 50, 'min_connections': 7, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 3, 'learning_rate': 0.0001348516706943806, 'batch_size': 16, 'weight_decay': 0.0004335255628267583}. Best is trial 0 with value: 25.201162338256836.
2025-04-15 20:01:39,199 - INFO - 
Trial 4:
2025-04-15 20:01:39,199 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:01:39,199 - INFO - Model params: gnn_type=gat, hidden_dim=256, num_layers=2
2025-04-15 20:01:39,199 - INFO - Training params: lr=0.0033184536229711264, batch_size=8, weight_decay=3.721162325958983e-05
2025-04-15 20:01:39,248 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 313 causal graphs
First graph has 8 nodes and 7 edges
Chronological split - Train: 219, Val: 47, Test: 47 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 126.64it/s]  7%|▋         | 28/411 [00:00<00:02, 134.55it/s] 10%|█         | 42/411 [00:00<00:02, 132.31it/s] 14%|█▎        | 56/411 [00:00<00:02, 131.76it/s] 17%|█▋        | 70/411 [00:00<00:02, 132.43it/s] 20%|██        | 84/411 [00:00<00:02, 129.60it/s] 24%|██▍       | 98/411 [00:00<00:02, 130.83it/s] 27%|██▋       | 112/411 [00:00<00:02, 127.97it/s] 30%|███       | 125/411 [00:00<00:02, 126.20it/s] 34%|███▎      | 138/411 [00:01<00:02, 124.86it/s] 37%|███▋      | 151/411 [00:01<00:02, 125.15it/s] 40%|███▉      | 164/411 [00:01<00:02, 122.02it/s] 43%|████▎     | 177/411 [00:01<00:01, 121.94it/s] 46%|████▌     | 190/411 [00:01<00:01, 123.88it/s] 50%|████▉     | 204/411 [00:01<00:01, 126.34it/s] 53%|█████▎    | 217/411 [00:01<00:01, 126.32it/s] 56%|█████▌    | 230/411 [00:01<00:01, 124.95it/s] 59%|█████▉    | 244/411 [00:01<00:01, 126.39it/s] 63%|██████▎   | 257/411 [00:02<00:01, 125.06it/s] 66%|██████▌   | 271/411 [00:02<00:01, 129.34it/s] 69%|██████▉   | 284/411 [00:02<00:00, 127.42it/s] 72%|███████▏  | 297/411 [00:02<00:00, 125.03it/s] 75%|███████▌  | 310/411 [00:02<00:00, 122.19it/s] 79%|███████▊  | 323/411 [00:02<00:00, 122.21it/s] 82%|████████▏ | 336/411 [00:02<00:00, 120.64it/s] 85%|████████▍ | 349/411 [00:02<00:00, 118.62it/s] 88%|████████▊ | 363/411 [00:02<00:00, 123.76it/s] 91%|█████████▏| 376/411 [00:03<00:00, 120.91it/s] 95%|█████████▍| 389/411 [00:03<00:00, 121.07it/s] 98%|█████████▊| 403/411 [00:03<00:00, 123.99it/s]100%|██████████| 411/411 [00:03<00:00, 125.12it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 558.06it/s] 27%|██▋       | 112/409 [00:00<00:00, 541.99it/s] 41%|████      | 167/409 [00:00<00:00, 460.46it/s] 53%|█████▎    | 215/409 [00:00<00:00, 384.60it/s] 63%|██████▎   | 256/409 [00:00<00:00, 345.61it/s] 71%|███████▏  | 292/409 [00:00<00:00, 290.76it/s] 79%|███████▉  | 323/409 [00:01<00:00, 248.11it/s] 86%|████████▌ | 350/409 [00:01<00:00, 228.60it/s] 91%|█████████▏| 374/409 [00:01<00:00, 221.72it/s] 97%|█████████▋| 397/409 [00:01<00:00, 221.45it/s]100%|██████████| 409/409 [00:01<00:00, 286.04it/s]
2025-04-15 20:01:43,984 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:01:44,061 - INFO - Training GAT model...
2025-04-15 20:01:44,061 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:01:44,539 - INFO - Epoch 1/50, Train Loss: 47.3241, Val Loss: 52.8459
2025-04-15 20:01:45,025 - INFO - Epoch 2/50, Train Loss: 42.0977, Val Loss: 44.1929
2025-04-15 20:01:45,537 - INFO - Epoch 3/50, Train Loss: 39.4199, Val Loss: 45.6547
2025-04-15 20:01:46,080 - INFO - Epoch 4/50, Train Loss: 39.7802, Val Loss: 45.6899
2025-04-15 20:01:46,679 - INFO - Epoch 5/50, Train Loss: 36.5008, Val Loss: 41.2055
2025-04-15 20:01:47,174 - INFO - Epoch 6/50, Train Loss: 32.3313, Val Loss: 36.5363
2025-04-15 20:01:47,708 - INFO - Epoch 7/50, Train Loss: 31.9789, Val Loss: 36.7548
2025-04-15 20:01:48,187 - INFO - Epoch 8/50, Train Loss: 32.6557, Val Loss: 32.3496
2025-04-15 20:01:48,675 - INFO - Epoch 9/50, Train Loss: 29.7047, Val Loss: 35.8788
2025-04-15 20:01:49,177 - INFO - Epoch 10/50, Train Loss: 33.3903, Val Loss: 34.8736
2025-04-15 20:01:49,873 - INFO - Epoch 11/50, Train Loss: 35.0927, Val Loss: 35.6552
2025-04-15 20:01:50,525 - INFO - Epoch 12/50, Train Loss: 31.0369, Val Loss: 32.8501
2025-04-15 20:01:51,148 - INFO - Epoch 13/50, Train Loss: 31.3349, Val Loss: 29.2599
2025-04-15 20:01:51,780 - INFO - Epoch 14/50, Train Loss: 32.6701, Val Loss: 34.1298
2025-04-15 20:01:52,392 - INFO - Epoch 15/50, Train Loss: 30.9290, Val Loss: 35.9370
2025-04-15 20:01:53,157 - INFO - Epoch 16/50, Train Loss: 31.6378, Val Loss: 35.5065
2025-04-15 20:01:53,857 - INFO - Epoch 17/50, Train Loss: 30.0209, Val Loss: 32.3210
2025-04-15 20:01:54,495 - INFO - Epoch 18/50, Train Loss: 31.5361, Val Loss: 28.8011
2025-04-15 20:01:55,136 - INFO - Epoch 19/50, Train Loss: 31.9100, Val Loss: 29.4326
2025-04-15 20:01:55,728 - INFO - Epoch 20/50, Train Loss: 29.8924, Val Loss: 29.3936
2025-04-15 20:01:56,363 - INFO - Epoch 21/50, Train Loss: 28.6352, Val Loss: 28.9885
2025-04-15 20:01:57,024 - INFO - Epoch 22/50, Train Loss: 29.8681, Val Loss: 29.6751
2025-04-15 20:01:57,693 - INFO - Epoch 23/50, Train Loss: 32.0859, Val Loss: 26.9988
2025-04-15 20:01:58,326 - INFO - Epoch 24/50, Train Loss: 30.2882, Val Loss: 28.6611
2025-04-15 20:01:58,917 - INFO - Epoch 25/50, Train Loss: 28.9226, Val Loss: 29.1014
2025-04-15 20:01:59,523 - INFO - Epoch 26/50, Train Loss: 30.6762, Val Loss: 30.7007
2025-04-15 20:02:00,094 - INFO - Epoch 27/50, Train Loss: 30.4821, Val Loss: 30.7742
2025-04-15 20:02:00,779 - INFO - Epoch 28/50, Train Loss: 30.1068, Val Loss: 30.7409
2025-04-15 20:02:01,505 - INFO - Epoch 29/50, Train Loss: 29.4077, Val Loss: 32.6575
2025-04-15 20:02:02,178 - INFO - Epoch 30/50, Train Loss: 26.3761, Val Loss: 31.3381
2025-04-15 20:02:02,798 - INFO - Epoch 31/50, Train Loss: 27.8588, Val Loss: 28.8287
2025-04-15 20:02:03,435 - INFO - Epoch 32/50, Train Loss: 26.5765, Val Loss: 26.9499
2025-04-15 20:02:04,130 - INFO - Epoch 33/50, Train Loss: 26.8028, Val Loss: 26.2700
2025-04-15 20:02:04,809 - INFO - Epoch 34/50, Train Loss: 26.7545, Val Loss: 27.3784
2025-04-15 20:02:05,511 - INFO - Epoch 35/50, Train Loss: 26.0557, Val Loss: 27.4769
2025-04-15 20:02:06,138 - INFO - Epoch 36/50, Train Loss: 25.5314, Val Loss: 27.1346
2025-04-15 20:02:06,779 - INFO - Epoch 37/50, Train Loss: 25.2503, Val Loss: 28.3834
2025-04-15 20:02:07,463 - INFO - Epoch 38/50, Train Loss: 25.5924, Val Loss: 27.9740
2025-04-15 20:02:08,221 - INFO - Epoch 39/50, Train Loss: 27.0324, Val Loss: 28.9811
2025-04-15 20:02:08,956 - INFO - Epoch 40/50, Train Loss: 25.4669, Val Loss: 26.9793
2025-04-15 20:02:09,663 - INFO - Epoch 41/50, Train Loss: 24.8139, Val Loss: 27.7595
2025-04-15 20:02:10,363 - INFO - Epoch 42/50, Train Loss: 23.9566, Val Loss: 26.9623
2025-04-15 20:02:11,074 - INFO - Epoch 43/50, Train Loss: 24.6242, Val Loss: 27.7760
2025-04-15 20:02:11,074 - INFO - Early stopping at epoch 43. Best epoch: 33
2025-04-15 20:02:11,624 - INFO - Validation metrics - Horizontal: 23.56km, Depth: 8.11km, 3D: 26.27km
[I 2025-04-15 20:02:11,654] Trial 4 finished with value: 23.56442642211914 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 256, 'num_layers': 2, 'learning_rate': 0.0033184536229711264, 'batch_size': 8, 'weight_decay': 3.721162325958983e-05}. Best is trial 4 with value: 23.56442642211914.
2025-04-15 20:02:11,794 - INFO - 
Trial 5:
2025-04-15 20:02:11,794 - INFO - Graph params: time_window=336, spatial_threshold=100, min_connections=3
2025-04-15 20:02:11,794 - INFO - Model params: gnn_type=sage, hidden_dim=256, num_layers=2
2025-04-15 20:02:11,794 - INFO - Training params: lr=0.0032884557006187167, batch_size=16, weight_decay=1.557403136846318e-06
2025-04-15 20:02:11,842 - INFO - Creating graphs with time_window=336h, spatial_threshold=100km, min_connections=3...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 336h, spatial threshold: 100km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 128.17it/s]  7%|▋         | 28/411 [00:00<00:02, 135.01it/s] 10%|█         | 42/411 [00:00<00:02, 131.08it/s] 14%|█▎        | 56/411 [00:00<00:02, 130.32it/s] 17%|█▋        | 70/411 [00:00<00:02, 130.31it/s] 20%|██        | 84/411 [00:00<00:02, 127.88it/s] 24%|██▍       | 98/411 [00:00<00:02, 129.34it/s] 27%|██▋       | 111/411 [00:00<00:02, 127.38it/s] 30%|███       | 124/411 [00:00<00:02, 122.61it/s] 33%|███▎      | 137/411 [00:01<00:02, 123.12it/s] 36%|███▋      | 150/411 [00:01<00:02, 122.78it/s] 40%|███▉      | 163/411 [00:01<00:02, 120.35it/s] 43%|████▎     | 176/411 [00:01<00:01, 120.31it/s] 46%|████▌     | 189/411 [00:01<00:01, 121.79it/s] 49%|████▉     | 202/411 [00:01<00:01, 123.96it/s] 52%|█████▏    | 215/411 [00:01<00:01, 123.60it/s] 55%|█████▌    | 228/411 [00:01<00:01, 122.56it/s] 59%|█████▉    | 242/411 [00:01<00:01, 126.47it/s] 62%|██████▏   | 255/411 [00:02<00:01, 123.23it/s] 65%|██████▌   | 269/411 [00:02<00:01, 126.80it/s] 69%|██████▊   | 282/411 [00:02<00:01, 126.69it/s] 72%|███████▏  | 295/411 [00:02<00:00, 124.55it/s] 75%|███████▍  | 308/411 [00:02<00:00, 121.34it/s] 78%|███████▊  | 321/411 [00:02<00:00, 120.21it/s] 81%|████████▏ | 334/411 [00:02<00:00, 119.67it/s] 84%|████████▍ | 346/411 [00:02<00:00, 115.60it/s] 87%|████████▋ | 358/411 [00:02<00:00, 115.16it/s] 90%|█████████ | 371/411 [00:03<00:00, 118.61it/s] 93%|█████████▎| 383/411 [00:03<00:00, 118.97it/s] 96%|█████████▌| 395/411 [00:03<00:00, 118.51it/s] 99%|█████████▉| 408/411 [00:03<00:00, 121.59it/s]100%|██████████| 411/411 [00:03<00:00, 122.99it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 11%|█         | 46/409 [00:00<00:00, 454.00it/s] 22%|██▏       | 92/409 [00:00<00:01, 252.65it/s] 30%|███       | 123/409 [00:00<00:01, 239.69it/s] 37%|███▋      | 150/409 [00:00<00:01, 237.69it/s] 43%|████▎     | 176/409 [00:00<00:01, 208.46it/s] 48%|████▊     | 198/409 [00:00<00:01, 187.02it/s] 53%|█████▎    | 218/409 [00:01<00:01, 167.57it/s] 58%|█████▊    | 236/409 [00:01<00:01, 152.52it/s] 62%|██████▏   | 252/409 [00:01<00:01, 144.49it/s] 65%|██████▌   | 267/409 [00:01<00:01, 138.28it/s] 69%|██████▊   | 281/409 [00:01<00:00, 130.90it/s] 72%|███████▏  | 295/409 [00:01<00:00, 126.04it/s] 75%|███████▌  | 308/409 [00:01<00:00, 122.06it/s] 78%|███████▊  | 321/409 [00:01<00:00, 116.16it/s] 81%|████████▏ | 333/409 [00:02<00:00, 109.65it/s] 84%|████████▍ | 344/409 [00:02<00:00, 105.24it/s] 87%|████████▋ | 355/409 [00:02<00:00, 100.02it/s] 89%|████████▉ | 365/409 [00:02<00:00, 94.29it/s]  92%|█████████▏| 375/409 [00:02<00:00, 92.36it/s] 94%|█████████▍| 385/409 [00:02<00:00, 89.82it/s] 96%|█████████▋| 394/409 [00:02<00:00, 89.20it/s] 99%|█████████▉| 404/409 [00:02<00:00, 89.30it/s]100%|██████████| 409/409 [00:02<00:00, 138.50it/s]
2025-04-15 20:02:18,159 - INFO - Created 406 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:02:18,254 - INFO - Training SAGE model...
2025-04-15 20:02:18,254 - INFO - Training Causal Relative GNN model (sage) for 50 epochs...
2025-04-15 20:02:18,529 - INFO - Epoch 1/50, Train Loss: 57.2580, Val Loss: 55.4355
2025-04-15 20:02:18,816 - INFO - Epoch 2/50, Train Loss: 51.6727, Val Loss: 52.2310
2025-04-15 20:02:19,094 - INFO - Epoch 3/50, Train Loss: 44.4788, Val Loss: 45.1740
2025-04-15 20:02:19,371 - INFO - Epoch 4/50, Train Loss: 41.0855, Val Loss: 40.0129
2025-04-15 20:02:19,656 - INFO - Epoch 5/50, Train Loss: 40.7608, Val Loss: 41.1773
2025-04-15 20:02:19,939 - INFO - Epoch 6/50, Train Loss: 36.9362, Val Loss: 34.4738
2025-04-15 20:02:20,213 - INFO - Epoch 7/50, Train Loss: 33.5163, Val Loss: 34.9997
2025-04-15 20:02:20,487 - INFO - Epoch 8/50, Train Loss: 33.2832, Val Loss: 31.0604
2025-04-15 20:02:20,764 - INFO - Epoch 9/50, Train Loss: 32.6618, Val Loss: 32.3473
2025-04-15 20:02:21,032 - INFO - Epoch 10/50, Train Loss: 31.7636, Val Loss: 36.9708
2025-04-15 20:02:21,306 - INFO - Epoch 11/50, Train Loss: 30.0491, Val Loss: 36.3054
2025-04-15 20:02:21,570 - INFO - Epoch 12/50, Train Loss: 29.7413, Val Loss: 36.2520
2025-04-15 20:02:21,840 - INFO - Epoch 13/50, Train Loss: 29.2851, Val Loss: 34.0564
2025-04-15 20:02:22,100 - INFO - Epoch 14/50, Train Loss: 28.0288, Val Loss: 36.9673
2025-04-15 20:02:22,372 - INFO - Epoch 15/50, Train Loss: 24.1091, Val Loss: 34.6102
2025-04-15 20:02:22,639 - INFO - Epoch 16/50, Train Loss: 22.6859, Val Loss: 30.5462
2025-04-15 20:02:22,914 - INFO - Epoch 17/50, Train Loss: 20.7018, Val Loss: 33.7136
2025-04-15 20:02:23,199 - INFO - Epoch 18/50, Train Loss: 20.6566, Val Loss: 29.5074
2025-04-15 20:02:23,463 - INFO - Epoch 19/50, Train Loss: 22.4329, Val Loss: 30.8074
2025-04-15 20:02:23,728 - INFO - Epoch 20/50, Train Loss: 20.6790, Val Loss: 29.9716
2025-04-15 20:02:23,997 - INFO - Epoch 21/50, Train Loss: 22.7940, Val Loss: 29.5539
2025-04-15 20:02:24,274 - INFO - Epoch 22/50, Train Loss: 20.6554, Val Loss: 32.2802
2025-04-15 20:02:24,547 - INFO - Epoch 23/50, Train Loss: 21.3783, Val Loss: 29.4199
2025-04-15 20:02:24,838 - INFO - Epoch 24/50, Train Loss: 21.6050, Val Loss: 34.5159
2025-04-15 20:02:25,114 - INFO - Epoch 25/50, Train Loss: 23.1179, Val Loss: 29.4256
2025-04-15 20:02:25,389 - INFO - Epoch 26/50, Train Loss: 23.1394, Val Loss: 32.8955
2025-04-15 20:02:25,659 - INFO - Epoch 27/50, Train Loss: 21.7735, Val Loss: 30.0444
2025-04-15 20:02:25,931 - INFO - Epoch 28/50, Train Loss: 19.9644, Val Loss: 32.7273
2025-04-15 20:02:26,199 - INFO - Epoch 29/50, Train Loss: 20.3639, Val Loss: 29.5924
2025-04-15 20:02:26,457 - INFO - Epoch 30/50, Train Loss: 19.9630, Val Loss: 29.6592
2025-04-15 20:02:26,709 - INFO - Epoch 31/50, Train Loss: 19.4958, Val Loss: 30.8958
2025-04-15 20:02:26,969 - INFO - Epoch 32/50, Train Loss: 18.2430, Val Loss: 30.5567
2025-04-15 20:02:27,238 - INFO - Epoch 33/50, Train Loss: 18.0603, Val Loss: 28.5127
2025-04-15 20:02:27,497 - INFO - Epoch 34/50, Train Loss: 17.7682, Val Loss: 29.1056
2025-04-15 20:02:27,755 - INFO - Epoch 35/50, Train Loss: 17.1532, Val Loss: 29.4199
2025-04-15 20:02:28,014 - INFO - Epoch 36/50, Train Loss: 17.1009, Val Loss: 29.0807
2025-04-15 20:02:28,277 - INFO - Epoch 37/50, Train Loss: 17.5176, Val Loss: 29.8249
2025-04-15 20:02:28,534 - INFO - Epoch 38/50, Train Loss: 16.5821, Val Loss: 29.7685
2025-04-15 20:02:28,788 - INFO - Epoch 39/50, Train Loss: 16.9915, Val Loss: 30.6629
2025-04-15 20:02:29,048 - INFO - Epoch 40/50, Train Loss: 16.4406, Val Loss: 30.3145
2025-04-15 20:02:29,310 - INFO - Epoch 41/50, Train Loss: 16.5928, Val Loss: 30.8943
2025-04-15 20:02:29,573 - INFO - Epoch 42/50, Train Loss: 16.6670, Val Loss: 30.3427
2025-04-15 20:02:29,837 - INFO - Epoch 43/50, Train Loss: 16.6089, Val Loss: 29.7284
2025-04-15 20:02:29,837 - INFO - Early stopping at epoch 43. Best epoch: 33
2025-04-15 20:02:30,382 - INFO - Validation metrics - Horizontal: 25.63km, Depth: 8.95km, 3D: 28.51km
[I 2025-04-15 20:02:30,415] Trial 5 finished with value: 25.629249572753906 and parameters: {'time_window': 336, 'spatial_threshold': 100, 'min_connections': 3, 'gnn_type': 'sage', 'hidden_dim': 256, 'num_layers': 2, 'learning_rate': 0.0032884557006187167, 'batch_size': 16, 'weight_decay': 1.557403136846318e-06}. Best is trial 4 with value: 23.56442642211914.
2025-04-15 20:02:30,566 - INFO - 
Trial 6:
2025-04-15 20:02:30,566 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=2
2025-04-15 20:02:30,566 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=5
2025-04-15 20:02:30,566 - INFO - Training params: lr=0.0010889214448549659, batch_size=16, weight_decay=2.5520258227338674e-06
2025-04-15 20:02:30,613 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=2...
Created 406 causal graphs
First graph has 4 nodes and 3 edges
Chronological split - Train: 284, Val: 61, Test: 61 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 127.00it/s]  7%|▋         | 28/411 [00:00<00:02, 134.56it/s] 10%|█         | 42/411 [00:00<00:02, 132.90it/s] 14%|█▎        | 56/411 [00:00<00:02, 132.06it/s] 17%|█▋        | 70/411 [00:00<00:02, 130.85it/s] 20%|██        | 84/411 [00:00<00:02, 128.47it/s] 24%|██▍       | 98/411 [00:00<00:02, 129.09it/s] 27%|██▋       | 111/411 [00:00<00:02, 127.84it/s] 30%|███       | 124/411 [00:00<00:02, 123.77it/s] 33%|███▎      | 137/411 [00:01<00:02, 124.34it/s] 36%|███▋      | 150/411 [00:01<00:02, 122.96it/s] 40%|███▉      | 163/411 [00:01<00:02, 121.45it/s] 43%|████▎     | 176/411 [00:01<00:01, 120.35it/s] 46%|████▌     | 189/411 [00:01<00:01, 121.54it/s] 49%|████▉     | 202/411 [00:01<00:01, 123.66it/s] 52%|█████▏    | 215/411 [00:01<00:01, 123.18it/s] 55%|█████▌    | 228/411 [00:01<00:01, 122.08it/s] 59%|█████▉    | 242/411 [00:01<00:01, 126.10it/s] 62%|██████▏   | 255/411 [00:02<00:01, 124.26it/s] 65%|██████▌   | 269/411 [00:02<00:01, 128.77it/s] 69%|██████▊   | 282/411 [00:02<00:01, 128.73it/s] 72%|███████▏  | 295/411 [00:02<00:00, 127.57it/s] 75%|███████▍  | 308/411 [00:02<00:00, 123.34it/s] 78%|███████▊  | 321/411 [00:02<00:00, 121.46it/s] 81%|████████▏ | 334/411 [00:02<00:00, 121.38it/s] 84%|████████▍ | 347/411 [00:02<00:00, 119.87it/s] 88%|████████▊ | 360/411 [00:02<00:00, 120.78it/s] 91%|█████████ | 373/411 [00:02<00:00, 121.72it/s] 94%|█████████▍| 386/411 [00:03<00:00, 121.26it/s] 97%|█████████▋| 399/411 [00:03<00:00, 123.26it/s]100%|██████████| 411/411 [00:03<00:00, 124.59it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 552.03it/s] 27%|██▋       | 112/409 [00:00<00:00, 532.98it/s] 41%|████      | 166/409 [00:00<00:00, 454.04it/s] 52%|█████▏    | 213/409 [00:00<00:00, 378.24it/s] 62%|██████▏   | 253/409 [00:00<00:00, 344.81it/s] 71%|███████   | 289/409 [00:00<00:00, 291.51it/s] 78%|███████▊  | 320/409 [00:01<00:00, 248.93it/s] 85%|████████▍ | 347/409 [00:01<00:00, 223.73it/s] 91%|█████████ | 371/409 [00:01<00:00, 218.80it/s] 96%|█████████▋| 394/409 [00:01<00:00, 220.13it/s]100%|██████████| 409/409 [00:01<00:00, 283.47it/s]
2025-04-15 20:02:35,376 - INFO - Created 388 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:02:35,465 - INFO - Training GAT model...
2025-04-15 20:02:35,465 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:02:35,923 - INFO - Epoch 1/50, Train Loss: 62.9046, Val Loss: 74.3180
2025-04-15 20:02:36,393 - INFO - Epoch 2/50, Train Loss: 59.5826, Val Loss: 68.1545
2025-04-15 20:02:36,849 - INFO - Epoch 3/50, Train Loss: 54.5225, Val Loss: 60.7076
2025-04-15 20:02:37,325 - INFO - Epoch 4/50, Train Loss: 50.1273, Val Loss: 54.1089
2025-04-15 20:02:37,784 - INFO - Epoch 5/50, Train Loss: 46.7165, Val Loss: 47.8096
2025-04-15 20:02:38,254 - INFO - Epoch 6/50, Train Loss: 44.0263, Val Loss: 44.6200
2025-04-15 20:02:38,714 - INFO - Epoch 7/50, Train Loss: 43.6575, Val Loss: 39.5671
2025-04-15 20:02:39,188 - INFO - Epoch 8/50, Train Loss: 42.5626, Val Loss: 40.1725
2025-04-15 20:02:39,651 - INFO - Epoch 9/50, Train Loss: 41.2985, Val Loss: 39.8267
2025-04-15 20:02:40,120 - INFO - Epoch 10/50, Train Loss: 41.2477, Val Loss: 38.8681
2025-04-15 20:02:40,585 - INFO - Epoch 11/50, Train Loss: 38.9771, Val Loss: 33.9385
2025-04-15 20:02:41,046 - INFO - Epoch 12/50, Train Loss: 37.5781, Val Loss: 32.6590
2025-04-15 20:02:41,526 - INFO - Epoch 13/50, Train Loss: 36.9061, Val Loss: 37.9753
2025-04-15 20:02:42,004 - INFO - Epoch 14/50, Train Loss: 37.9087, Val Loss: 31.3723
2025-04-15 20:02:42,477 - INFO - Epoch 15/50, Train Loss: 38.8962, Val Loss: 27.6909
2025-04-15 20:02:42,938 - INFO - Epoch 16/50, Train Loss: 33.9913, Val Loss: 27.7526
2025-04-15 20:02:43,404 - INFO - Epoch 17/50, Train Loss: 34.6219, Val Loss: 26.5136
2025-04-15 20:02:43,861 - INFO - Epoch 18/50, Train Loss: 32.6364, Val Loss: 29.8543
2025-04-15 20:02:44,320 - INFO - Epoch 19/50, Train Loss: 33.2243, Val Loss: 26.7513
2025-04-15 20:02:44,775 - INFO - Epoch 20/50, Train Loss: 32.4415, Val Loss: 26.8141
2025-04-15 20:02:45,243 - INFO - Epoch 21/50, Train Loss: 31.1654, Val Loss: 30.7469
2025-04-15 20:02:45,710 - INFO - Epoch 22/50, Train Loss: 31.4599, Val Loss: 26.4997
2025-04-15 20:02:46,165 - INFO - Epoch 23/50, Train Loss: 29.7752, Val Loss: 30.8170
2025-04-15 20:02:46,623 - INFO - Epoch 24/50, Train Loss: 29.6968, Val Loss: 28.2328
2025-04-15 20:02:47,088 - INFO - Epoch 25/50, Train Loss: 29.5938, Val Loss: 29.7146
2025-04-15 20:02:47,549 - INFO - Epoch 26/50, Train Loss: 28.7973, Val Loss: 27.1180
2025-04-15 20:02:48,016 - INFO - Epoch 27/50, Train Loss: 28.3786, Val Loss: 26.6734
2025-04-15 20:02:48,472 - INFO - Epoch 28/50, Train Loss: 31.9935, Val Loss: 32.0046
2025-04-15 20:02:48,930 - INFO - Epoch 29/50, Train Loss: 30.3065, Val Loss: 26.6397
2025-04-15 20:02:49,396 - INFO - Epoch 30/50, Train Loss: 27.6786, Val Loss: 24.4081
2025-04-15 20:02:49,848 - INFO - Epoch 31/50, Train Loss: 25.7862, Val Loss: 27.3483
2025-04-15 20:02:50,312 - INFO - Epoch 32/50, Train Loss: 26.2236, Val Loss: 29.2558
2025-04-15 20:02:50,770 - INFO - Epoch 33/50, Train Loss: 25.1473, Val Loss: 27.1851
2025-04-15 20:02:51,230 - INFO - Epoch 34/50, Train Loss: 27.0611, Val Loss: 28.9929
2025-04-15 20:02:51,683 - INFO - Epoch 35/50, Train Loss: 26.3860, Val Loss: 27.9120
2025-04-15 20:02:52,146 - INFO - Epoch 36/50, Train Loss: 25.9721, Val Loss: 26.3214
2025-04-15 20:02:52,610 - INFO - Epoch 37/50, Train Loss: 25.1493, Val Loss: 26.6332
2025-04-15 20:02:53,083 - INFO - Epoch 38/50, Train Loss: 25.2381, Val Loss: 28.5234
2025-04-15 20:02:53,539 - INFO - Epoch 39/50, Train Loss: 25.3959, Val Loss: 27.9915
2025-04-15 20:02:53,987 - INFO - Epoch 40/50, Train Loss: 25.4659, Val Loss: 27.2575
2025-04-15 20:02:53,987 - INFO - Early stopping at epoch 40. Best epoch: 30
2025-04-15 20:02:54,551 - INFO - Validation metrics - Horizontal: 20.56km, Depth: 8.77km, 3D: 24.41km
[I 2025-04-15 20:02:54,585] Trial 6 finished with value: 20.55681610107422 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 5, 'learning_rate': 0.0010889214448549659, 'batch_size': 16, 'weight_decay': 2.5520258227338674e-06}. Best is trial 6 with value: 20.55681610107422.
2025-04-15 20:02:54,728 - INFO - 
Trial 7:
2025-04-15 20:02:54,728 - INFO - Graph params: time_window=240, spatial_threshold=150, min_connections=7
2025-04-15 20:02:54,728 - INFO - Model params: gnn_type=sage, hidden_dim=256, num_layers=6
2025-04-15 20:02:54,728 - INFO - Training params: lr=0.006241875070620387, batch_size=8, weight_decay=1.7838039523057479e-06
2025-04-15 20:02:54,775 - INFO - Creating graphs with time_window=240h, spatial_threshold=150km, min_connections=7...
Created 388 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 271, Val: 58, Test: 59 graphs
Creating causal relative spatiotemporal graphs (time window: 240h, spatial threshold: 150km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 126.10it/s]  7%|▋         | 28/411 [00:00<00:02, 133.07it/s] 10%|█         | 42/411 [00:00<00:02, 130.65it/s] 14%|█▎        | 56/411 [00:00<00:02, 130.35it/s] 17%|█▋        | 70/411 [00:00<00:02, 131.19it/s] 20%|██        | 84/411 [00:00<00:02, 128.85it/s] 24%|██▎       | 97/411 [00:00<00:02, 128.36it/s] 27%|██▋       | 110/411 [00:00<00:02, 127.09it/s] 30%|██▉       | 123/411 [00:00<00:02, 124.16it/s] 33%|███▎      | 136/411 [00:01<00:02, 124.61it/s] 36%|███▋      | 149/411 [00:01<00:02, 123.02it/s] 39%|███▉      | 162/411 [00:01<00:02, 121.64it/s] 43%|████▎     | 175/411 [00:01<00:01, 120.31it/s] 46%|████▌     | 189/411 [00:01<00:01, 122.72it/s] 49%|████▉     | 202/411 [00:01<00:01, 124.24it/s] 52%|█████▏    | 215/411 [00:01<00:01, 123.84it/s] 55%|█████▌    | 228/411 [00:01<00:01, 119.23it/s] 59%|█████▉    | 242/411 [00:01<00:01, 123.94it/s] 62%|██████▏   | 255/411 [00:02<00:01, 122.38it/s] 65%|██████▌   | 269/411 [00:02<00:01, 126.49it/s] 69%|██████▊   | 282/411 [00:02<00:01, 125.93it/s] 72%|███████▏  | 295/411 [00:02<00:00, 124.46it/s] 75%|███████▍  | 308/411 [00:02<00:00, 121.27it/s] 78%|███████▊  | 321/411 [00:02<00:00, 120.31it/s] 81%|████████▏ | 334/411 [00:02<00:00, 120.29it/s] 84%|████████▍ | 347/411 [00:02<00:00, 118.57it/s] 87%|████████▋ | 359/411 [00:02<00:00, 118.90it/s] 91%|█████████ | 372/411 [00:03<00:00, 121.89it/s] 94%|█████████▎| 385/411 [00:03<00:00, 120.96it/s] 97%|█████████▋| 398/411 [00:03<00:00, 122.01it/s]100%|██████████| 411/411 [00:03<00:00, 122.46it/s]100%|██████████| 411/411 [00:03<00:00, 123.65it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 11%|█         | 45/409 [00:00<00:00, 449.06it/s] 22%|██▏       | 90/409 [00:00<00:01, 260.92it/s] 30%|██▉       | 121/409 [00:00<00:01, 266.21it/s] 37%|███▋      | 151/409 [00:00<00:00, 261.90it/s] 44%|████▍     | 179/409 [00:00<00:01, 221.37it/s] 50%|████▉     | 203/409 [00:00<00:01, 191.48it/s] 55%|█████▍    | 224/409 [00:01<00:01, 178.03it/s] 59%|█████▉    | 243/409 [00:01<00:00, 177.75it/s] 64%|██████▍   | 262/409 [00:01<00:00, 170.30it/s] 68%|██████▊   | 280/409 [00:01<00:00, 155.71it/s] 72%|███████▏  | 296/409 [00:01<00:00, 140.59it/s] 76%|███████▌  | 311/409 [00:01<00:00, 129.23it/s] 79%|███████▉  | 325/409 [00:01<00:00, 117.75it/s] 82%|████████▏ | 337/409 [00:01<00:00, 111.19it/s] 85%|████████▌ | 349/409 [00:02<00:00, 104.91it/s] 88%|████████▊ | 360/409 [00:02<00:00, 100.46it/s] 91%|█████████ | 371/409 [00:02<00:00, 97.90it/s]  93%|█████████▎| 381/409 [00:02<00:00, 97.18it/s] 96%|█████████▌| 392/409 [00:02<00:00, 100.47it/s] 99%|█████████▉| 405/409 [00:02<00:00, 107.23it/s]100%|██████████| 409/409 [00:02<00:00, 151.43it/s]
2025-04-15 20:03:00,821 - INFO - Created 402 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:03:00,926 - INFO - Training SAGE model...
2025-04-15 20:03:00,926 - INFO - Training Causal Relative GNN model (sage) for 50 epochs...
2025-04-15 20:03:02,125 - INFO - Epoch 1/50, Train Loss: 65.5150, Val Loss: 79.1355
2025-04-15 20:03:03,595 - INFO - Epoch 2/50, Train Loss: 63.5723, Val Loss: 70.8531
2025-04-15 20:03:04,895 - INFO - Epoch 3/50, Train Loss: 67.6652, Val Loss: 75.6774
2025-04-15 20:03:06,274 - INFO - Epoch 4/50, Train Loss: 64.2640, Val Loss: 78.2379
2025-04-15 20:03:07,717 - INFO - Epoch 5/50, Train Loss: 61.7708, Val Loss: 77.7454
2025-04-15 20:03:09,173 - INFO - Epoch 6/50, Train Loss: 62.0722, Val Loss: 73.4443
2025-04-15 20:03:10,926 - INFO - Epoch 7/50, Train Loss: 62.2102, Val Loss: 75.1030
2025-04-15 20:03:12,795 - INFO - Epoch 8/50, Train Loss: 59.6047, Val Loss: 73.2363
2025-04-15 20:03:14,662 - INFO - Epoch 9/50, Train Loss: 59.6311, Val Loss: 72.4355
2025-04-15 20:03:16,529 - INFO - Epoch 10/50, Train Loss: 58.6269, Val Loss: 73.6283
2025-04-15 20:03:18,381 - INFO - Epoch 11/50, Train Loss: 57.0429, Val Loss: 73.5225
2025-04-15 20:03:20,153 - INFO - Epoch 12/50, Train Loss: 55.0136, Val Loss: 68.5453
2025-04-15 20:03:21,741 - INFO - Epoch 13/50, Train Loss: 53.7760, Val Loss: 67.6251
2025-04-15 20:03:23,371 - INFO - Epoch 14/50, Train Loss: 53.0008, Val Loss: 65.8995
2025-04-15 20:03:25,009 - INFO - Epoch 15/50, Train Loss: 51.6290, Val Loss: 66.8045
2025-04-15 20:03:26,670 - INFO - Epoch 16/50, Train Loss: 51.6516, Val Loss: 69.8455
2025-04-15 20:03:28,334 - INFO - Epoch 17/50, Train Loss: 51.0369, Val Loss: 63.8717
2025-04-15 20:03:29,887 - INFO - Epoch 18/50, Train Loss: 49.5245, Val Loss: 71.6843
2025-04-15 20:03:31,544 - INFO - Epoch 19/50, Train Loss: 49.9093, Val Loss: 68.4474
2025-04-15 20:03:33,189 - INFO - Epoch 20/50, Train Loss: 49.2530, Val Loss: 70.5832
2025-04-15 20:03:34,845 - INFO - Epoch 21/50, Train Loss: 48.6325, Val Loss: 72.7943
2025-04-15 20:03:36,624 - INFO - Epoch 22/50, Train Loss: 49.3065, Val Loss: 67.6460
2025-04-15 20:03:38,420 - INFO - Epoch 23/50, Train Loss: 50.2520, Val Loss: 75.5860
2025-04-15 20:03:40,236 - INFO - Epoch 24/50, Train Loss: 48.1491, Val Loss: 69.4163
2025-04-15 20:03:41,981 - INFO - Epoch 25/50, Train Loss: 47.4455, Val Loss: 70.5638
2025-04-15 20:03:43,771 - INFO - Epoch 26/50, Train Loss: 48.2944, Val Loss: 71.4895
2025-04-15 20:03:45,519 - INFO - Epoch 27/50, Train Loss: 46.9911, Val Loss: 69.4931
2025-04-15 20:03:45,519 - INFO - Early stopping at epoch 27. Best epoch: 17
2025-04-15 20:03:46,170 - INFO - Validation metrics - Horizontal: 62.46km, Depth: 8.71km, 3D: 63.87km
[I 2025-04-15 20:03:46,203] Trial 7 finished with value: 62.460243225097656 and parameters: {'time_window': 240, 'spatial_threshold': 150, 'min_connections': 7, 'gnn_type': 'sage', 'hidden_dim': 256, 'num_layers': 6, 'learning_rate': 0.006241875070620387, 'batch_size': 8, 'weight_decay': 1.7838039523057479e-06}. Best is trial 6 with value: 20.55681610107422.
2025-04-15 20:03:46,337 - INFO - 
Trial 8:
2025-04-15 20:03:46,337 - INFO - Graph params: time_window=168, spatial_threshold=75, min_connections=5
2025-04-15 20:03:46,337 - INFO - Model params: gnn_type=sage, hidden_dim=64, num_layers=5
2025-04-15 20:03:46,337 - INFO - Training params: lr=0.0010132415947017672, batch_size=16, weight_decay=0.00035618630303131573
2025-04-15 20:03:46,383 - INFO - Creating graphs with time_window=168h, spatial_threshold=75km, min_connections=5...
Created 402 causal graphs
First graph has 8 nodes and 7 edges
Chronological split - Train: 281, Val: 60, Test: 61 graphs
Creating causal relative spatiotemporal graphs (time window: 168h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 125.18it/s]  7%|▋         | 27/411 [00:00<00:02, 133.38it/s] 10%|▉         | 41/411 [00:00<00:02, 131.43it/s] 13%|█▎        | 55/411 [00:00<00:02, 127.23it/s] 17%|█▋        | 69/411 [00:00<00:02, 129.54it/s] 20%|█▉        | 82/411 [00:00<00:02, 125.37it/s] 23%|██▎       | 96/411 [00:00<00:02, 127.29it/s] 27%|██▋       | 109/411 [00:00<00:02, 126.44it/s] 30%|██▉       | 122/411 [00:00<00:02, 124.29it/s] 33%|███▎      | 135/411 [00:01<00:02, 123.84it/s] 36%|███▌      | 148/411 [00:01<00:02, 123.53it/s] 39%|███▉      | 161/411 [00:01<00:02, 122.98it/s] 42%|████▏     | 174/411 [00:01<00:01, 120.93it/s] 45%|████▌     | 187/411 [00:01<00:01, 122.65it/s] 49%|████▊     | 200/411 [00:01<00:01, 124.51it/s] 52%|█████▏    | 213/411 [00:01<00:01, 124.34it/s] 55%|█████▍    | 226/411 [00:01<00:01, 123.50it/s] 58%|█████▊    | 239/411 [00:01<00:01, 123.79it/s] 61%|██████▏   | 252/411 [00:02<00:01, 124.30it/s] 65%|██████▍   | 266/411 [00:02<00:01, 128.66it/s] 68%|██████▊   | 279/411 [00:02<00:01, 127.50it/s] 71%|███████▏  | 293/411 [00:02<00:00, 129.21it/s] 74%|███████▍  | 306/411 [00:02<00:00, 122.40it/s] 78%|███████▊  | 319/411 [00:02<00:00, 122.80it/s] 81%|████████  | 332/411 [00:02<00:00, 121.02it/s] 84%|████████▍ | 345/411 [00:02<00:00, 119.56it/s] 87%|████████▋ | 357/411 [00:02<00:00, 117.08it/s] 90%|█████████ | 371/411 [00:02<00:00, 122.37it/s] 93%|█████████▎| 384/411 [00:03<00:00, 121.67it/s] 97%|█████████▋| 397/411 [00:03<00:00, 122.25it/s]100%|█████████▉| 410/411 [00:03<00:00, 123.25it/s]100%|██████████| 411/411 [00:03<00:00, 124.13it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 12%|█▏        | 50/409 [00:00<00:00, 496.88it/s] 24%|██▍       | 100/409 [00:00<00:00, 408.72it/s] 36%|███▌      | 146/409 [00:00<00:00, 429.55it/s] 46%|████▋     | 190/409 [00:00<00:00, 318.88it/s] 55%|█████▌    | 226/409 [00:00<00:00, 311.72it/s] 64%|██████▎   | 260/409 [00:00<00:00, 283.68it/s] 71%|███████   | 290/409 [00:00<00:00, 242.26it/s] 77%|███████▋  | 316/409 [00:01<00:00, 212.05it/s] 83%|████████▎ | 339/409 [00:01<00:00, 190.33it/s] 88%|████████▊ | 359/409 [00:01<00:00, 177.43it/s] 92%|█████████▏| 378/409 [00:01<00:00, 172.78it/s] 97%|█████████▋| 397/409 [00:01<00:00, 176.59it/s]100%|██████████| 409/409 [00:01<00:00, 237.01it/s]
2025-04-15 20:03:51,441 - INFO - Created 363 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:03:51,711 - INFO - Training SAGE model...
2025-04-15 20:03:51,711 - INFO - Training Causal Relative GNN model (sage) for 50 epochs...
2025-04-15 20:03:51,849 - INFO - Epoch 1/50, Train Loss: 59.3562, Val Loss: 72.0766
2025-04-15 20:03:51,983 - INFO - Epoch 2/50, Train Loss: 58.4326, Val Loss: 70.3330
2025-04-15 20:03:52,119 - INFO - Epoch 3/50, Train Loss: 56.9917, Val Loss: 68.0956
2025-04-15 20:03:52,261 - INFO - Epoch 4/50, Train Loss: 55.1311, Val Loss: 65.4185
2025-04-15 20:03:52,397 - INFO - Epoch 5/50, Train Loss: 52.4496, Val Loss: 61.9899
2025-04-15 20:03:52,536 - INFO - Epoch 6/50, Train Loss: 49.2788, Val Loss: 58.5630
2025-04-15 20:03:52,674 - INFO - Epoch 7/50, Train Loss: 46.0755, Val Loss: 54.0584
2025-04-15 20:03:52,812 - INFO - Epoch 8/50, Train Loss: 42.6090, Val Loss: 49.8026
2025-04-15 20:03:52,952 - INFO - Epoch 9/50, Train Loss: 41.3653, Val Loss: 48.0214
2025-04-15 20:03:53,092 - INFO - Epoch 10/50, Train Loss: 38.2982, Val Loss: 44.4592
2025-04-15 20:03:53,228 - INFO - Epoch 11/50, Train Loss: 37.4238, Val Loss: 44.0467
2025-04-15 20:03:53,363 - INFO - Epoch 12/50, Train Loss: 36.6973, Val Loss: 42.7408
2025-04-15 20:03:53,496 - INFO - Epoch 13/50, Train Loss: 34.8672, Val Loss: 43.5184
2025-04-15 20:03:53,629 - INFO - Epoch 14/50, Train Loss: 33.0934, Val Loss: 39.7588
2025-04-15 20:03:53,767 - INFO - Epoch 15/50, Train Loss: 32.1077, Val Loss: 39.5294
2025-04-15 20:03:53,901 - INFO - Epoch 16/50, Train Loss: 32.2030, Val Loss: 38.8668
2025-04-15 20:03:54,038 - INFO - Epoch 17/50, Train Loss: 30.0346, Val Loss: 37.2716
2025-04-15 20:03:54,175 - INFO - Epoch 18/50, Train Loss: 31.0842, Val Loss: 37.4335
2025-04-15 20:03:54,309 - INFO - Epoch 19/50, Train Loss: 28.6038, Val Loss: 38.1140
2025-04-15 20:03:54,446 - INFO - Epoch 20/50, Train Loss: 27.9600, Val Loss: 36.0122
2025-04-15 20:03:54,582 - INFO - Epoch 21/50, Train Loss: 28.5807, Val Loss: 34.2569
2025-04-15 20:03:54,716 - INFO - Epoch 22/50, Train Loss: 27.2432, Val Loss: 33.9825
2025-04-15 20:03:54,848 - INFO - Epoch 23/50, Train Loss: 29.0343, Val Loss: 34.1930
2025-04-15 20:03:54,987 - INFO - Epoch 24/50, Train Loss: 29.0910, Val Loss: 32.8578
2025-04-15 20:03:55,124 - INFO - Epoch 25/50, Train Loss: 27.8966, Val Loss: 36.6570
2025-04-15 20:03:55,258 - INFO - Epoch 26/50, Train Loss: 26.2650, Val Loss: 33.9806
2025-04-15 20:03:55,390 - INFO - Epoch 27/50, Train Loss: 27.7308, Val Loss: 35.3518
2025-04-15 20:03:55,525 - INFO - Epoch 28/50, Train Loss: 25.1609, Val Loss: 32.7445
2025-04-15 20:03:55,658 - INFO - Epoch 29/50, Train Loss: 24.2125, Val Loss: 32.6722
2025-04-15 20:03:55,788 - INFO - Epoch 30/50, Train Loss: 23.9947, Val Loss: 34.1627
2025-04-15 20:03:55,922 - INFO - Epoch 31/50, Train Loss: 24.9512, Val Loss: 32.3341
2025-04-15 20:03:56,055 - INFO - Epoch 32/50, Train Loss: 24.2894, Val Loss: 34.2666
2025-04-15 20:03:56,196 - INFO - Epoch 33/50, Train Loss: 24.3946, Val Loss: 32.6780
2025-04-15 20:03:56,329 - INFO - Epoch 34/50, Train Loss: 26.9722, Val Loss: 33.2815
2025-04-15 20:03:56,463 - INFO - Epoch 35/50, Train Loss: 23.8760, Val Loss: 30.5419
2025-04-15 20:03:56,596 - INFO - Epoch 36/50, Train Loss: 22.7149, Val Loss: 32.9408
2025-04-15 20:03:56,729 - INFO - Epoch 37/50, Train Loss: 22.6628, Val Loss: 33.0491
2025-04-15 20:03:56,860 - INFO - Epoch 38/50, Train Loss: 23.7611, Val Loss: 33.0667
2025-04-15 20:03:56,996 - INFO - Epoch 39/50, Train Loss: 22.4118, Val Loss: 31.3208
2025-04-15 20:03:57,130 - INFO - Epoch 40/50, Train Loss: 23.0130, Val Loss: 30.7291
2025-04-15 20:03:57,260 - INFO - Epoch 41/50, Train Loss: 24.4265, Val Loss: 31.8780
2025-04-15 20:03:57,392 - INFO - Epoch 42/50, Train Loss: 23.7248, Val Loss: 32.6143
2025-04-15 20:03:57,523 - INFO - Epoch 43/50, Train Loss: 22.2353, Val Loss: 32.5630
2025-04-15 20:03:57,654 - INFO - Epoch 44/50, Train Loss: 22.1291, Val Loss: 31.6241
2025-04-15 20:03:57,786 - INFO - Epoch 45/50, Train Loss: 22.7283, Val Loss: 32.1274
2025-04-15 20:03:57,786 - INFO - Early stopping at epoch 45. Best epoch: 35
2025-04-15 20:03:58,312 - INFO - Validation metrics - Horizontal: 28.24km, Depth: 9.39km, 3D: 30.54km
[I 2025-04-15 20:03:58,345] Trial 8 finished with value: 28.24344253540039 and parameters: {'time_window': 168, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'sage', 'hidden_dim': 64, 'num_layers': 5, 'learning_rate': 0.0010132415947017672, 'batch_size': 16, 'weight_decay': 0.00035618630303131573}. Best is trial 6 with value: 20.55681610107422.
2025-04-15 20:03:58,488 - INFO - 
Trial 9:
2025-04-15 20:03:58,488 - INFO - Graph params: time_window=168, spatial_threshold=100, min_connections=7
2025-04-15 20:03:58,488 - INFO - Model params: gnn_type=sage, hidden_dim=64, num_layers=3
2025-04-15 20:03:58,488 - INFO - Training params: lr=0.004017660440407427, batch_size=32, weight_decay=2.546237807360665e-06
2025-04-15 20:03:58,540 - INFO - Creating graphs with time_window=168h, spatial_threshold=100km, min_connections=7...
Created 363 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 254, Val: 54, Test: 55 graphs
Creating causal relative spatiotemporal graphs (time window: 168h, spatial threshold: 100km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 128.76it/s]  7%|▋         | 28/411 [00:00<00:02, 136.53it/s] 10%|█         | 42/411 [00:00<00:02, 133.86it/s] 14%|█▎        | 56/411 [00:00<00:02, 133.05it/s] 17%|█▋        | 70/411 [00:00<00:02, 133.32it/s] 20%|██        | 84/411 [00:00<00:02, 128.05it/s] 24%|██▍       | 98/411 [00:00<00:02, 128.60it/s] 27%|██▋       | 111/411 [00:00<00:02, 127.75it/s] 30%|███       | 124/411 [00:00<00:02, 124.37it/s] 33%|███▎      | 137/411 [00:01<00:02, 124.85it/s] 36%|███▋      | 150/411 [00:01<00:02, 124.72it/s] 40%|███▉      | 163/411 [00:01<00:02, 123.47it/s] 43%|████▎     | 176/411 [00:01<00:01, 123.12it/s] 46%|████▌     | 189/411 [00:01<00:01, 124.27it/s] 49%|████▉     | 202/411 [00:01<00:01, 125.90it/s] 52%|█████▏    | 215/411 [00:01<00:01, 124.60it/s] 55%|█████▌    | 228/411 [00:01<00:01, 123.65it/s] 59%|█████▉    | 242/411 [00:01<00:01, 127.19it/s] 62%|██████▏   | 255/411 [00:02<00:01, 124.34it/s] 65%|██████▌   | 269/411 [00:02<00:01, 128.39it/s] 69%|██████▊   | 282/411 [00:02<00:01, 128.60it/s] 72%|███████▏  | 295/411 [00:02<00:00, 127.82it/s] 75%|███████▍  | 308/411 [00:02<00:00, 124.06it/s] 78%|███████▊  | 321/411 [00:02<00:00, 123.01it/s] 81%|████████▏ | 334/411 [00:02<00:00, 122.93it/s] 84%|████████▍ | 347/411 [00:02<00:00, 121.05it/s] 88%|████████▊ | 360/411 [00:02<00:00, 122.26it/s] 91%|█████████ | 373/411 [00:02<00:00, 123.28it/s] 94%|█████████▍| 386/411 [00:03<00:00, 123.30it/s] 97%|█████████▋| 399/411 [00:03<00:00, 124.83it/s]100%|██████████| 411/411 [00:03<00:00, 125.79it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 12%|█▏        | 48/409 [00:00<00:00, 463.58it/s] 23%|██▎       | 95/409 [00:00<00:00, 357.04it/s] 34%|███▍      | 139/409 [00:00<00:00, 387.82it/s] 44%|████▍     | 180/409 [00:00<00:00, 302.52it/s] 52%|█████▏    | 213/409 [00:00<00:00, 276.69it/s] 59%|█████▉    | 243/409 [00:00<00:00, 269.36it/s] 66%|██████▋   | 271/409 [00:00<00:00, 238.49it/s] 72%|███████▏  | 296/409 [00:01<00:00, 205.10it/s] 78%|███████▊  | 318/409 [00:01<00:00, 184.94it/s] 83%|████████▎ | 338/409 [00:01<00:00, 167.56it/s] 87%|████████▋ | 356/409 [00:01<00:00, 156.94it/s] 91%|█████████ | 372/409 [00:01<00:00, 152.36it/s] 95%|█████████▌| 389/409 [00:01<00:00, 156.32it/s]100%|█████████▉| 407/409 [00:01<00:00, 161.74it/s]100%|██████████| 409/409 [00:01<00:00, 213.96it/s]
2025-04-15 20:04:03,741 - INFO - Created 382 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:04:03,832 - INFO - Training SAGE model...
2025-04-15 20:04:03,832 - INFO - Training Causal Relative GNN model (sage) for 50 epochs...
2025-04-15 20:04:03,914 - INFO - Epoch 1/50, Train Loss: 61.6663, Val Loss: 75.2316
2025-04-15 20:04:03,995 - INFO - Epoch 2/50, Train Loss: 58.5954, Val Loss: 70.3819
2025-04-15 20:04:04,076 - INFO - Epoch 3/50, Train Loss: 53.7378, Val Loss: 64.0044
2025-04-15 20:04:04,160 - INFO - Epoch 4/50, Train Loss: 47.8351, Val Loss: 56.4153
2025-04-15 20:04:04,242 - INFO - Epoch 5/50, Train Loss: 43.1303, Val Loss: 52.7908
2025-04-15 20:04:04,324 - INFO - Epoch 6/50, Train Loss: 40.2167, Val Loss: 47.5704
2025-04-15 20:04:04,407 - INFO - Epoch 7/50, Train Loss: 39.2826, Val Loss: 46.6209
2025-04-15 20:04:04,488 - INFO - Epoch 8/50, Train Loss: 40.3348, Val Loss: 51.2701
2025-04-15 20:04:04,569 - INFO - Epoch 9/50, Train Loss: 40.4997, Val Loss: 42.8616
2025-04-15 20:04:04,647 - INFO - Epoch 10/50, Train Loss: 37.1670, Val Loss: 43.5157
2025-04-15 20:04:04,726 - INFO - Epoch 11/50, Train Loss: 34.4316, Val Loss: 45.9243
2025-04-15 20:04:04,810 - INFO - Epoch 12/50, Train Loss: 33.7407, Val Loss: 41.9965
2025-04-15 20:04:04,891 - INFO - Epoch 13/50, Train Loss: 32.2062, Val Loss: 42.8170
2025-04-15 20:04:04,971 - INFO - Epoch 14/50, Train Loss: 31.5911, Val Loss: 41.8001
2025-04-15 20:04:05,050 - INFO - Epoch 15/50, Train Loss: 31.8570, Val Loss: 42.6593
2025-04-15 20:04:05,132 - INFO - Epoch 16/50, Train Loss: 31.3261, Val Loss: 38.3491
2025-04-15 20:04:05,210 - INFO - Epoch 17/50, Train Loss: 29.0885, Val Loss: 42.9122
2025-04-15 20:04:05,289 - INFO - Epoch 18/50, Train Loss: 30.3381, Val Loss: 39.8819
2025-04-15 20:04:05,371 - INFO - Epoch 19/50, Train Loss: 29.8934, Val Loss: 38.0374
2025-04-15 20:04:05,450 - INFO - Epoch 20/50, Train Loss: 28.7848, Val Loss: 41.3476
2025-04-15 20:04:05,531 - INFO - Epoch 21/50, Train Loss: 28.9530, Val Loss: 38.6636
2025-04-15 20:04:05,613 - INFO - Epoch 22/50, Train Loss: 29.8390, Val Loss: 39.2635
2025-04-15 20:04:05,692 - INFO - Epoch 23/50, Train Loss: 28.7612, Val Loss: 37.4778
2025-04-15 20:04:05,774 - INFO - Epoch 24/50, Train Loss: 27.9579, Val Loss: 33.1814
2025-04-15 20:04:05,854 - INFO - Epoch 25/50, Train Loss: 26.7594, Val Loss: 38.1609
2025-04-15 20:04:05,935 - INFO - Epoch 26/50, Train Loss: 27.5689, Val Loss: 39.8181
2025-04-15 20:04:06,014 - INFO - Epoch 27/50, Train Loss: 27.6920, Val Loss: 38.2556
2025-04-15 20:04:06,097 - INFO - Epoch 28/50, Train Loss: 26.5380, Val Loss: 39.2134
2025-04-15 20:04:06,178 - INFO - Epoch 29/50, Train Loss: 27.8624, Val Loss: 38.2289
2025-04-15 20:04:06,258 - INFO - Epoch 30/50, Train Loss: 26.3702, Val Loss: 34.6625
2025-04-15 20:04:06,337 - INFO - Epoch 31/50, Train Loss: 27.5080, Val Loss: 35.3591
2025-04-15 20:04:06,414 - INFO - Epoch 32/50, Train Loss: 25.8901, Val Loss: 35.7181
2025-04-15 20:04:06,491 - INFO - Epoch 33/50, Train Loss: 25.0690, Val Loss: 35.2341
2025-04-15 20:04:06,571 - INFO - Epoch 34/50, Train Loss: 25.1368, Val Loss: 38.4980
2025-04-15 20:04:06,571 - INFO - Early stopping at epoch 34. Best epoch: 24
2025-04-15 20:04:07,086 - INFO - Validation metrics - Horizontal: 30.11km, Depth: 11.02km, 3D: 33.18km
[I 2025-04-15 20:04:07,120] Trial 9 finished with value: 30.107370376586914 and parameters: {'time_window': 168, 'spatial_threshold': 100, 'min_connections': 7, 'gnn_type': 'sage', 'hidden_dim': 64, 'num_layers': 3, 'learning_rate': 0.004017660440407427, 'batch_size': 32, 'weight_decay': 2.546237807360665e-06}. Best is trial 6 with value: 20.55681610107422.
2025-04-15 20:04:07,285 - INFO - 
Trial 10:
2025-04-15 20:04:07,285 - INFO - Graph params: time_window=120, spatial_threshold=200, min_connections=2
2025-04-15 20:04:07,285 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=6
2025-04-15 20:04:07,285 - INFO - Training params: lr=0.0010616410854298653, batch_size=16, weight_decay=8.903361196407772e-06
2025-04-15 20:04:07,332 - INFO - Creating graphs with time_window=120h, spatial_threshold=200km, min_connections=2...
Created 382 causal graphs
First graph has 8 nodes and 7 edges
Chronological split - Train: 267, Val: 57, Test: 58 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 200km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 134.63it/s]  7%|▋         | 28/411 [00:00<00:02, 137.15it/s] 10%|█         | 42/411 [00:00<00:02, 134.61it/s] 14%|█▎        | 56/411 [00:00<00:02, 133.83it/s] 17%|█▋        | 70/411 [00:00<00:02, 134.14it/s] 20%|██        | 84/411 [00:00<00:02, 131.76it/s] 24%|██▍       | 98/411 [00:00<00:02, 132.89it/s] 27%|██▋       | 112/411 [00:00<00:02, 130.04it/s] 31%|███       | 126/411 [00:00<00:02, 126.75it/s] 34%|███▍      | 139/411 [00:01<00:02, 126.14it/s] 37%|███▋      | 152/411 [00:01<00:02, 126.05it/s] 40%|████      | 165/411 [00:01<00:01, 124.07it/s] 43%|████▎     | 178/411 [00:01<00:01, 123.40it/s] 47%|████▋     | 192/411 [00:01<00:01, 125.95it/s] 50%|████▉     | 205/411 [00:01<00:01, 126.64it/s] 53%|█████▎    | 218/411 [00:01<00:01, 127.38it/s] 56%|█████▌    | 231/411 [00:01<00:01, 126.48it/s] 60%|█████▉    | 245/411 [00:01<00:01, 128.50it/s] 63%|██████▎   | 258/411 [00:02<00:01, 128.83it/s] 66%|██████▋   | 273/411 [00:02<00:01, 132.62it/s] 70%|██████▉   | 287/411 [00:02<00:00, 130.46it/s] 73%|███████▎  | 301/411 [00:02<00:00, 124.11it/s] 76%|███████▋  | 314/411 [00:02<00:00, 123.79it/s] 80%|███████▉  | 327/411 [00:02<00:00, 125.10it/s] 83%|████████▎ | 340/411 [00:02<00:00, 121.38it/s] 86%|████████▌ | 353/411 [00:02<00:00, 118.98it/s] 90%|████████▉ | 368/411 [00:02<00:00, 126.88it/s] 93%|█████████▎| 381/411 [00:02<00:00, 124.04it/s] 96%|█████████▌| 394/411 [00:03<00:00, 125.01it/s] 99%|█████████▉| 408/411 [00:03<00:00, 127.34it/s]100%|██████████| 411/411 [00:03<00:00, 127.21it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 12%|█▏        | 49/409 [00:00<00:00, 487.42it/s] 24%|██▍       | 98/409 [00:00<00:00, 403.15it/s] 35%|███▍      | 142/409 [00:00<00:00, 413.96it/s] 45%|████▍     | 184/409 [00:00<00:00, 299.41it/s] 53%|█████▎    | 218/409 [00:00<00:00, 296.83it/s] 61%|██████    | 250/409 [00:00<00:00, 272.34it/s] 68%|██████▊   | 279/409 [00:00<00:00, 234.74it/s] 74%|███████▍  | 304/409 [00:01<00:00, 201.61it/s] 80%|███████▉  | 326/409 [00:01<00:00, 177.96it/s] 84%|████████▍ | 345/409 [00:01<00:00, 166.72it/s] 89%|████████▉ | 363/409 [00:01<00:00, 162.65it/s] 93%|█████████▎| 380/409 [00:01<00:00, 163.80it/s] 98%|█████████▊| 401/409 [00:01<00:00, 174.12it/s]100%|██████████| 409/409 [00:01<00:00, 224.46it/s]
2025-04-15 20:04:12,406 - INFO - Created 409 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:04:12,502 - INFO - Training GAT model...
2025-04-15 20:04:12,502 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:04:13,474 - INFO - Epoch 1/50, Train Loss: 67.4851, Val Loss: 79.6360
2025-04-15 20:04:14,484 - INFO - Epoch 2/50, Train Loss: 65.8986, Val Loss: 79.6365
2025-04-15 20:04:15,484 - INFO - Epoch 3/50, Train Loss: 63.8160, Val Loss: 75.3008
2025-04-15 20:04:16,496 - INFO - Epoch 4/50, Train Loss: 63.2486, Val Loss: 78.3793
2025-04-15 20:04:17,503 - INFO - Epoch 5/50, Train Loss: 64.7173, Val Loss: 80.9804
2025-04-15 20:04:18,469 - INFO - Epoch 6/50, Train Loss: 63.2778, Val Loss: 77.0492
2025-04-15 20:04:19,425 - INFO - Epoch 7/50, Train Loss: 62.8317, Val Loss: 77.5987
2025-04-15 20:04:20,394 - INFO - Epoch 8/50, Train Loss: 61.7113, Val Loss: 72.7446
2025-04-15 20:04:21,339 - INFO - Epoch 9/50, Train Loss: 61.3852, Val Loss: 72.5808
2025-04-15 20:04:22,296 - INFO - Epoch 10/50, Train Loss: 62.1697, Val Loss: 75.6091
2025-04-15 20:04:23,278 - INFO - Epoch 11/50, Train Loss: 63.5232, Val Loss: 72.5402
2025-04-15 20:04:24,231 - INFO - Epoch 12/50, Train Loss: 62.6416, Val Loss: 79.3503
2025-04-15 20:04:25,185 - INFO - Epoch 13/50, Train Loss: 62.5805, Val Loss: 76.7764
2025-04-15 20:04:26,152 - INFO - Epoch 14/50, Train Loss: 60.5767, Val Loss: 72.0778
2025-04-15 20:04:27,124 - INFO - Epoch 15/50, Train Loss: 60.5502, Val Loss: 69.7350
2025-04-15 20:04:28,090 - INFO - Epoch 16/50, Train Loss: 59.7953, Val Loss: 74.0930
2025-04-15 20:04:29,083 - INFO - Epoch 17/50, Train Loss: 60.8318, Val Loss: 73.4785
2025-04-15 20:04:30,093 - INFO - Epoch 18/50, Train Loss: 60.9357, Val Loss: 75.1305
2025-04-15 20:04:31,102 - INFO - Epoch 19/50, Train Loss: 60.0872, Val Loss: 71.2885
2025-04-15 20:04:32,092 - INFO - Epoch 20/50, Train Loss: 59.8300, Val Loss: 69.3020
2025-04-15 20:04:33,082 - INFO - Epoch 21/50, Train Loss: 60.4640, Val Loss: 69.7481
2025-04-15 20:04:34,055 - INFO - Epoch 22/50, Train Loss: 59.6327, Val Loss: 70.7524
2025-04-15 20:04:35,029 - INFO - Epoch 23/50, Train Loss: 59.0348, Val Loss: 69.7379
2025-04-15 20:04:36,009 - INFO - Epoch 24/50, Train Loss: 62.3307, Val Loss: 80.1273
2025-04-15 20:04:36,990 - INFO - Epoch 25/50, Train Loss: 60.8622, Val Loss: 74.7276
2025-04-15 20:04:37,967 - INFO - Epoch 26/50, Train Loss: 59.6446, Val Loss: 73.8019
2025-04-15 20:04:38,991 - INFO - Epoch 27/50, Train Loss: 58.8404, Val Loss: 73.0978
2025-04-15 20:04:40,006 - INFO - Epoch 28/50, Train Loss: 58.2554, Val Loss: 71.8676
2025-04-15 20:04:41,001 - INFO - Epoch 29/50, Train Loss: 58.5252, Val Loss: 75.6927
2025-04-15 20:04:42,031 - INFO - Epoch 30/50, Train Loss: 57.5446, Val Loss: 72.8398
2025-04-15 20:04:42,031 - INFO - Early stopping at epoch 30. Best epoch: 20
2025-04-15 20:04:42,662 - INFO - Validation metrics - Horizontal: 66.68km, Depth: 14.86km, 3D: 69.30km
[I 2025-04-15 20:04:42,699] Trial 10 finished with value: 66.678466796875 and parameters: {'time_window': 120, 'spatial_threshold': 200, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 6, 'learning_rate': 0.0010616410854298653, 'batch_size': 16, 'weight_decay': 8.903361196407772e-06}. Best is trial 6 with value: 20.55681610107422.
2025-04-15 20:04:42,851 - INFO - 
Trial 11:
2025-04-15 20:04:42,851 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:04:42,851 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=2
2025-04-15 20:04:42,851 - INFO - Training params: lr=0.001952501949379536, batch_size=8, weight_decay=1.6775717691886055e-05
2025-04-15 20:04:42,898 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 409 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 286, Val: 61, Test: 62 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 133.45it/s]  7%|▋         | 28/411 [00:00<00:02, 136.56it/s] 10%|█         | 42/411 [00:00<00:02, 134.46it/s] 14%|█▎        | 56/411 [00:00<00:02, 133.99it/s] 17%|█▋        | 70/411 [00:00<00:02, 134.55it/s] 20%|██        | 84/411 [00:00<00:02, 132.42it/s] 24%|██▍       | 98/411 [00:00<00:02, 133.31it/s] 27%|██▋       | 112/411 [00:00<00:02, 130.54it/s] 31%|███       | 126/411 [00:00<00:02, 128.55it/s] 34%|███▍      | 139/411 [00:01<00:02, 127.95it/s] 37%|███▋      | 152/411 [00:01<00:02, 127.05it/s] 40%|████      | 165/411 [00:01<00:01, 124.92it/s] 43%|████▎     | 178/411 [00:01<00:01, 123.76it/s] 47%|████▋     | 192/411 [00:01<00:01, 125.86it/s] 50%|████▉     | 205/411 [00:01<00:01, 125.80it/s] 53%|█████▎    | 218/411 [00:01<00:01, 126.20it/s] 56%|█████▌    | 231/411 [00:01<00:01, 125.44it/s] 60%|█████▉    | 245/411 [00:01<00:01, 127.13it/s] 63%|██████▎   | 258/411 [00:02<00:01, 127.93it/s] 66%|██████▋   | 273/411 [00:02<00:01, 132.19it/s] 70%|██████▉   | 287/411 [00:02<00:00, 129.80it/s] 73%|███████▎  | 300/411 [00:02<00:00, 124.43it/s] 76%|███████▌  | 313/411 [00:02<00:00, 123.88it/s] 79%|███████▉  | 326/411 [00:02<00:00, 125.55it/s] 82%|████████▏ | 339/411 [00:02<00:00, 121.66it/s] 86%|████████▌ | 352/411 [00:02<00:00, 119.94it/s] 89%|████████▉ | 367/411 [00:02<00:00, 126.06it/s] 92%|█████████▏| 380/411 [00:02<00:00, 123.78it/s] 96%|█████████▌| 393/411 [00:03<00:00, 125.18it/s] 99%|█████████▉| 407/411 [00:03<00:00, 126.96it/s]100%|██████████| 411/411 [00:03<00:00, 127.20it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 553.97it/s] 27%|██▋       | 112/409 [00:00<00:00, 541.48it/s] 41%|████      | 167/409 [00:00<00:00, 462.35it/s] 53%|█████▎    | 215/409 [00:00<00:00, 384.94it/s] 63%|██████▎   | 256/409 [00:00<00:00, 346.27it/s] 71%|███████▏  | 292/409 [00:00<00:00, 291.72it/s] 79%|███████▉  | 323/409 [00:01<00:00, 248.65it/s] 86%|████████▌ | 350/409 [00:01<00:00, 228.66it/s] 91%|█████████▏| 374/409 [00:01<00:00, 223.22it/s] 97%|█████████▋| 398/409 [00:01<00:00, 226.07it/s]100%|██████████| 409/409 [00:01<00:00, 288.19it/s]
2025-04-15 20:04:47,569 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:04:47,642 - INFO - Training GAT model...
2025-04-15 20:04:47,642 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:04:47,930 - INFO - Epoch 1/50, Train Loss: 52.7656, Val Loss: 59.7974
2025-04-15 20:04:48,218 - INFO - Epoch 2/50, Train Loss: 43.8069, Val Loss: 47.4618
2025-04-15 20:04:48,496 - INFO - Epoch 3/50, Train Loss: 37.2137, Val Loss: 36.4078
2025-04-15 20:04:48,770 - INFO - Epoch 4/50, Train Loss: 35.8684, Val Loss: 39.3079
2025-04-15 20:04:49,046 - INFO - Epoch 5/50, Train Loss: 37.2478, Val Loss: 42.1425
2025-04-15 20:04:49,335 - INFO - Epoch 6/50, Train Loss: 33.1067, Val Loss: 37.5626
2025-04-15 20:04:49,610 - INFO - Epoch 7/50, Train Loss: 32.0498, Val Loss: 43.2342
2025-04-15 20:04:49,899 - INFO - Epoch 8/50, Train Loss: 30.9008, Val Loss: 34.2069
2025-04-15 20:04:50,188 - INFO - Epoch 9/50, Train Loss: 29.7551, Val Loss: 30.8733
2025-04-15 20:04:50,481 - INFO - Epoch 10/50, Train Loss: 28.6904, Val Loss: 32.4669
2025-04-15 20:04:50,765 - INFO - Epoch 11/50, Train Loss: 27.5003, Val Loss: 29.8472
2025-04-15 20:04:51,048 - INFO - Epoch 12/50, Train Loss: 26.6545, Val Loss: 27.6158
2025-04-15 20:04:51,339 - INFO - Epoch 13/50, Train Loss: 27.2553, Val Loss: 34.1098
2025-04-15 20:04:51,622 - INFO - Epoch 14/50, Train Loss: 29.3721, Val Loss: 28.9653
2025-04-15 20:04:51,912 - INFO - Epoch 15/50, Train Loss: 25.6450, Val Loss: 35.1392
2025-04-15 20:04:52,204 - INFO - Epoch 16/50, Train Loss: 26.5339, Val Loss: 27.1110
2025-04-15 20:04:52,481 - INFO - Epoch 17/50, Train Loss: 25.2135, Val Loss: 31.1450
2025-04-15 20:04:52,769 - INFO - Epoch 18/50, Train Loss: 26.1127, Val Loss: 27.5959
2025-04-15 20:04:53,059 - INFO - Epoch 19/50, Train Loss: 24.0265, Val Loss: 26.6025
2025-04-15 20:04:53,350 - INFO - Epoch 20/50, Train Loss: 25.0031, Val Loss: 27.0034
2025-04-15 20:04:53,632 - INFO - Epoch 21/50, Train Loss: 23.8441, Val Loss: 28.2942
2025-04-15 20:04:53,910 - INFO - Epoch 22/50, Train Loss: 24.8004, Val Loss: 24.0629
2025-04-15 20:04:54,203 - INFO - Epoch 23/50, Train Loss: 23.8984, Val Loss: 24.9453
2025-04-15 20:04:54,490 - INFO - Epoch 24/50, Train Loss: 24.8219, Val Loss: 24.7527
2025-04-15 20:04:54,775 - INFO - Epoch 25/50, Train Loss: 23.3842, Val Loss: 25.1301
2025-04-15 20:04:55,067 - INFO - Epoch 26/50, Train Loss: 22.8606, Val Loss: 23.8133
2025-04-15 20:04:55,352 - INFO - Epoch 27/50, Train Loss: 22.9864, Val Loss: 28.7313
2025-04-15 20:04:55,644 - INFO - Epoch 28/50, Train Loss: 23.9102, Val Loss: 26.2200
2025-04-15 20:04:55,922 - INFO - Epoch 29/50, Train Loss: 22.4975, Val Loss: 25.2917
2025-04-15 20:04:56,216 - INFO - Epoch 30/50, Train Loss: 24.2088, Val Loss: 29.1401
2025-04-15 20:04:56,509 - INFO - Epoch 31/50, Train Loss: 24.2702, Val Loss: 25.7568
2025-04-15 20:04:56,804 - INFO - Epoch 32/50, Train Loss: 22.8706, Val Loss: 25.7756
2025-04-15 20:04:57,092 - INFO - Epoch 33/50, Train Loss: 22.0997, Val Loss: 24.3497
2025-04-15 20:04:57,380 - INFO - Epoch 34/50, Train Loss: 21.7661, Val Loss: 24.5230
2025-04-15 20:04:57,669 - INFO - Epoch 35/50, Train Loss: 21.6033, Val Loss: 23.5880
2025-04-15 20:04:57,952 - INFO - Epoch 36/50, Train Loss: 21.0428, Val Loss: 25.2135
2025-04-15 20:04:58,233 - INFO - Epoch 37/50, Train Loss: 20.7611, Val Loss: 25.7292
2025-04-15 20:04:58,508 - INFO - Epoch 38/50, Train Loss: 19.7528, Val Loss: 25.3405
2025-04-15 20:04:58,786 - INFO - Epoch 39/50, Train Loss: 20.0544, Val Loss: 25.9128
2025-04-15 20:04:59,069 - INFO - Epoch 40/50, Train Loss: 21.9600, Val Loss: 24.1436
2025-04-15 20:04:59,354 - INFO - Epoch 41/50, Train Loss: 20.7236, Val Loss: 25.6829
2025-04-15 20:04:59,645 - INFO - Epoch 42/50, Train Loss: 20.1190, Val Loss: 23.6302
2025-04-15 20:04:59,924 - INFO - Epoch 43/50, Train Loss: 20.1837, Val Loss: 24.1746
2025-04-15 20:05:00,222 - INFO - Epoch 44/50, Train Loss: 19.9603, Val Loss: 25.5141
2025-04-15 20:05:00,506 - INFO - Epoch 45/50, Train Loss: 20.8314, Val Loss: 25.8952
2025-04-15 20:05:00,506 - INFO - Early stopping at epoch 45. Best epoch: 35
2025-04-15 20:05:01,064 - INFO - Validation metrics - Horizontal: 20.47km, Depth: 8.49km, 3D: 23.59km
[I 2025-04-15 20:05:01,099] Trial 11 finished with value: 20.46588897705078 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 2, 'learning_rate': 0.001952501949379536, 'batch_size': 8, 'weight_decay': 1.6775717691886055e-05}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:05:01,256 - INFO - 
Trial 12:
2025-04-15 20:05:01,256 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:05:01,256 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=4
2025-04-15 20:05:01,256 - INFO - Training params: lr=0.0015037384575525322, batch_size=8, weight_decay=9.45922579115362e-06
2025-04-15 20:05:01,306 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 129.74it/s]  7%|▋         | 28/411 [00:00<00:02, 135.41it/s] 10%|█         | 42/411 [00:00<00:02, 133.03it/s] 14%|█▎        | 56/411 [00:00<00:02, 131.12it/s] 17%|█▋        | 70/411 [00:00<00:02, 131.69it/s] 20%|██        | 84/411 [00:00<00:02, 129.01it/s] 24%|██▍       | 98/411 [00:00<00:02, 129.70it/s] 27%|██▋       | 111/411 [00:00<00:02, 128.12it/s] 30%|███       | 124/411 [00:00<00:02, 124.61it/s] 33%|███▎      | 137/411 [00:01<00:02, 123.57it/s] 36%|███▋      | 150/411 [00:01<00:02, 123.13it/s] 40%|███▉      | 163/411 [00:01<00:02, 122.16it/s] 43%|████▎     | 176/411 [00:01<00:01, 122.19it/s] 46%|████▌     | 189/411 [00:01<00:01, 123.48it/s] 49%|████▉     | 203/411 [00:01<00:01, 125.07it/s] 53%|█████▎    | 216/411 [00:01<00:01, 124.19it/s] 56%|█████▌    | 229/411 [00:01<00:01, 123.50it/s] 59%|█████▉    | 243/411 [00:01<00:01, 126.85it/s] 62%|██████▏   | 256/411 [00:02<00:01, 125.43it/s] 66%|██████▌   | 270/411 [00:02<00:01, 128.80it/s] 69%|██████▉   | 283/411 [00:02<00:01, 127.08it/s] 72%|███████▏  | 296/411 [00:02<00:00, 125.86it/s] 75%|███████▌  | 309/411 [00:02<00:00, 118.29it/s] 78%|███████▊  | 322/411 [00:02<00:00, 118.81it/s] 82%|████████▏ | 335/411 [00:02<00:00, 119.24it/s] 84%|████████▍ | 347/411 [00:02<00:00, 118.71it/s] 88%|████████▊ | 360/411 [00:02<00:00, 120.30it/s] 91%|█████████ | 373/411 [00:02<00:00, 121.90it/s] 94%|█████████▍| 386/411 [00:03<00:00, 121.36it/s] 97%|█████████▋| 399/411 [00:03<00:00, 123.18it/s]100%|██████████| 411/411 [00:03<00:00, 124.55it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 554.57it/s] 27%|██▋       | 112/409 [00:00<00:00, 540.06it/s] 41%|████      | 167/409 [00:00<00:00, 460.17it/s] 53%|█████▎    | 215/409 [00:00<00:00, 383.38it/s] 63%|██████▎   | 256/409 [00:00<00:00, 345.23it/s] 71%|███████▏  | 292/409 [00:00<00:00, 290.30it/s] 79%|███████▉  | 323/409 [00:01<00:00, 247.54it/s] 86%|████████▌ | 350/409 [00:01<00:00, 227.86it/s] 91%|█████████▏| 374/409 [00:01<00:00, 222.22it/s] 97%|█████████▋| 398/409 [00:01<00:00, 225.10it/s]100%|██████████| 409/409 [00:01<00:00, 287.03it/s]
2025-04-15 20:05:06,053 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:05:06,130 - INFO - Training GAT model...
2025-04-15 20:05:06,130 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:05:06,655 - INFO - Epoch 1/50, Train Loss: 53.2531, Val Loss: 62.2410
2025-04-15 20:05:07,174 - INFO - Epoch 2/50, Train Loss: 46.9414, Val Loss: 54.5829
2025-04-15 20:05:07,683 - INFO - Epoch 3/50, Train Loss: 42.1823, Val Loss: 47.8765
2025-04-15 20:05:08,184 - INFO - Epoch 4/50, Train Loss: 41.1876, Val Loss: 41.7530
2025-04-15 20:05:08,684 - INFO - Epoch 5/50, Train Loss: 39.6150, Val Loss: 47.4820
2025-04-15 20:05:09,189 - INFO - Epoch 6/50, Train Loss: 36.4880, Val Loss: 41.7466
2025-04-15 20:05:09,687 - INFO - Epoch 7/50, Train Loss: 35.3614, Val Loss: 38.4608
2025-04-15 20:05:10,205 - INFO - Epoch 8/50, Train Loss: 35.1238, Val Loss: 39.1359
2025-04-15 20:05:10,725 - INFO - Epoch 9/50, Train Loss: 31.7066, Val Loss: 37.0383
2025-04-15 20:05:11,242 - INFO - Epoch 10/50, Train Loss: 32.6988, Val Loss: 38.5532
2025-04-15 20:05:11,742 - INFO - Epoch 11/50, Train Loss: 33.7398, Val Loss: 37.4183
2025-04-15 20:05:12,253 - INFO - Epoch 12/50, Train Loss: 31.5248, Val Loss: 41.0594
2025-04-15 20:05:12,748 - INFO - Epoch 13/50, Train Loss: 32.3956, Val Loss: 35.4592
2025-04-15 20:05:13,262 - INFO - Epoch 14/50, Train Loss: 30.9059, Val Loss: 34.4908
2025-04-15 20:05:13,763 - INFO - Epoch 15/50, Train Loss: 30.4109, Val Loss: 31.1004
2025-04-15 20:05:14,248 - INFO - Epoch 16/50, Train Loss: 30.7821, Val Loss: 35.4354
2025-04-15 20:05:14,738 - INFO - Epoch 17/50, Train Loss: 29.5503, Val Loss: 35.6810
2025-04-15 20:05:15,243 - INFO - Epoch 18/50, Train Loss: 29.7335, Val Loss: 36.9793
2025-04-15 20:05:15,737 - INFO - Epoch 19/50, Train Loss: 30.4885, Val Loss: 31.6612
2025-04-15 20:05:16,242 - INFO - Epoch 20/50, Train Loss: 30.4234, Val Loss: 34.9201
2025-04-15 20:05:16,733 - INFO - Epoch 21/50, Train Loss: 30.3875, Val Loss: 29.0318
2025-04-15 20:05:17,246 - INFO - Epoch 22/50, Train Loss: 28.9624, Val Loss: 29.8387
2025-04-15 20:05:17,756 - INFO - Epoch 23/50, Train Loss: 29.8973, Val Loss: 28.0971
2025-04-15 20:05:18,256 - INFO - Epoch 24/50, Train Loss: 29.4717, Val Loss: 33.8150
2025-04-15 20:05:18,762 - INFO - Epoch 25/50, Train Loss: 27.6823, Val Loss: 27.0101
2025-04-15 20:05:19,284 - INFO - Epoch 26/50, Train Loss: 29.0886, Val Loss: 27.3591
2025-04-15 20:05:19,779 - INFO - Epoch 27/50, Train Loss: 28.3270, Val Loss: 29.3322
2025-04-15 20:05:20,299 - INFO - Epoch 28/50, Train Loss: 29.1131, Val Loss: 27.4607
2025-04-15 20:05:20,804 - INFO - Epoch 29/50, Train Loss: 26.6852, Val Loss: 31.3318
2025-04-15 20:05:21,312 - INFO - Epoch 30/50, Train Loss: 26.3992, Val Loss: 24.8166
2025-04-15 20:05:21,803 - INFO - Epoch 31/50, Train Loss: 27.0261, Val Loss: 31.0369
2025-04-15 20:05:22,302 - INFO - Epoch 32/50, Train Loss: 26.6320, Val Loss: 28.0136
2025-04-15 20:05:22,801 - INFO - Epoch 33/50, Train Loss: 26.9385, Val Loss: 36.0126
2025-04-15 20:05:23,311 - INFO - Epoch 34/50, Train Loss: 24.5039, Val Loss: 31.0056
2025-04-15 20:05:23,797 - INFO - Epoch 35/50, Train Loss: 27.5984, Val Loss: 27.5436
2025-04-15 20:05:24,288 - INFO - Epoch 36/50, Train Loss: 25.7312, Val Loss: 28.3491
2025-04-15 20:05:24,781 - INFO - Epoch 37/50, Train Loss: 24.6512, Val Loss: 28.4896
2025-04-15 20:05:25,275 - INFO - Epoch 38/50, Train Loss: 24.5969, Val Loss: 28.9190
2025-04-15 20:05:25,768 - INFO - Epoch 39/50, Train Loss: 26.7420, Val Loss: 26.7345
2025-04-15 20:05:26,266 - INFO - Epoch 40/50, Train Loss: 23.7322, Val Loss: 29.2675
2025-04-15 20:05:26,266 - INFO - Early stopping at epoch 40. Best epoch: 30
2025-04-15 20:05:26,850 - INFO - Validation metrics - Horizontal: 21.38km, Depth: 8.80km, 3D: 24.82km
[I 2025-04-15 20:05:26,884] Trial 12 finished with value: 21.384504318237305 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 4, 'learning_rate': 0.0015037384575525322, 'batch_size': 8, 'weight_decay': 9.45922579115362e-06}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:05:27,037 - INFO - 
Trial 13:
2025-04-15 20:05:27,037 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=2
2025-04-15 20:05:27,037 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=4
2025-04-15 20:05:27,037 - INFO - Training params: lr=0.0004653009585528704, batch_size=8, weight_decay=8.438089685544488e-06
2025-04-15 20:05:27,081 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=2...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 136.08it/s]  7%|▋         | 29/411 [00:00<00:02, 138.05it/s] 10%|█         | 43/411 [00:00<00:02, 138.06it/s] 14%|█▍        | 57/411 [00:00<00:02, 134.14it/s] 17%|█▋        | 71/411 [00:00<00:02, 136.05it/s] 21%|██        | 85/411 [00:00<00:02, 131.06it/s] 24%|██▍       | 100/411 [00:00<00:02, 133.08it/s] 28%|██▊       | 114/411 [00:00<00:02, 130.77it/s] 31%|███       | 128/411 [00:00<00:02, 128.72it/s] 34%|███▍      | 141/411 [00:01<00:02, 126.42it/s] 37%|███▋      | 154/411 [00:01<00:02, 126.54it/s] 41%|████      | 167/411 [00:01<00:01, 124.88it/s] 44%|████▍     | 181/411 [00:01<00:01, 126.92it/s] 47%|████▋     | 195/411 [00:01<00:01, 127.77it/s] 51%|█████     | 209/411 [00:01<00:01, 130.07it/s] 54%|█████▍    | 223/411 [00:01<00:01, 127.47it/s] 58%|█████▊    | 237/411 [00:01<00:01, 128.74it/s] 61%|██████    | 250/411 [00:01<00:01, 128.80it/s] 64%|██████▍   | 264/411 [00:02<00:01, 130.39it/s] 68%|██████▊   | 278/411 [00:02<00:01, 128.76it/s] 71%|███████   | 292/411 [00:02<00:00, 131.12it/s] 74%|███████▍  | 306/411 [00:02<00:00, 124.83it/s] 78%|███████▊  | 319/411 [00:02<00:00, 125.39it/s] 81%|████████  | 332/411 [00:02<00:00, 123.96it/s] 84%|████████▍ | 345/411 [00:02<00:00, 123.38it/s] 87%|████████▋ | 358/411 [00:02<00:00, 122.42it/s] 91%|█████████ | 372/411 [00:02<00:00, 126.77it/s] 94%|█████████▎| 385/411 [00:03<00:00, 125.76it/s] 97%|█████████▋| 398/411 [00:03<00:00, 126.54it/s]100%|██████████| 411/411 [00:03<00:00, 127.41it/s]100%|██████████| 411/411 [00:03<00:00, 128.34it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 549.71it/s] 27%|██▋       | 111/409 [00:00<00:00, 533.46it/s] 40%|████      | 165/409 [00:00<00:00, 461.79it/s] 52%|█████▏    | 213/409 [00:00<00:00, 380.49it/s] 62%|██████▏   | 253/409 [00:00<00:00, 347.02it/s] 71%|███████   | 289/409 [00:00<00:00, 292.65it/s] 78%|███████▊  | 320/409 [00:00<00:00, 250.37it/s] 85%|████████▍ | 347/409 [00:01<00:00, 227.26it/s] 91%|█████████ | 371/409 [00:01<00:00, 221.25it/s] 96%|█████████▋| 394/409 [00:01<00:00, 222.30it/s]100%|██████████| 409/409 [00:01<00:00, 285.76it/s]
2025-04-15 20:05:31,736 - INFO - Created 388 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:05:31,817 - INFO - Training GAT model...
2025-04-15 20:05:31,817 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:05:32,375 - INFO - Epoch 1/50, Train Loss: 62.9489, Val Loss: 75.1024
2025-04-15 20:05:32,923 - INFO - Epoch 2/50, Train Loss: 60.2630, Val Loss: 69.9902
2025-04-15 20:05:33,470 - INFO - Epoch 3/50, Train Loss: 55.9778, Val Loss: 64.1290
2025-04-15 20:05:34,016 - INFO - Epoch 4/50, Train Loss: 51.2978, Val Loss: 58.7815
2025-04-15 20:05:34,568 - INFO - Epoch 5/50, Train Loss: 47.9408, Val Loss: 53.4940
2025-04-15 20:05:35,107 - INFO - Epoch 6/50, Train Loss: 45.3583, Val Loss: 50.9924
2025-04-15 20:05:35,626 - INFO - Epoch 7/50, Train Loss: 42.9007, Val Loss: 48.7360
2025-04-15 20:05:36,145 - INFO - Epoch 8/50, Train Loss: 41.7463, Val Loss: 44.3744
2025-04-15 20:05:36,664 - INFO - Epoch 9/50, Train Loss: 40.0665, Val Loss: 42.3346
2025-04-15 20:05:37,215 - INFO - Epoch 10/50, Train Loss: 38.0720, Val Loss: 40.7079
2025-04-15 20:05:37,741 - INFO - Epoch 11/50, Train Loss: 37.2147, Val Loss: 40.2005
2025-04-15 20:05:38,266 - INFO - Epoch 12/50, Train Loss: 36.1041, Val Loss: 37.5635
2025-04-15 20:05:38,784 - INFO - Epoch 13/50, Train Loss: 35.6680, Val Loss: 33.8341
2025-04-15 20:05:39,319 - INFO - Epoch 14/50, Train Loss: 35.3882, Val Loss: 36.6771
2025-04-15 20:05:39,840 - INFO - Epoch 15/50, Train Loss: 33.5485, Val Loss: 32.3234
2025-04-15 20:05:40,365 - INFO - Epoch 16/50, Train Loss: 33.7050, Val Loss: 33.7613
2025-04-15 20:05:40,890 - INFO - Epoch 17/50, Train Loss: 32.7975, Val Loss: 31.1627
2025-04-15 20:05:41,419 - INFO - Epoch 18/50, Train Loss: 32.3385, Val Loss: 32.1430
2025-04-15 20:05:41,959 - INFO - Epoch 19/50, Train Loss: 30.9605, Val Loss: 29.1072
2025-04-15 20:05:42,498 - INFO - Epoch 20/50, Train Loss: 31.2871, Val Loss: 30.4869
2025-04-15 20:05:43,043 - INFO - Epoch 21/50, Train Loss: 29.7805, Val Loss: 28.1385
2025-04-15 20:05:43,577 - INFO - Epoch 22/50, Train Loss: 30.4924, Val Loss: 27.1243
2025-04-15 20:05:44,094 - INFO - Epoch 23/50, Train Loss: 29.9089, Val Loss: 27.7769
2025-04-15 20:05:44,623 - INFO - Epoch 24/50, Train Loss: 29.3002, Val Loss: 28.7805
2025-04-15 20:05:45,153 - INFO - Epoch 25/50, Train Loss: 26.9940, Val Loss: 30.8690
2025-04-15 20:05:45,675 - INFO - Epoch 26/50, Train Loss: 27.6709, Val Loss: 29.2476
2025-04-15 20:05:46,203 - INFO - Epoch 27/50, Train Loss: 27.4201, Val Loss: 29.8128
2025-04-15 20:05:46,738 - INFO - Epoch 28/50, Train Loss: 27.3458, Val Loss: 27.7302
2025-04-15 20:05:47,280 - INFO - Epoch 29/50, Train Loss: 28.1795, Val Loss: 26.9979
2025-04-15 20:05:47,811 - INFO - Epoch 30/50, Train Loss: 26.3258, Val Loss: 27.7517
2025-04-15 20:05:48,352 - INFO - Epoch 31/50, Train Loss: 25.0878, Val Loss: 27.7216
2025-04-15 20:05:48,874 - INFO - Epoch 32/50, Train Loss: 26.1014, Val Loss: 27.5055
2025-04-15 20:05:49,409 - INFO - Epoch 33/50, Train Loss: 25.9651, Val Loss: 27.6185
2025-04-15 20:05:49,946 - INFO - Epoch 34/50, Train Loss: 25.0507, Val Loss: 27.1969
2025-04-15 20:05:50,480 - INFO - Epoch 35/50, Train Loss: 25.8197, Val Loss: 29.1344
2025-04-15 20:05:50,998 - INFO - Epoch 36/50, Train Loss: 24.8669, Val Loss: 28.9202
2025-04-15 20:05:51,530 - INFO - Epoch 37/50, Train Loss: 24.3309, Val Loss: 27.6383
2025-04-15 20:05:52,038 - INFO - Epoch 38/50, Train Loss: 25.6571, Val Loss: 27.6235
2025-04-15 20:05:52,557 - INFO - Epoch 39/50, Train Loss: 25.6260, Val Loss: 26.9395
2025-04-15 20:05:53,100 - INFO - Epoch 40/50, Train Loss: 25.2055, Val Loss: 27.4908
2025-04-15 20:05:53,622 - INFO - Epoch 41/50, Train Loss: 25.1333, Val Loss: 26.9733
2025-04-15 20:05:54,143 - INFO - Epoch 42/50, Train Loss: 24.0542, Val Loss: 26.4623
2025-04-15 20:05:54,664 - INFO - Epoch 43/50, Train Loss: 24.6686, Val Loss: 27.1306
2025-04-15 20:05:55,191 - INFO - Epoch 44/50, Train Loss: 24.1525, Val Loss: 27.2268
2025-04-15 20:05:55,721 - INFO - Epoch 45/50, Train Loss: 24.0918, Val Loss: 26.5107
2025-04-15 20:05:56,238 - INFO - Epoch 46/50, Train Loss: 25.0065, Val Loss: 26.8156
2025-04-15 20:05:56,771 - INFO - Epoch 47/50, Train Loss: 24.8150, Val Loss: 26.9185
2025-04-15 20:05:57,300 - INFO - Epoch 48/50, Train Loss: 24.7308, Val Loss: 27.3630
2025-04-15 20:05:57,817 - INFO - Epoch 49/50, Train Loss: 24.2705, Val Loss: 27.1589
2025-04-15 20:05:58,336 - INFO - Epoch 50/50, Train Loss: 25.0556, Val Loss: 27.1001
2025-04-15 20:05:58,887 - INFO - Validation metrics - Horizontal: 22.55km, Depth: 9.77km, 3D: 26.46km
[I 2025-04-15 20:05:58,917] Trial 13 finished with value: 22.55231475830078 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 4, 'learning_rate': 0.0004653009585528704, 'batch_size': 8, 'weight_decay': 8.438089685544488e-06}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:05:59,074 - INFO - 
Trial 14:
2025-04-15 20:05:59,074 - INFO - Graph params: time_window=120, spatial_threshold=200, min_connections=1
2025-04-15 20:05:59,074 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=3
2025-04-15 20:05:59,074 - INFO - Training params: lr=0.0019998098480942827, batch_size=32, weight_decay=0.0001662754846042837
2025-04-15 20:05:59,119 - INFO - Creating graphs with time_window=120h, spatial_threshold=200km, min_connections=1...
Created 388 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 271, Val: 58, Test: 59 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 200km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 133.73it/s]  7%|▋         | 28/411 [00:00<00:02, 134.92it/s] 10%|█         | 42/411 [00:00<00:02, 134.91it/s] 14%|█▎        | 56/411 [00:00<00:02, 134.93it/s] 17%|█▋        | 70/411 [00:00<00:02, 136.19it/s] 20%|██        | 84/411 [00:00<00:02, 133.75it/s] 24%|██▍       | 98/411 [00:00<00:02, 133.82it/s] 27%|██▋       | 112/411 [00:00<00:02, 131.70it/s] 31%|███       | 126/411 [00:00<00:02, 129.33it/s] 34%|███▍      | 139/411 [00:01<00:02, 127.37it/s] 37%|███▋      | 152/411 [00:01<00:02, 127.35it/s] 40%|████      | 165/411 [00:01<00:01, 125.42it/s] 43%|████▎     | 178/411 [00:01<00:01, 124.79it/s] 47%|████▋     | 192/411 [00:01<00:01, 127.35it/s] 50%|████▉     | 205/411 [00:01<00:01, 128.02it/s] 53%|█████▎    | 218/411 [00:01<00:01, 128.56it/s] 56%|█████▌    | 231/411 [00:01<00:01, 125.18it/s] 60%|█████▉    | 245/411 [00:01<00:01, 128.07it/s] 63%|██████▎   | 259/411 [00:01<00:01, 128.59it/s] 67%|██████▋   | 274/411 [00:02<00:01, 132.69it/s] 70%|███████   | 288/411 [00:02<00:00, 132.85it/s] 73%|███████▎  | 302/411 [00:02<00:00, 125.93it/s] 77%|███████▋  | 315/411 [00:02<00:00, 126.78it/s] 80%|███████▉  | 328/411 [00:02<00:00, 127.24it/s] 83%|████████▎ | 341/411 [00:02<00:00, 124.16it/s] 86%|████████▌ | 354/411 [00:02<00:00, 121.91it/s] 90%|████████▉ | 369/411 [00:02<00:00, 127.85it/s] 93%|█████████▎| 382/411 [00:02<00:00, 125.17it/s] 96%|█████████▌| 395/411 [00:03<00:00, 125.92it/s]100%|█████████▉| 409/411 [00:03<00:00, 128.19it/s]100%|██████████| 411/411 [00:03<00:00, 128.48it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 12%|█▏        | 50/409 [00:00<00:00, 491.90it/s] 24%|██▍       | 100/409 [00:00<00:00, 403.20it/s] 35%|███▍      | 143/409 [00:00<00:00, 412.60it/s] 45%|████▌     | 185/409 [00:00<00:00, 296.57it/s] 54%|█████▎    | 219/409 [00:00<00:00, 296.88it/s] 62%|██████▏   | 252/409 [00:00<00:00, 269.87it/s] 69%|██████▊   | 281/409 [00:00<00:00, 232.58it/s] 75%|███████▍  | 306/409 [00:01<00:00, 201.09it/s] 80%|████████  | 328/409 [00:01<00:00, 176.62it/s] 85%|████████▍ | 347/409 [00:01<00:00, 163.37it/s] 89%|████████▉ | 364/409 [00:01<00:00, 160.70it/s] 93%|█████████▎| 381/409 [00:01<00:00, 162.83it/s] 98%|█████████▊| 402/409 [00:01<00:00, 173.33it/s]100%|██████████| 409/409 [00:01<00:00, 223.34it/s]
2025-04-15 20:06:04,171 - INFO - Created 409 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:06:04,260 - INFO - Training GAT model...
2025-04-15 20:06:04,260 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:06:04,728 - INFO - Epoch 1/50, Train Loss: 67.8055, Val Loss: 79.8748
2025-04-15 20:06:05,209 - INFO - Epoch 2/50, Train Loss: 66.6721, Val Loss: 79.4006
2025-04-15 20:06:05,683 - INFO - Epoch 3/50, Train Loss: 65.1157, Val Loss: 79.4103
2025-04-15 20:06:06,182 - INFO - Epoch 4/50, Train Loss: 64.1104, Val Loss: 79.0835
2025-04-15 20:06:06,652 - INFO - Epoch 5/50, Train Loss: 62.4287, Val Loss: 77.5464
2025-04-15 20:06:07,109 - INFO - Epoch 6/50, Train Loss: 62.9107, Val Loss: 80.0555
2025-04-15 20:06:07,594 - INFO - Epoch 7/50, Train Loss: 61.8489, Val Loss: 76.9082
2025-04-15 20:06:08,060 - INFO - Epoch 8/50, Train Loss: 61.3210, Val Loss: 74.6021
2025-04-15 20:06:08,535 - INFO - Epoch 9/50, Train Loss: 60.6776, Val Loss: 74.0667
2025-04-15 20:06:09,012 - INFO - Epoch 10/50, Train Loss: 59.8095, Val Loss: 70.6480
2025-04-15 20:06:09,484 - INFO - Epoch 11/50, Train Loss: 58.9012, Val Loss: 74.1276
2025-04-15 20:06:09,944 - INFO - Epoch 12/50, Train Loss: 59.8663, Val Loss: 77.1586
2025-04-15 20:06:10,419 - INFO - Epoch 13/50, Train Loss: 60.5763, Val Loss: 73.2430
2025-04-15 20:06:10,909 - INFO - Epoch 14/50, Train Loss: 58.9800, Val Loss: 80.3864
2025-04-15 20:06:11,371 - INFO - Epoch 15/50, Train Loss: 57.7679, Val Loss: 72.8484
2025-04-15 20:06:11,844 - INFO - Epoch 16/50, Train Loss: 57.4322, Val Loss: 89.2749
2025-04-15 20:06:12,312 - INFO - Epoch 17/50, Train Loss: 56.9620, Val Loss: 75.7865
2025-04-15 20:06:12,789 - INFO - Epoch 18/50, Train Loss: 57.4718, Val Loss: 73.1742
2025-04-15 20:06:13,264 - INFO - Epoch 19/50, Train Loss: 57.2653, Val Loss: 77.0811
2025-04-15 20:06:13,740 - INFO - Epoch 20/50, Train Loss: 56.5629, Val Loss: 77.6523
2025-04-15 20:06:13,740 - INFO - Early stopping at epoch 20. Best epoch: 10
2025-04-15 20:06:14,322 - INFO - Validation metrics - Horizontal: 68.07km, Depth: 14.02km, 3D: 70.65km
[I 2025-04-15 20:06:14,354] Trial 14 finished with value: 68.07498931884766 and parameters: {'time_window': 120, 'spatial_threshold': 200, 'min_connections': 1, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 3, 'learning_rate': 0.0019998098480942827, 'batch_size': 32, 'weight_decay': 0.0001662754846042837}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:06:14,511 - INFO - 
Trial 15:
2025-04-15 20:06:14,511 - INFO - Graph params: time_window=240, spatial_threshold=75, min_connections=3
2025-04-15 20:06:14,511 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=2
2025-04-15 20:06:14,511 - INFO - Training params: lr=0.0005593445498218645, batch_size=16, weight_decay=1.861085595160958e-05
2025-04-15 20:06:14,556 - INFO - Creating graphs with time_window=240h, spatial_threshold=75km, min_connections=3...
Created 409 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 286, Val: 61, Test: 62 graphs
Creating causal relative spatiotemporal graphs (time window: 240h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 128.52it/s]  7%|▋         | 28/411 [00:00<00:02, 134.97it/s] 10%|█         | 42/411 [00:00<00:02, 132.07it/s] 14%|█▎        | 56/411 [00:00<00:02, 131.48it/s] 17%|█▋        | 70/411 [00:00<00:02, 131.73it/s] 20%|██        | 84/411 [00:00<00:02, 129.28it/s] 24%|██▍       | 98/411 [00:00<00:02, 130.01it/s] 27%|██▋       | 112/411 [00:00<00:02, 127.47it/s] 30%|███       | 125/411 [00:00<00:02, 125.62it/s] 34%|███▎      | 138/411 [00:01<00:02, 124.63it/s] 37%|███▋      | 151/411 [00:01<00:02, 124.87it/s] 40%|███▉      | 164/411 [00:01<00:02, 122.39it/s] 43%|████▎     | 177/411 [00:01<00:01, 121.42it/s] 46%|████▌     | 190/411 [00:01<00:01, 122.25it/s] 49%|████▉     | 203/411 [00:01<00:01, 123.38it/s] 53%|█████▎    | 216/411 [00:01<00:01, 122.99it/s] 56%|█████▌    | 229/411 [00:01<00:01, 122.97it/s] 59%|█████▉    | 243/411 [00:01<00:01, 127.08it/s] 62%|██████▏   | 256/411 [00:02<00:01, 124.97it/s] 66%|██████▌   | 270/411 [00:02<00:01, 128.00it/s] 69%|██████▉   | 283/411 [00:02<00:01, 126.84it/s] 72%|███████▏  | 296/411 [00:02<00:00, 126.53it/s] 75%|███████▌  | 309/411 [00:02<00:00, 123.22it/s] 78%|███████▊  | 322/411 [00:02<00:00, 121.40it/s] 82%|████████▏ | 335/411 [00:02<00:00, 120.55it/s] 85%|████████▍ | 348/411 [00:02<00:00, 118.44it/s] 88%|████████▊ | 361/411 [00:02<00:00, 121.03it/s] 91%|█████████ | 374/411 [00:02<00:00, 122.40it/s] 94%|█████████▍| 387/411 [00:03<00:00, 122.42it/s] 97%|█████████▋| 400/411 [00:03<00:00, 123.95it/s]100%|██████████| 411/411 [00:03<00:00, 124.71it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 12%|█▏        | 49/409 [00:00<00:00, 480.16it/s] 24%|██▍       | 98/409 [00:00<00:00, 325.92it/s] 33%|███▎      | 135/409 [00:00<00:00, 339.83it/s] 42%|████▏     | 171/409 [00:00<00:00, 299.50it/s] 50%|████▉     | 203/409 [00:00<00:00, 247.97it/s] 56%|█████▌    | 230/409 [00:00<00:00, 230.56it/s] 62%|██████▏   | 255/409 [00:00<00:00, 225.90it/s] 68%|██████▊   | 279/409 [00:01<00:00, 205.74it/s] 74%|███████▎  | 301/409 [00:01<00:00, 182.98it/s] 78%|███████▊  | 320/409 [00:01<00:00, 164.67it/s] 82%|████████▏ | 337/409 [00:01<00:00, 151.32it/s] 86%|████████▋ | 353/409 [00:01<00:00, 141.52it/s] 90%|████████▉ | 368/409 [00:01<00:00, 134.04it/s] 93%|█████████▎| 382/409 [00:01<00:00, 130.66it/s] 97%|█████████▋| 397/409 [00:02<00:00, 134.18it/s]100%|██████████| 409/409 [00:02<00:00, 191.58it/s]
2025-04-15 20:06:20,011 - INFO - Created 395 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:06:20,095 - INFO - Training GAT model...
2025-04-15 20:06:20,095 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:06:20,379 - INFO - Epoch 1/50, Train Loss: 64.4098, Val Loss: 76.4282
2025-04-15 20:06:20,661 - INFO - Epoch 2/50, Train Loss: 62.3086, Val Loss: 73.0207
2025-04-15 20:06:20,936 - INFO - Epoch 3/50, Train Loss: 59.5244, Val Loss: 69.0809
2025-04-15 20:06:21,220 - INFO - Epoch 4/50, Train Loss: 56.0455, Val Loss: 64.5031
2025-04-15 20:06:21,497 - INFO - Epoch 5/50, Train Loss: 51.9207, Val Loss: 59.4093
2025-04-15 20:06:21,770 - INFO - Epoch 6/50, Train Loss: 48.0327, Val Loss: 54.4835
2025-04-15 20:06:22,048 - INFO - Epoch 7/50, Train Loss: 44.5744, Val Loss: 50.7592
2025-04-15 20:06:22,330 - INFO - Epoch 8/50, Train Loss: 42.8470, Val Loss: 49.4319
2025-04-15 20:06:22,604 - INFO - Epoch 9/50, Train Loss: 43.0049, Val Loss: 43.8439
2025-04-15 20:06:22,895 - INFO - Epoch 10/50, Train Loss: 38.6985, Val Loss: 40.8671
2025-04-15 20:06:23,182 - INFO - Epoch 11/50, Train Loss: 37.1478, Val Loss: 38.1963
2025-04-15 20:06:23,460 - INFO - Epoch 12/50, Train Loss: 34.4046, Val Loss: 36.9263
2025-04-15 20:06:23,726 - INFO - Epoch 13/50, Train Loss: 32.9191, Val Loss: 35.8701
2025-04-15 20:06:23,999 - INFO - Epoch 14/50, Train Loss: 32.2645, Val Loss: 34.5686
2025-04-15 20:06:24,279 - INFO - Epoch 15/50, Train Loss: 31.4574, Val Loss: 33.5228
2025-04-15 20:06:24,557 - INFO - Epoch 16/50, Train Loss: 30.3211, Val Loss: 32.7928
2025-04-15 20:06:24,830 - INFO - Epoch 17/50, Train Loss: 28.9699, Val Loss: 34.0604
2025-04-15 20:06:25,113 - INFO - Epoch 18/50, Train Loss: 29.0779, Val Loss: 31.9552
2025-04-15 20:06:25,407 - INFO - Epoch 19/50, Train Loss: 30.6484, Val Loss: 33.4465
2025-04-15 20:06:25,686 - INFO - Epoch 20/50, Train Loss: 33.4396, Val Loss: 32.0038
2025-04-15 20:06:25,962 - INFO - Epoch 21/50, Train Loss: 28.0560, Val Loss: 30.4737
2025-04-15 20:06:26,248 - INFO - Epoch 22/50, Train Loss: 27.3076, Val Loss: 31.3681
2025-04-15 20:06:26,531 - INFO - Epoch 23/50, Train Loss: 26.2696, Val Loss: 28.7933
2025-04-15 20:06:26,811 - INFO - Epoch 24/50, Train Loss: 26.5795, Val Loss: 29.3520
2025-04-15 20:06:27,097 - INFO - Epoch 25/50, Train Loss: 26.7645, Val Loss: 28.3801
2025-04-15 20:06:27,369 - INFO - Epoch 26/50, Train Loss: 26.9344, Val Loss: 29.4563
2025-04-15 20:06:27,647 - INFO - Epoch 27/50, Train Loss: 27.0685, Val Loss: 29.1503
2025-04-15 20:06:27,924 - INFO - Epoch 28/50, Train Loss: 26.0813, Val Loss: 29.7431
2025-04-15 20:06:28,212 - INFO - Epoch 29/50, Train Loss: 24.8526, Val Loss: 27.6656
2025-04-15 20:06:28,490 - INFO - Epoch 30/50, Train Loss: 23.2865, Val Loss: 29.9989
2025-04-15 20:06:28,764 - INFO - Epoch 31/50, Train Loss: 23.6256, Val Loss: 27.4931
2025-04-15 20:06:29,045 - INFO - Epoch 32/50, Train Loss: 23.5067, Val Loss: 28.9066
2025-04-15 20:06:29,328 - INFO - Epoch 33/50, Train Loss: 22.9881, Val Loss: 28.1147
2025-04-15 20:06:29,605 - INFO - Epoch 34/50, Train Loss: 22.6928, Val Loss: 27.5191
2025-04-15 20:06:29,884 - INFO - Epoch 35/50, Train Loss: 24.5802, Val Loss: 27.8191
2025-04-15 20:06:30,173 - INFO - Epoch 36/50, Train Loss: 22.9454, Val Loss: 27.3787
2025-04-15 20:06:30,450 - INFO - Epoch 37/50, Train Loss: 23.1973, Val Loss: 29.6550
2025-04-15 20:06:30,723 - INFO - Epoch 38/50, Train Loss: 23.0987, Val Loss: 28.1171
2025-04-15 20:06:30,999 - INFO - Epoch 39/50, Train Loss: 21.9868, Val Loss: 28.9105
2025-04-15 20:06:31,278 - INFO - Epoch 40/50, Train Loss: 21.5277, Val Loss: 27.9653
2025-04-15 20:06:31,550 - INFO - Epoch 41/50, Train Loss: 22.6393, Val Loss: 28.4028
2025-04-15 20:06:31,836 - INFO - Epoch 42/50, Train Loss: 22.9891, Val Loss: 27.3337
2025-04-15 20:06:32,117 - INFO - Epoch 43/50, Train Loss: 22.6362, Val Loss: 29.6534
2025-04-15 20:06:32,397 - INFO - Epoch 44/50, Train Loss: 22.1388, Val Loss: 29.8888
2025-04-15 20:06:32,675 - INFO - Epoch 45/50, Train Loss: 22.5003, Val Loss: 30.0466
2025-04-15 20:06:32,958 - INFO - Epoch 46/50, Train Loss: 21.6293, Val Loss: 30.1196
2025-04-15 20:06:33,245 - INFO - Epoch 47/50, Train Loss: 21.5588, Val Loss: 27.7142
2025-04-15 20:06:33,520 - INFO - Epoch 48/50, Train Loss: 20.6846, Val Loss: 29.1407
2025-04-15 20:06:33,789 - INFO - Epoch 49/50, Train Loss: 20.5816, Val Loss: 27.9540
2025-04-15 20:06:34,055 - INFO - Epoch 50/50, Train Loss: 20.4196, Val Loss: 28.5139
2025-04-15 20:06:34,590 - INFO - Validation metrics - Horizontal: 23.32km, Depth: 10.41km, 3D: 27.33km
[I 2025-04-15 20:06:34,624] Trial 15 finished with value: 23.324861526489258 and parameters: {'time_window': 240, 'spatial_threshold': 75, 'min_connections': 3, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 2, 'learning_rate': 0.0005593445498218645, 'batch_size': 16, 'weight_decay': 1.861085595160958e-05}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:06:34,790 - INFO - 
Trial 16:
2025-04-15 20:06:34,791 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:06:34,791 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=5
2025-04-15 20:06:34,791 - INFO - Training params: lr=0.009605459691204972, batch_size=8, weight_decay=0.00010923129432184187
2025-04-15 20:06:34,837 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 395 causal graphs
First graph has 4 nodes and 3 edges
Chronological split - Train: 276, Val: 59, Test: 60 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 125.07it/s]  7%|▋         | 27/411 [00:00<00:02, 133.44it/s] 10%|▉         | 41/411 [00:00<00:02, 130.28it/s] 13%|█▎        | 55/411 [00:00<00:02, 128.96it/s] 17%|█▋        | 69/411 [00:00<00:02, 130.60it/s] 20%|██        | 83/411 [00:00<00:02, 126.35it/s] 24%|██▎       | 97/411 [00:00<00:02, 130.32it/s] 27%|██▋       | 111/411 [00:00<00:02, 127.44it/s] 30%|███       | 124/411 [00:00<00:02, 123.25it/s] 33%|███▎      | 137/411 [00:01<00:02, 123.78it/s] 36%|███▋      | 150/411 [00:01<00:02, 123.44it/s] 40%|███▉      | 163/411 [00:01<00:02, 121.05it/s] 43%|████▎     | 176/411 [00:01<00:01, 120.21it/s] 46%|████▌     | 189/411 [00:01<00:01, 121.09it/s] 49%|████▉     | 202/411 [00:01<00:01, 123.51it/s] 52%|█████▏    | 215/411 [00:01<00:01, 122.38it/s] 55%|█████▌    | 228/411 [00:01<00:01, 121.77it/s] 59%|█████▉    | 242/411 [00:01<00:01, 125.62it/s] 62%|██████▏   | 255/411 [00:02<00:01, 122.85it/s] 65%|██████▌   | 269/411 [00:02<00:01, 126.19it/s] 69%|██████▊   | 282/411 [00:02<00:01, 124.91it/s] 72%|███████▏  | 295/411 [00:02<00:00, 124.06it/s] 75%|███████▍  | 308/411 [00:02<00:00, 120.84it/s] 78%|███████▊  | 321/411 [00:02<00:00, 119.78it/s] 81%|████████▏ | 334/411 [00:02<00:00, 120.04it/s] 84%|████████▍ | 347/411 [00:02<00:00, 118.56it/s] 87%|████████▋ | 359/411 [00:02<00:00, 118.32it/s] 91%|█████████ | 372/411 [00:03<00:00, 121.22it/s] 94%|█████████▎| 385/411 [00:03<00:00, 120.71it/s] 97%|█████████▋| 398/411 [00:03<00:00, 121.87it/s]100%|██████████| 411/411 [00:03<00:00, 122.41it/s]100%|██████████| 411/411 [00:03<00:00, 123.39it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 558.54it/s] 27%|██▋       | 112/409 [00:00<00:00, 543.47it/s] 41%|████      | 167/409 [00:00<00:00, 463.99it/s] 53%|█████▎    | 215/409 [00:00<00:00, 383.51it/s] 63%|██████▎   | 256/409 [00:00<00:00, 345.51it/s] 71%|███████▏  | 292/409 [00:00<00:00, 290.61it/s] 79%|███████▉  | 323/409 [00:01<00:00, 247.95it/s] 86%|████████▌ | 350/409 [00:01<00:00, 228.27it/s] 91%|█████████▏| 374/409 [00:01<00:00, 223.02it/s] 97%|█████████▋| 398/409 [00:01<00:00, 225.78it/s]100%|██████████| 409/409 [00:01<00:00, 287.82it/s]
2025-04-15 20:06:39,610 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:06:39,686 - INFO - Training GAT model...
2025-04-15 20:06:39,686 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:06:40,504 - INFO - Epoch 1/50, Train Loss: 54.3867, Val Loss: 65.5757
2025-04-15 20:06:41,391 - INFO - Epoch 2/50, Train Loss: 50.6338, Val Loss: 56.6429
2025-04-15 20:06:42,250 - INFO - Epoch 3/50, Train Loss: 49.3042, Val Loss: 60.5258
2025-04-15 20:06:43,083 - INFO - Epoch 4/50, Train Loss: 49.3132, Val Loss: 65.4966
2025-04-15 20:06:43,887 - INFO - Epoch 5/50, Train Loss: 49.9832, Val Loss: 66.1947
2025-04-15 20:06:44,713 - INFO - Epoch 6/50, Train Loss: 46.5045, Val Loss: 61.7664
2025-04-15 20:06:45,521 - INFO - Epoch 7/50, Train Loss: 47.6780, Val Loss: 66.3406
2025-04-15 20:06:46,337 - INFO - Epoch 8/50, Train Loss: 51.5419, Val Loss: 57.6352
2025-04-15 20:06:47,144 - INFO - Epoch 9/50, Train Loss: 45.1011, Val Loss: 53.6136
2025-04-15 20:06:47,976 - INFO - Epoch 10/50, Train Loss: 43.3185, Val Loss: 45.5420
2025-04-15 20:06:48,752 - INFO - Epoch 11/50, Train Loss: 41.8168, Val Loss: 52.6868
2025-04-15 20:06:49,587 - INFO - Epoch 12/50, Train Loss: 42.0063, Val Loss: 45.3570
2025-04-15 20:06:50,396 - INFO - Epoch 13/50, Train Loss: 40.8886, Val Loss: 44.8737
2025-04-15 20:06:51,200 - INFO - Epoch 14/50, Train Loss: 39.4223, Val Loss: 40.8412
2025-04-15 20:06:51,977 - INFO - Epoch 15/50, Train Loss: 39.1166, Val Loss: 42.2265
2025-04-15 20:06:52,725 - INFO - Epoch 16/50, Train Loss: 42.5258, Val Loss: 49.3491
2025-04-15 20:06:53,523 - INFO - Epoch 17/50, Train Loss: 42.1666, Val Loss: 46.7792
2025-04-15 20:06:54,316 - INFO - Epoch 18/50, Train Loss: 39.6061, Val Loss: 39.9680
2025-04-15 20:06:55,107 - INFO - Epoch 19/50, Train Loss: 39.2412, Val Loss: 37.8409
2025-04-15 20:06:55,910 - INFO - Epoch 20/50, Train Loss: 41.4693, Val Loss: 49.7782
2025-04-15 20:06:56,693 - INFO - Epoch 21/50, Train Loss: 42.9115, Val Loss: 44.2609
2025-04-15 20:06:57,503 - INFO - Epoch 22/50, Train Loss: 42.0309, Val Loss: 42.6708
2025-04-15 20:06:58,356 - INFO - Epoch 23/50, Train Loss: 41.0558, Val Loss: 42.1187
2025-04-15 20:06:59,176 - INFO - Epoch 24/50, Train Loss: 40.3343, Val Loss: 42.9878
2025-04-15 20:06:59,987 - INFO - Epoch 25/50, Train Loss: 38.5412, Val Loss: 46.4816
2025-04-15 20:07:00,829 - INFO - Epoch 26/50, Train Loss: 39.2408, Val Loss: 44.5140
2025-04-15 20:07:01,689 - INFO - Epoch 27/50, Train Loss: 37.0272, Val Loss: 43.9818
2025-04-15 20:07:02,534 - INFO - Epoch 28/50, Train Loss: 37.2479, Val Loss: 43.9960
2025-04-15 20:07:03,349 - INFO - Epoch 29/50, Train Loss: 37.7063, Val Loss: 42.6806
2025-04-15 20:07:03,349 - INFO - Early stopping at epoch 29. Best epoch: 19
2025-04-15 20:07:03,927 - INFO - Validation metrics - Horizontal: 36.12km, Depth: 9.29km, 3D: 37.84km
[I 2025-04-15 20:07:03,958] Trial 16 finished with value: 36.123207092285156 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 5, 'learning_rate': 0.009605459691204972, 'batch_size': 8, 'weight_decay': 0.00010923129432184187}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:07:04,118 - INFO - 
Trial 17:
2025-04-15 20:07:04,118 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=2
2025-04-15 20:07:04,118 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=4
2025-04-15 20:07:04,118 - INFO - Training params: lr=0.0020626042625955378, batch_size=16, weight_decay=1.0325747455094935e-06
2025-04-15 20:07:04,171 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=2...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 12/411 [00:00<00:03, 111.90it/s]  6%|▌         | 25/411 [00:00<00:03, 121.68it/s]  9%|▉         | 38/411 [00:00<00:02, 125.20it/s] 13%|█▎        | 52/411 [00:00<00:02, 128.04it/s] 16%|█▌        | 66/411 [00:00<00:02, 128.96it/s] 19%|█▉        | 79/411 [00:00<00:02, 126.56it/s] 22%|██▏       | 92/411 [00:00<00:02, 126.49it/s] 26%|██▌       | 105/411 [00:00<00:02, 127.10it/s] 29%|██▊       | 118/411 [00:00<00:02, 122.69it/s] 32%|███▏      | 131/411 [00:01<00:02, 121.19it/s] 35%|███▌      | 144/411 [00:01<00:02, 121.77it/s] 38%|███▊      | 157/411 [00:01<00:02, 120.57it/s] 41%|████▏     | 170/411 [00:01<00:02, 119.00it/s] 45%|████▍     | 183/411 [00:01<00:01, 120.77it/s] 48%|████▊     | 196/411 [00:01<00:01, 122.75it/s] 51%|█████     | 209/411 [00:01<00:01, 124.39it/s] 54%|█████▍    | 222/411 [00:01<00:01, 121.07it/s] 57%|█████▋    | 235/411 [00:01<00:01, 120.91it/s] 60%|██████    | 248/411 [00:02<00:01, 122.72it/s] 64%|██████▎   | 262/411 [00:02<00:01, 126.84it/s] 67%|██████▋   | 275/411 [00:02<00:01, 125.90it/s] 70%|███████   | 289/411 [00:02<00:00, 127.83it/s] 73%|███████▎  | 302/411 [00:02<00:00, 120.10it/s] 77%|███████▋  | 315/411 [00:02<00:00, 120.73it/s] 80%|███████▉  | 328/411 [00:02<00:00, 121.32it/s] 83%|████████▎ | 341/411 [00:02<00:00, 118.00it/s] 86%|████████▌ | 353/411 [00:02<00:00, 114.34it/s] 90%|████████▉ | 368/411 [00:03<00:00, 122.10it/s] 93%|█████████▎| 381/411 [00:03<00:00, 119.86it/s] 96%|█████████▌| 394/411 [00:03<00:00, 120.97it/s] 99%|█████████▉| 407/411 [00:03<00:00, 123.20it/s]100%|██████████| 411/411 [00:03<00:00, 122.37it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 550.48it/s] 27%|██▋       | 112/409 [00:00<00:00, 534.10it/s] 41%|████      | 166/409 [00:00<00:00, 457.46it/s] 52%|█████▏    | 213/409 [00:00<00:00, 380.44it/s] 62%|██████▏   | 253/409 [00:00<00:00, 346.40it/s] 71%|███████   | 289/409 [00:00<00:00, 292.16it/s] 78%|███████▊  | 320/409 [00:00<00:00, 250.19it/s] 85%|████████▍ | 347/409 [00:01<00:00, 227.02it/s] 91%|█████████ | 371/409 [00:01<00:00, 220.08it/s] 96%|█████████▋| 394/409 [00:01<00:00, 219.39it/s]100%|██████████| 409/409 [00:01<00:00, 284.37it/s]
2025-04-15 20:07:08,990 - INFO - Created 388 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:07:09,074 - INFO - Training GAT model...
2025-04-15 20:07:09,074 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:07:09,476 - INFO - Epoch 1/50, Train Loss: 61.2110, Val Loss: 68.9793
2025-04-15 20:07:09,873 - INFO - Epoch 2/50, Train Loss: 53.7571, Val Loss: 61.3420
2025-04-15 20:07:10,266 - INFO - Epoch 3/50, Train Loss: 51.1921, Val Loss: 56.8546
2025-04-15 20:07:10,653 - INFO - Epoch 4/50, Train Loss: 46.8102, Val Loss: 49.1758
2025-04-15 20:07:11,027 - INFO - Epoch 5/50, Train Loss: 43.7852, Val Loss: 40.7008
2025-04-15 20:07:11,425 - INFO - Epoch 6/50, Train Loss: 38.7941, Val Loss: 37.3156
2025-04-15 20:07:11,815 - INFO - Epoch 7/50, Train Loss: 38.5223, Val Loss: 37.9773
2025-04-15 20:07:12,211 - INFO - Epoch 8/50, Train Loss: 40.3698, Val Loss: 45.8447
2025-04-15 20:07:12,597 - INFO - Epoch 9/50, Train Loss: 42.9821, Val Loss: 40.9712
2025-04-15 20:07:12,993 - INFO - Epoch 10/50, Train Loss: 39.2710, Val Loss: 30.4443
2025-04-15 20:07:13,392 - INFO - Epoch 11/50, Train Loss: 33.9637, Val Loss: 28.6204
2025-04-15 20:07:13,774 - INFO - Epoch 12/50, Train Loss: 35.1050, Val Loss: 26.6720
2025-04-15 20:07:14,150 - INFO - Epoch 13/50, Train Loss: 32.1703, Val Loss: 27.2028
2025-04-15 20:07:14,531 - INFO - Epoch 14/50, Train Loss: 31.9556, Val Loss: 29.1144
2025-04-15 20:07:14,912 - INFO - Epoch 15/50, Train Loss: 31.5701, Val Loss: 28.5786
2025-04-15 20:07:15,302 - INFO - Epoch 16/50, Train Loss: 33.8218, Val Loss: 25.7133
2025-04-15 20:07:15,691 - INFO - Epoch 17/50, Train Loss: 31.6191, Val Loss: 28.1730
2025-04-15 20:07:16,066 - INFO - Epoch 18/50, Train Loss: 31.9372, Val Loss: 29.3033
2025-04-15 20:07:16,454 - INFO - Epoch 19/50, Train Loss: 29.5236, Val Loss: 29.0787
2025-04-15 20:07:16,831 - INFO - Epoch 20/50, Train Loss: 29.2679, Val Loss: 29.7489
2025-04-15 20:07:17,217 - INFO - Epoch 21/50, Train Loss: 28.9122, Val Loss: 26.6046
2025-04-15 20:07:17,596 - INFO - Epoch 22/50, Train Loss: 28.3221, Val Loss: 27.9303
2025-04-15 20:07:17,973 - INFO - Epoch 23/50, Train Loss: 28.4167, Val Loss: 30.4218
2025-04-15 20:07:18,362 - INFO - Epoch 24/50, Train Loss: 27.2079, Val Loss: 29.4886
2025-04-15 20:07:18,747 - INFO - Epoch 25/50, Train Loss: 26.8393, Val Loss: 27.1909
2025-04-15 20:07:19,132 - INFO - Epoch 26/50, Train Loss: 26.8633, Val Loss: 28.4494
2025-04-15 20:07:19,133 - INFO - Early stopping at epoch 26. Best epoch: 16
2025-04-15 20:07:19,673 - INFO - Validation metrics - Horizontal: 22.02km, Depth: 9.39km, 3D: 25.71km
[I 2025-04-15 20:07:19,709] Trial 17 finished with value: 22.0203857421875 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 4, 'learning_rate': 0.0020626042625955378, 'batch_size': 16, 'weight_decay': 1.0325747455094935e-06}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:07:19,865 - INFO - 
Trial 18:
2025-04-15 20:07:19,865 - INFO - Graph params: time_window=120, spatial_threshold=100, min_connections=2
2025-04-15 20:07:19,865 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=3
2025-04-15 20:07:19,865 - INFO - Training params: lr=0.0006966436017846456, batch_size=8, weight_decay=5.003984135786765e-06
2025-04-15 20:07:19,910 - INFO - Creating graphs with time_window=120h, spatial_threshold=100km, min_connections=2...
Created 388 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 271, Val: 58, Test: 59 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 100km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 129.41it/s]  7%|▋         | 27/411 [00:00<00:02, 135.22it/s] 10%|▉         | 41/411 [00:00<00:02, 131.85it/s] 13%|█▎        | 55/411 [00:00<00:02, 130.14it/s] 17%|█▋        | 69/411 [00:00<00:02, 130.93it/s] 20%|██        | 83/411 [00:00<00:02, 125.53it/s] 24%|██▎       | 97/411 [00:00<00:02, 128.84it/s] 27%|██▋       | 110/411 [00:00<00:02, 127.65it/s] 30%|██▉       | 123/411 [00:00<00:02, 124.06it/s] 33%|███▎      | 136/411 [00:01<00:02, 123.08it/s] 36%|███▋      | 149/411 [00:01<00:02, 121.37it/s] 39%|███▉      | 162/411 [00:01<00:02, 122.03it/s] 43%|████▎     | 175/411 [00:01<00:01, 121.00it/s] 46%|████▌     | 189/411 [00:01<00:01, 123.66it/s] 49%|████▉     | 202/411 [00:01<00:01, 125.14it/s] 52%|█████▏    | 215/411 [00:01<00:01, 124.39it/s] 55%|█████▌    | 228/411 [00:01<00:01, 123.06it/s] 59%|█████▉    | 242/411 [00:01<00:01, 126.98it/s] 62%|██████▏   | 255/411 [00:02<00:01, 124.62it/s] 65%|██████▌   | 269/411 [00:02<00:01, 128.55it/s] 69%|██████▊   | 282/411 [00:02<00:01, 127.32it/s] 72%|███████▏  | 295/411 [00:02<00:00, 125.69it/s] 75%|███████▍  | 308/411 [00:02<00:00, 123.05it/s] 78%|███████▊  | 321/411 [00:02<00:00, 121.75it/s] 81%|████████▏ | 334/411 [00:02<00:00, 121.35it/s] 84%|████████▍ | 347/411 [00:02<00:00, 119.00it/s] 87%|████████▋ | 359/411 [00:02<00:00, 118.20it/s] 91%|█████████ | 372/411 [00:02<00:00, 120.78it/s] 94%|█████████▎| 385/411 [00:03<00:00, 120.07it/s] 97%|█████████▋| 398/411 [00:03<00:00, 120.57it/s]100%|██████████| 411/411 [00:03<00:00, 121.89it/s]100%|██████████| 411/411 [00:03<00:00, 124.06it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 13%|█▎        | 52/409 [00:00<00:00, 508.68it/s] 25%|██▌       | 103/409 [00:00<00:00, 469.68it/s] 37%|███▋      | 151/409 [00:00<00:00, 459.63it/s] 48%|████▊     | 198/409 [00:00<00:00, 335.56it/s] 58%|█████▊    | 236/409 [00:00<00:00, 328.22it/s] 66%|██████▋   | 271/409 [00:00<00:00, 289.13it/s] 74%|███████▍  | 302/409 [00:00<00:00, 245.25it/s] 80%|████████  | 329/409 [00:01<00:00, 214.72it/s] 86%|████████▌ | 352/409 [00:01<00:00, 202.65it/s] 91%|█████████▏| 374/409 [00:01<00:00, 199.62it/s] 97%|█████████▋| 396/409 [00:01<00:00, 203.76it/s]100%|██████████| 409/409 [00:01<00:00, 261.14it/s]
2025-04-15 20:07:24,810 - INFO - Created 403 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:07:25,092 - INFO - Training GAT model...
2025-04-15 20:07:25,092 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:07:25,593 - INFO - Epoch 1/50, Train Loss: 64.9745, Val Loss: 76.3551
2025-04-15 20:07:26,084 - INFO - Epoch 2/50, Train Loss: 61.6436, Val Loss: 69.6817
2025-04-15 20:07:26,574 - INFO - Epoch 3/50, Train Loss: 57.0835, Val Loss: 65.7067
2025-04-15 20:07:27,090 - INFO - Epoch 4/50, Train Loss: 52.1021, Val Loss: 58.0809
2025-04-15 20:07:27,593 - INFO - Epoch 5/50, Train Loss: 49.5195, Val Loss: 58.1259
2025-04-15 20:07:28,113 - INFO - Epoch 6/50, Train Loss: 47.0908, Val Loss: 53.3939
2025-04-15 20:07:28,624 - INFO - Epoch 7/50, Train Loss: 45.3709, Val Loss: 49.8458
2025-04-15 20:07:29,118 - INFO - Epoch 8/50, Train Loss: 44.1420, Val Loss: 49.5776
2025-04-15 20:07:29,634 - INFO - Epoch 9/50, Train Loss: 41.5720, Val Loss: 43.8230
2025-04-15 20:07:30,154 - INFO - Epoch 10/50, Train Loss: 44.2367, Val Loss: 43.7904
2025-04-15 20:07:30,664 - INFO - Epoch 11/50, Train Loss: 42.1670, Val Loss: 43.3654
2025-04-15 20:07:31,169 - INFO - Epoch 12/50, Train Loss: 41.4968, Val Loss: 40.3174
2025-04-15 20:07:31,663 - INFO - Epoch 13/50, Train Loss: 39.3664, Val Loss: 41.6153
2025-04-15 20:07:32,170 - INFO - Epoch 14/50, Train Loss: 37.8608, Val Loss: 45.5809
2025-04-15 20:07:32,668 - INFO - Epoch 15/50, Train Loss: 40.7977, Val Loss: 35.9472
2025-04-15 20:07:33,191 - INFO - Epoch 16/50, Train Loss: 37.2573, Val Loss: 36.4357
2025-04-15 20:07:33,683 - INFO - Epoch 17/50, Train Loss: 36.4182, Val Loss: 34.9607
2025-04-15 20:07:34,201 - INFO - Epoch 18/50, Train Loss: 35.4278, Val Loss: 34.4739
2025-04-15 20:07:34,713 - INFO - Epoch 19/50, Train Loss: 35.1979, Val Loss: 39.0677
2025-04-15 20:07:35,209 - INFO - Epoch 20/50, Train Loss: 36.4377, Val Loss: 35.6452
2025-04-15 20:07:35,720 - INFO - Epoch 21/50, Train Loss: 34.9942, Val Loss: 29.6509
2025-04-15 20:07:36,224 - INFO - Epoch 22/50, Train Loss: 35.1102, Val Loss: 29.8573
2025-04-15 20:07:36,713 - INFO - Epoch 23/50, Train Loss: 34.9825, Val Loss: 32.8464
2025-04-15 20:07:37,215 - INFO - Epoch 24/50, Train Loss: 33.4522, Val Loss: 38.3726
2025-04-15 20:07:37,708 - INFO - Epoch 25/50, Train Loss: 35.4004, Val Loss: 29.5257
2025-04-15 20:07:38,208 - INFO - Epoch 26/50, Train Loss: 32.3212, Val Loss: 30.8834
2025-04-15 20:07:38,717 - INFO - Epoch 27/50, Train Loss: 33.1153, Val Loss: 29.5163
2025-04-15 20:07:39,244 - INFO - Epoch 28/50, Train Loss: 31.2162, Val Loss: 31.0810
2025-04-15 20:07:39,763 - INFO - Epoch 29/50, Train Loss: 31.7782, Val Loss: 26.7389
2025-04-15 20:07:40,281 - INFO - Epoch 30/50, Train Loss: 31.3176, Val Loss: 27.2917
2025-04-15 20:07:40,783 - INFO - Epoch 31/50, Train Loss: 31.4582, Val Loss: 29.1426
2025-04-15 20:07:41,290 - INFO - Epoch 32/50, Train Loss: 32.7911, Val Loss: 29.7702
2025-04-15 20:07:41,794 - INFO - Epoch 33/50, Train Loss: 32.6944, Val Loss: 26.4280
2025-04-15 20:07:42,317 - INFO - Epoch 34/50, Train Loss: 29.7999, Val Loss: 29.6445
2025-04-15 20:07:42,817 - INFO - Epoch 35/50, Train Loss: 30.1558, Val Loss: 30.3382
2025-04-15 20:07:43,327 - INFO - Epoch 36/50, Train Loss: 30.9485, Val Loss: 31.7291
2025-04-15 20:07:43,832 - INFO - Epoch 37/50, Train Loss: 29.8147, Val Loss: 28.6246
2025-04-15 20:07:44,325 - INFO - Epoch 38/50, Train Loss: 31.1336, Val Loss: 27.3774
2025-04-15 20:07:44,820 - INFO - Epoch 39/50, Train Loss: 31.3555, Val Loss: 26.9010
2025-04-15 20:07:45,335 - INFO - Epoch 40/50, Train Loss: 31.2141, Val Loss: 26.1075
2025-04-15 20:07:45,832 - INFO - Epoch 41/50, Train Loss: 28.2831, Val Loss: 26.0066
2025-04-15 20:07:46,341 - INFO - Epoch 42/50, Train Loss: 29.1291, Val Loss: 25.1574
2025-04-15 20:07:46,837 - INFO - Epoch 43/50, Train Loss: 27.6549, Val Loss: 28.7621
2025-04-15 20:07:47,331 - INFO - Epoch 44/50, Train Loss: 28.8118, Val Loss: 27.6295
2025-04-15 20:07:47,826 - INFO - Epoch 45/50, Train Loss: 28.3211, Val Loss: 28.7102
2025-04-15 20:07:48,324 - INFO - Epoch 46/50, Train Loss: 27.5265, Val Loss: 28.2097
2025-04-15 20:07:48,828 - INFO - Epoch 47/50, Train Loss: 28.2227, Val Loss: 26.1694
2025-04-15 20:07:49,330 - INFO - Epoch 48/50, Train Loss: 28.8334, Val Loss: 26.8768
2025-04-15 20:07:49,824 - INFO - Epoch 49/50, Train Loss: 28.7570, Val Loss: 29.8487
2025-04-15 20:07:50,328 - INFO - Epoch 50/50, Train Loss: 27.7736, Val Loss: 28.2913
2025-04-15 20:07:50,882 - INFO - Validation metrics - Horizontal: 21.56km, Depth: 9.62km, 3D: 25.16km
[I 2025-04-15 20:07:50,914] Trial 18 finished with value: 21.56178855895996 and parameters: {'time_window': 120, 'spatial_threshold': 100, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 3, 'learning_rate': 0.0006966436017846456, 'batch_size': 8, 'weight_decay': 5.003984135786765e-06}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:07:51,062 - INFO - 
Trial 19:
2025-04-15 20:07:51,062 - INFO - Graph params: time_window=240, spatial_threshold=50, min_connections=5
2025-04-15 20:07:51,062 - INFO - Model params: gnn_type=gat, hidden_dim=64, num_layers=6
2025-04-15 20:07:51,062 - INFO - Training params: lr=0.00023030186576618428, batch_size=32, weight_decay=9.414744192779674e-05
2025-04-15 20:07:51,117 - INFO - Creating graphs with time_window=240h, spatial_threshold=50km, min_connections=5...
Created 403 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 282, Val: 60, Test: 61 graphs
Creating causal relative spatiotemporal graphs (time window: 240h, spatial threshold: 50km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 127.41it/s]  7%|▋         | 28/411 [00:00<00:02, 135.26it/s] 10%|█         | 42/411 [00:00<00:02, 132.21it/s] 14%|█▎        | 56/411 [00:00<00:02, 130.98it/s] 17%|█▋        | 70/411 [00:00<00:02, 131.83it/s] 20%|██        | 84/411 [00:00<00:02, 128.97it/s] 24%|██▍       | 98/411 [00:00<00:02, 130.66it/s] 27%|██▋       | 112/411 [00:00<00:02, 127.96it/s] 30%|███       | 125/411 [00:00<00:02, 124.15it/s] 34%|███▎      | 138/411 [00:01<00:02, 123.00it/s] 37%|███▋      | 151/411 [00:01<00:02, 123.40it/s] 40%|███▉      | 164/411 [00:01<00:02, 121.09it/s] 43%|████▎     | 177/411 [00:01<00:01, 121.32it/s] 46%|████▌     | 190/411 [00:01<00:01, 123.64it/s] 49%|████▉     | 203/411 [00:01<00:01, 125.23it/s] 53%|█████▎    | 216/411 [00:01<00:01, 123.62it/s] 56%|█████▌    | 229/411 [00:01<00:01, 123.04it/s] 59%|█████▉    | 243/411 [00:01<00:01, 126.30it/s] 62%|██████▏   | 256/411 [00:02<00:01, 124.27it/s] 66%|██████▌   | 270/411 [00:02<00:01, 127.44it/s] 69%|██████▉   | 283/411 [00:02<00:01, 126.57it/s] 72%|███████▏  | 296/411 [00:02<00:00, 126.42it/s] 75%|███████▌  | 309/411 [00:02<00:00, 123.69it/s] 78%|███████▊  | 322/411 [00:02<00:00, 123.08it/s] 82%|████████▏ | 335/411 [00:02<00:00, 122.21it/s] 85%|████████▍ | 348/411 [00:02<00:00, 119.02it/s] 88%|████████▊ | 361/411 [00:02<00:00, 122.00it/s] 91%|█████████ | 374/411 [00:02<00:00, 122.69it/s] 94%|█████████▍| 387/411 [00:03<00:00, 122.49it/s] 97%|█████████▋| 400/411 [00:03<00:00, 123.98it/s]100%|██████████| 411/411 [00:03<00:00, 124.84it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 547.09it/s] 27%|██▋       | 111/409 [00:00<00:00, 392.81it/s] 37%|███▋      | 153/409 [00:00<00:00, 386.72it/s] 47%|████▋     | 193/409 [00:00<00:00, 314.02it/s] 56%|█████▌    | 227/409 [00:00<00:00, 277.57it/s] 63%|██████▎   | 257/409 [00:00<00:00, 265.06it/s] 70%|██████▉   | 285/409 [00:00<00:00, 237.38it/s] 76%|███████▌  | 310/409 [00:01<00:00, 208.42it/s] 81%|████████  | 332/409 [00:01<00:00, 185.12it/s] 86%|████████▌ | 352/409 [00:01<00:00, 169.63it/s] 90%|█████████ | 370/409 [00:01<00:00, 158.45it/s] 95%|█████████▍| 387/409 [00:01<00:00, 155.36it/s] 99%|█████████▉| 404/409 [00:01<00:00, 157.29it/s]100%|██████████| 409/409 [00:01<00:00, 220.82it/s]
2025-04-15 20:07:56,282 - INFO - Created 327 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:07:56,351 - INFO - Training GAT model...
2025-04-15 20:07:56,352 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:07:56,586 - INFO - Epoch 1/50, Train Loss: 54.7903, Val Loss: 70.6962
2025-04-15 20:07:56,819 - INFO - Epoch 2/50, Train Loss: 54.6543, Val Loss: 70.4329
2025-04-15 20:07:57,055 - INFO - Epoch 3/50, Train Loss: 54.5455, Val Loss: 70.1884
2025-04-15 20:07:57,292 - INFO - Epoch 4/50, Train Loss: 54.4302, Val Loss: 69.9602
2025-04-15 20:07:57,527 - INFO - Epoch 5/50, Train Loss: 54.3080, Val Loss: 69.7352
2025-04-15 20:07:57,766 - INFO - Epoch 6/50, Train Loss: 54.1881, Val Loss: 69.5000
2025-04-15 20:07:58,008 - INFO - Epoch 7/50, Train Loss: 53.9920, Val Loss: 69.2386
2025-04-15 20:07:58,246 - INFO - Epoch 8/50, Train Loss: 53.8881, Val Loss: 68.9648
2025-04-15 20:07:58,482 - INFO - Epoch 9/50, Train Loss: 53.7108, Val Loss: 68.6767
2025-04-15 20:07:58,713 - INFO - Epoch 10/50, Train Loss: 53.5401, Val Loss: 68.3837
2025-04-15 20:07:58,951 - INFO - Epoch 11/50, Train Loss: 53.3149, Val Loss: 68.0803
2025-04-15 20:07:59,194 - INFO - Epoch 12/50, Train Loss: 53.0515, Val Loss: 67.7707
2025-04-15 20:07:59,438 - INFO - Epoch 13/50, Train Loss: 52.7968, Val Loss: 67.4589
2025-04-15 20:07:59,671 - INFO - Epoch 14/50, Train Loss: 52.5813, Val Loss: 67.1363
2025-04-15 20:07:59,906 - INFO - Epoch 15/50, Train Loss: 52.2189, Val Loss: 66.7949
2025-04-15 20:08:00,154 - INFO - Epoch 16/50, Train Loss: 51.9898, Val Loss: 66.4324
2025-04-15 20:08:00,401 - INFO - Epoch 17/50, Train Loss: 51.6787, Val Loss: 66.0540
2025-04-15 20:08:00,642 - INFO - Epoch 18/50, Train Loss: 51.3339, Val Loss: 65.6640
2025-04-15 20:08:00,878 - INFO - Epoch 19/50, Train Loss: 50.9701, Val Loss: 65.2673
2025-04-15 20:08:01,117 - INFO - Epoch 20/50, Train Loss: 50.6128, Val Loss: 64.8425
2025-04-15 20:08:01,362 - INFO - Epoch 21/50, Train Loss: 50.2800, Val Loss: 64.4279
2025-04-15 20:08:01,606 - INFO - Epoch 22/50, Train Loss: 49.9796, Val Loss: 63.9500
2025-04-15 20:08:01,852 - INFO - Epoch 23/50, Train Loss: 49.4323, Val Loss: 63.4722
2025-04-15 20:08:02,090 - INFO - Epoch 24/50, Train Loss: 49.1451, Val Loss: 63.0231
2025-04-15 20:08:02,332 - INFO - Epoch 25/50, Train Loss: 48.7490, Val Loss: 62.6179
2025-04-15 20:08:02,571 - INFO - Epoch 26/50, Train Loss: 48.2125, Val Loss: 62.1896
2025-04-15 20:08:02,809 - INFO - Epoch 27/50, Train Loss: 47.8397, Val Loss: 61.6286
2025-04-15 20:08:03,052 - INFO - Epoch 28/50, Train Loss: 47.5003, Val Loss: 61.2300
2025-04-15 20:08:03,294 - INFO - Epoch 29/50, Train Loss: 46.7786, Val Loss: 60.7358
2025-04-15 20:08:03,531 - INFO - Epoch 30/50, Train Loss: 46.5233, Val Loss: 60.5109
2025-04-15 20:08:03,791 - INFO - Epoch 31/50, Train Loss: 45.9429, Val Loss: 60.0617
2025-04-15 20:08:04,031 - INFO - Epoch 32/50, Train Loss: 45.5164, Val Loss: 59.6339
2025-04-15 20:08:04,279 - INFO - Epoch 33/50, Train Loss: 45.3117, Val Loss: 59.2737
2025-04-15 20:08:04,518 - INFO - Epoch 34/50, Train Loss: 44.5562, Val Loss: 58.7284
2025-04-15 20:08:04,756 - INFO - Epoch 35/50, Train Loss: 44.0619, Val Loss: 58.2690
2025-04-15 20:08:04,998 - INFO - Epoch 36/50, Train Loss: 43.6925, Val Loss: 57.9101
2025-04-15 20:08:05,239 - INFO - Epoch 37/50, Train Loss: 43.3279, Val Loss: 57.2731
2025-04-15 20:08:05,479 - INFO - Epoch 38/50, Train Loss: 42.5992, Val Loss: 56.8540
2025-04-15 20:08:05,722 - INFO - Epoch 39/50, Train Loss: 42.3560, Val Loss: 56.7042
2025-04-15 20:08:05,958 - INFO - Epoch 40/50, Train Loss: 41.6495, Val Loss: 56.0498
2025-04-15 20:08:06,200 - INFO - Epoch 41/50, Train Loss: 41.4309, Val Loss: 55.4495
2025-04-15 20:08:06,441 - INFO - Epoch 42/50, Train Loss: 40.6567, Val Loss: 55.0422
2025-04-15 20:08:06,679 - INFO - Epoch 43/50, Train Loss: 40.0040, Val Loss: 54.8292
2025-04-15 20:08:06,917 - INFO - Epoch 44/50, Train Loss: 39.8184, Val Loss: 54.0616
2025-04-15 20:08:07,159 - INFO - Epoch 45/50, Train Loss: 39.4178, Val Loss: 53.4938
2025-04-15 20:08:07,396 - INFO - Epoch 46/50, Train Loss: 38.6544, Val Loss: 52.9838
2025-04-15 20:08:07,634 - INFO - Epoch 47/50, Train Loss: 38.4137, Val Loss: 52.0699
2025-04-15 20:08:07,875 - INFO - Epoch 48/50, Train Loss: 37.7113, Val Loss: 52.0318
2025-04-15 20:08:08,113 - INFO - Epoch 49/50, Train Loss: 36.8870, Val Loss: 51.3103
2025-04-15 20:08:08,351 - INFO - Epoch 50/50, Train Loss: 36.8306, Val Loss: 51.3389
2025-04-15 20:08:08,883 - INFO - Validation metrics - Horizontal: 49.45km, Depth: 9.93km, 3D: 51.31km
[I 2025-04-15 20:08:08,916] Trial 19 finished with value: 49.45244216918945 and parameters: {'time_window': 240, 'spatial_threshold': 50, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 64, 'num_layers': 6, 'learning_rate': 0.00023030186576618428, 'batch_size': 32, 'weight_decay': 9.414744192779674e-05}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:08:09,076 - INFO - 
Trial 20:
2025-04-15 20:08:09,077 - INFO - Graph params: time_window=168, spatial_threshold=200, min_connections=1
2025-04-15 20:08:09,077 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=5
2025-04-15 20:08:09,077 - INFO - Training params: lr=0.0017348977959379091, batch_size=8, weight_decay=2.2297053145362274e-05
2025-04-15 20:08:09,121 - INFO - Creating graphs with time_window=168h, spatial_threshold=200km, min_connections=1...
Created 327 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 228, Val: 49, Test: 50 graphs
Creating causal relative spatiotemporal graphs (time window: 168h, spatial threshold: 200km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 134.31it/s]  7%|▋         | 28/411 [00:00<00:02, 136.51it/s] 10%|█         | 42/411 [00:00<00:02, 135.20it/s] 14%|█▎        | 56/411 [00:00<00:02, 134.35it/s] 17%|█▋        | 70/411 [00:00<00:02, 135.03it/s] 20%|██        | 84/411 [00:00<00:02, 132.07it/s] 24%|██▍       | 98/411 [00:00<00:02, 132.76it/s] 27%|██▋       | 112/411 [00:00<00:02, 129.87it/s] 31%|███       | 126/411 [00:00<00:02, 125.80it/s] 34%|███▍      | 139/411 [00:01<00:02, 123.73it/s] 37%|███▋      | 152/411 [00:01<00:02, 123.48it/s] 40%|████      | 165/411 [00:01<00:02, 121.15it/s] 43%|████▎     | 178/411 [00:01<00:01, 119.35it/s] 46%|████▋     | 191/411 [00:01<00:01, 122.03it/s] 50%|████▉     | 204/411 [00:01<00:01, 123.24it/s] 53%|█████▎    | 217/411 [00:01<00:01, 124.14it/s] 56%|█████▌    | 230/411 [00:01<00:01, 124.56it/s] 59%|█████▉    | 244/411 [00:01<00:01, 126.68it/s] 63%|██████▎   | 257/411 [00:02<00:01, 125.21it/s] 66%|██████▌   | 272/411 [00:02<00:01, 131.51it/s] 70%|██████▉   | 286/411 [00:02<00:00, 128.53it/s] 73%|███████▎  | 299/411 [00:02<00:00, 125.45it/s] 76%|███████▌  | 312/411 [00:02<00:00, 125.57it/s] 79%|███████▉  | 325/411 [00:02<00:00, 126.67it/s] 82%|████████▏ | 338/411 [00:02<00:00, 122.89it/s] 85%|████████▌ | 351/411 [00:02<00:00, 120.66it/s] 89%|████████▉ | 366/411 [00:02<00:00, 127.34it/s] 92%|█████████▏| 379/411 [00:03<00:00, 123.67it/s] 95%|█████████▌| 392/411 [00:03<00:00, 123.86it/s] 99%|█████████▉| 406/411 [00:03<00:00, 126.06it/s]100%|██████████| 411/411 [00:03<00:00, 126.14it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 11%|█         | 46/409 [00:00<00:00, 446.31it/s] 22%|██▏       | 91/409 [00:00<00:01, 314.79it/s] 31%|███       | 127/409 [00:00<00:00, 330.41it/s] 40%|███▉      | 162/409 [00:00<00:00, 301.31it/s] 47%|████▋     | 194/409 [00:00<00:00, 235.29it/s] 54%|█████▍    | 220/409 [00:00<00:00, 241.31it/s] 60%|██████    | 246/409 [00:00<00:00, 229.79it/s] 66%|██████▋   | 271/409 [00:01<00:00, 200.99it/s] 72%|███████▏  | 293/409 [00:01<00:00, 174.00it/s] 76%|███████▋  | 312/409 [00:01<00:00, 155.63it/s] 80%|████████  | 329/409 [00:01<00:00, 140.26it/s] 84%|████████▍ | 344/409 [00:01<00:00, 130.91it/s] 88%|████████▊ | 358/409 [00:01<00:00, 124.69it/s] 91%|█████████ | 371/409 [00:01<00:00, 122.01it/s] 94%|█████████▍| 386/409 [00:02<00:00, 127.33it/s] 98%|█████████▊| 402/409 [00:02<00:00, 135.00it/s]100%|██████████| 409/409 [00:02<00:00, 182.91it/s]
2025-04-15 20:08:14,636 - INFO - Created 409 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:08:14,727 - INFO - Training GAT model...
2025-04-15 20:08:14,727 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:08:15,852 - INFO - Epoch 1/50, Train Loss: 66.9000, Val Loss: 80.1201
2025-04-15 20:08:17,005 - INFO - Epoch 2/50, Train Loss: 64.8900, Val Loss: 80.0874
2025-04-15 20:08:18,247 - INFO - Epoch 3/50, Train Loss: 64.8238, Val Loss: 79.9010
2025-04-15 20:08:19,596 - INFO - Epoch 4/50, Train Loss: 63.2895, Val Loss: 78.5446
2025-04-15 20:08:20,978 - INFO - Epoch 5/50, Train Loss: 62.7128, Val Loss: 81.3368
2025-04-15 20:08:22,680 - INFO - Epoch 6/50, Train Loss: 62.9945, Val Loss: 76.3883
2025-04-15 20:08:24,462 - INFO - Epoch 7/50, Train Loss: 64.0454, Val Loss: 76.1776
2025-04-15 20:08:26,120 - INFO - Epoch 8/50, Train Loss: 63.2326, Val Loss: 74.8993
2025-04-15 20:08:27,944 - INFO - Epoch 9/50, Train Loss: 61.5070, Val Loss: 78.5625
2025-04-15 20:08:29,895 - INFO - Epoch 10/50, Train Loss: 62.3960, Val Loss: 74.8015
2025-04-15 20:08:31,781 - INFO - Epoch 11/50, Train Loss: 61.9740, Val Loss: 72.5217
2025-04-15 20:08:33,655 - INFO - Epoch 12/50, Train Loss: 61.6719, Val Loss: 75.5636
2025-04-15 20:08:35,601 - INFO - Epoch 13/50, Train Loss: 61.7999, Val Loss: 71.9258
2025-04-15 20:08:37,428 - INFO - Epoch 14/50, Train Loss: 62.0937, Val Loss: 75.3711
2025-04-15 20:08:39,061 - INFO - Epoch 15/50, Train Loss: 61.6892, Val Loss: 75.5333
2025-04-15 20:08:40,709 - INFO - Epoch 16/50, Train Loss: 62.0682, Val Loss: 72.8984
2025-04-15 20:08:42,285 - INFO - Epoch 17/50, Train Loss: 62.5153, Val Loss: 71.4596
2025-04-15 20:08:43,986 - INFO - Epoch 18/50, Train Loss: 63.2493, Val Loss: 85.0825
2025-04-15 20:08:45,694 - INFO - Epoch 19/50, Train Loss: 61.8285, Val Loss: 77.4154
2025-04-15 20:08:47,437 - INFO - Epoch 20/50, Train Loss: 61.2935, Val Loss: 77.1974
2025-04-15 20:08:49,246 - INFO - Epoch 21/50, Train Loss: 64.0525, Val Loss: 78.0715
2025-04-15 20:08:50,997 - INFO - Epoch 22/50, Train Loss: 63.4339, Val Loss: 76.8701
2025-04-15 20:08:52,722 - INFO - Epoch 23/50, Train Loss: 63.3854, Val Loss: 78.8547
2025-04-15 20:08:54,559 - INFO - Epoch 24/50, Train Loss: 62.8096, Val Loss: 79.8118
2025-04-15 20:08:56,422 - INFO - Epoch 25/50, Train Loss: 62.2611, Val Loss: 80.3091
2025-04-15 20:08:58,231 - INFO - Epoch 26/50, Train Loss: 62.6093, Val Loss: 80.6042
2025-04-15 20:09:00,028 - INFO - Epoch 27/50, Train Loss: 62.2870, Val Loss: 79.5871
2025-04-15 20:09:00,028 - INFO - Early stopping at epoch 27. Best epoch: 17
/home/kalvisuser/sandbox/gnn-aftershock/new/relative_gnn.py:1116: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`). Consider using `matplotlib.pyplot.close()`.
  plt.figure(figsize=(10, 6))
2025-04-15 20:09:00,650 - INFO - Validation metrics - Horizontal: 68.87km, Depth: 15.27km, 3D: 71.46km
[I 2025-04-15 20:09:00,682] Trial 20 finished with value: 68.87178802490234 and parameters: {'time_window': 168, 'spatial_threshold': 200, 'min_connections': 1, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 5, 'learning_rate': 0.0017348977959379091, 'batch_size': 8, 'weight_decay': 2.2297053145362274e-05}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:09:00,840 - INFO - 
Trial 21:
2025-04-15 20:09:00,840 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:09:00,840 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=4
2025-04-15 20:09:00,840 - INFO - Training params: lr=0.0014027330766474895, batch_size=8, weight_decay=1.4107793829539772e-05
2025-04-15 20:09:00,886 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 409 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 286, Val: 61, Test: 62 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 127.06it/s]  7%|▋         | 27/411 [00:00<00:02, 130.86it/s] 10%|▉         | 41/411 [00:00<00:02, 128.20it/s] 13%|█▎        | 55/411 [00:00<00:02, 129.16it/s] 17%|█▋        | 68/411 [00:00<00:02, 128.97it/s] 20%|█▉        | 81/411 [00:00<00:02, 127.40it/s] 23%|██▎       | 95/411 [00:00<00:02, 129.04it/s] 26%|██▋       | 108/411 [00:00<00:02, 128.29it/s] 29%|██▉       | 121/411 [00:00<00:02, 123.89it/s] 33%|███▎      | 134/411 [00:01<00:02, 123.23it/s] 36%|███▌      | 147/411 [00:01<00:02, 123.10it/s] 39%|███▉      | 160/411 [00:01<00:02, 122.37it/s] 42%|████▏     | 173/411 [00:01<00:01, 120.43it/s] 45%|████▌     | 186/411 [00:01<00:01, 121.56it/s] 49%|████▊     | 200/411 [00:01<00:01, 124.80it/s] 52%|█████▏    | 213/411 [00:01<00:01, 125.01it/s] 55%|█████▍    | 226/411 [00:01<00:01, 123.80it/s] 58%|█████▊    | 239/411 [00:01<00:01, 123.77it/s] 61%|██████▏   | 252/411 [00:02<00:01, 122.94it/s] 65%|██████▍   | 266/411 [00:02<00:01, 127.36it/s] 68%|██████▊   | 279/411 [00:02<00:01, 124.46it/s] 71%|███████▏  | 293/411 [00:02<00:00, 126.47it/s] 74%|███████▍  | 306/411 [00:02<00:00, 121.21it/s] 78%|███████▊  | 319/411 [00:02<00:00, 123.39it/s] 81%|████████  | 332/411 [00:02<00:00, 122.22it/s] 84%|████████▍ | 345/411 [00:02<00:00, 121.30it/s] 87%|████████▋ | 358/411 [00:02<00:00, 116.50it/s] 91%|█████████ | 372/411 [00:02<00:00, 121.74it/s] 94%|█████████▎| 385/411 [00:03<00:00, 121.82it/s] 97%|█████████▋| 398/411 [00:03<00:00, 122.66it/s]100%|██████████| 411/411 [00:03<00:00, 123.66it/s]100%|██████████| 411/411 [00:03<00:00, 124.02it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 13%|█▎        | 55/409 [00:00<00:00, 541.80it/s] 27%|██▋       | 110/409 [00:00<00:00, 531.70it/s] 40%|████      | 164/409 [00:00<00:00, 468.27it/s] 52%|█████▏    | 212/409 [00:00<00:00, 382.00it/s] 62%|██████▏   | 253/409 [00:00<00:00, 347.80it/s] 71%|███████   | 290/409 [00:00<00:00, 292.23it/s] 78%|███████▊  | 321/409 [00:01<00:00, 245.45it/s] 85%|████████▌ | 348/409 [00:01<00:00, 225.45it/s] 91%|█████████ | 372/409 [00:01<00:00, 220.52it/s] 97%|█████████▋| 395/409 [00:01<00:00, 222.00it/s]100%|██████████| 409/409 [00:01<00:00, 284.32it/s]
2025-04-15 20:09:05,660 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:09:05,732 - INFO - Training GAT model...
2025-04-15 20:09:05,732 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:09:06,239 - INFO - Epoch 1/50, Train Loss: 53.6378, Val Loss: 62.0908
2025-04-15 20:09:06,724 - INFO - Epoch 2/50, Train Loss: 47.6334, Val Loss: 52.4416
2025-04-15 20:09:07,226 - INFO - Epoch 3/50, Train Loss: 43.7886, Val Loss: 45.5980
2025-04-15 20:09:07,712 - INFO - Epoch 4/50, Train Loss: 39.8444, Val Loss: 39.2423
2025-04-15 20:09:08,203 - INFO - Epoch 5/50, Train Loss: 35.2092, Val Loss: 42.2970
2025-04-15 20:09:08,705 - INFO - Epoch 6/50, Train Loss: 37.9725, Val Loss: 37.6856
2025-04-15 20:09:09,196 - INFO - Epoch 7/50, Train Loss: 36.3851, Val Loss: 34.9862
2025-04-15 20:09:09,668 - INFO - Epoch 8/50, Train Loss: 32.8424, Val Loss: 39.4287
2025-04-15 20:09:10,146 - INFO - Epoch 9/50, Train Loss: 32.4027, Val Loss: 38.6122
2025-04-15 20:09:10,643 - INFO - Epoch 10/50, Train Loss: 31.8626, Val Loss: 38.0668
2025-04-15 20:09:11,131 - INFO - Epoch 11/50, Train Loss: 31.7967, Val Loss: 30.5550
2025-04-15 20:09:11,610 - INFO - Epoch 12/50, Train Loss: 29.8739, Val Loss: 34.8777
2025-04-15 20:09:12,086 - INFO - Epoch 13/50, Train Loss: 30.3320, Val Loss: 30.5805
2025-04-15 20:09:12,587 - INFO - Epoch 14/50, Train Loss: 28.9621, Val Loss: 34.1662
2025-04-15 20:09:13,099 - INFO - Epoch 15/50, Train Loss: 30.6891, Val Loss: 27.1598
2025-04-15 20:09:13,603 - INFO - Epoch 16/50, Train Loss: 29.8281, Val Loss: 28.5144
2025-04-15 20:09:14,094 - INFO - Epoch 17/50, Train Loss: 28.3210, Val Loss: 35.9723
2025-04-15 20:09:14,584 - INFO - Epoch 18/50, Train Loss: 28.4722, Val Loss: 27.9430
2025-04-15 20:09:15,068 - INFO - Epoch 19/50, Train Loss: 28.0058, Val Loss: 32.2962
2025-04-15 20:09:15,568 - INFO - Epoch 20/50, Train Loss: 26.9506, Val Loss: 29.3617
2025-04-15 20:09:16,056 - INFO - Epoch 21/50, Train Loss: 26.5643, Val Loss: 29.6782
2025-04-15 20:09:16,553 - INFO - Epoch 22/50, Train Loss: 27.5982, Val Loss: 28.5269
2025-04-15 20:09:17,035 - INFO - Epoch 23/50, Train Loss: 25.8255, Val Loss: 28.0267
2025-04-15 20:09:17,522 - INFO - Epoch 24/50, Train Loss: 24.9952, Val Loss: 31.1813
2025-04-15 20:09:17,998 - INFO - Epoch 25/50, Train Loss: 23.5041, Val Loss: 29.9457
2025-04-15 20:09:17,998 - INFO - Early stopping at epoch 25. Best epoch: 15
2025-04-15 20:09:18,562 - INFO - Validation metrics - Horizontal: 24.71km, Depth: 8.69km, 3D: 27.16km
[I 2025-04-15 20:09:18,596] Trial 21 finished with value: 24.705242156982422 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 4, 'learning_rate': 0.0014027330766474895, 'batch_size': 8, 'weight_decay': 1.4107793829539772e-05}. Best is trial 11 with value: 20.46588897705078.
2025-04-15 20:09:19,099 - INFO - 
Trial 22:
2025-04-15 20:09:19,099 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:09:19,099 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=3
2025-04-15 20:09:19,099 - INFO - Training params: lr=0.0026154033981211277, batch_size=8, weight_decay=6.4617557814088705e-06
2025-04-15 20:09:19,145 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 129.68it/s]  7%|▋         | 28/411 [00:00<00:02, 136.97it/s] 10%|█         | 42/411 [00:00<00:02, 135.07it/s] 14%|█▎        | 56/411 [00:00<00:02, 134.24it/s] 17%|█▋        | 70/411 [00:00<00:02, 134.57it/s] 20%|██        | 84/411 [00:00<00:02, 131.97it/s] 24%|██▍       | 98/411 [00:00<00:02, 133.45it/s] 27%|██▋       | 112/411 [00:00<00:02, 131.07it/s] 31%|███       | 126/411 [00:00<00:02, 127.62it/s] 34%|███▍      | 139/411 [00:01<00:02, 126.76it/s] 37%|███▋      | 152/411 [00:01<00:02, 126.55it/s] 40%|████      | 165/411 [00:01<00:01, 124.81it/s] 43%|████▎     | 178/411 [00:01<00:01, 124.07it/s] 47%|████▋     | 192/411 [00:01<00:01, 127.06it/s] 50%|████▉     | 205/411 [00:01<00:01, 127.45it/s] 53%|█████▎    | 218/411 [00:01<00:01, 128.11it/s] 56%|█████▌    | 231/411 [00:01<00:01, 127.02it/s] 60%|█████▉    | 245/411 [00:01<00:01, 128.87it/s] 63%|██████▎   | 259/411 [00:02<00:01, 128.99it/s] 67%|██████▋   | 274/411 [00:02<00:01, 132.38it/s] 70%|███████   | 288/411 [00:02<00:00, 132.05it/s] 73%|███████▎  | 302/411 [00:02<00:00, 124.62it/s] 77%|███████▋  | 315/411 [00:02<00:00, 125.03it/s] 80%|███████▉  | 328/411 [00:02<00:00, 125.22it/s] 83%|████████▎ | 341/411 [00:02<00:00, 122.20it/s] 86%|████████▌ | 354/411 [00:02<00:00, 120.10it/s] 90%|████████▉ | 369/411 [00:02<00:00, 126.65it/s] 93%|█████████▎| 382/411 [00:02<00:00, 123.94it/s] 96%|█████████▌| 395/411 [00:03<00:00, 124.47it/s]100%|█████████▉| 409/411 [00:03<00:00, 125.82it/s]100%|██████████| 411/411 [00:03<00:00, 127.50it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▍        | 57/409 [00:00<00:00, 561.86it/s] 28%|██▊       | 114/409 [00:00<00:00, 549.45it/s] 41%|████▏     | 169/409 [00:00<00:00, 459.83it/s] 53%|█████▎    | 217/409 [00:00<00:00, 386.53it/s] 63%|██████▎   | 258/409 [00:00<00:00, 345.74it/s] 72%|███████▏  | 294/409 [00:00<00:00, 290.02it/s] 79%|███████▉  | 325/409 [00:01<00:00, 248.12it/s] 86%|████████▌ | 352/409 [00:01<00:00, 229.48it/s] 92%|█████████▏| 376/409 [00:01<00:00, 224.53it/s] 98%|█████████▊| 400/409 [00:01<00:00, 227.97it/s]100%|██████████| 409/409 [00:01<00:00, 289.85it/s]
2025-04-15 20:09:23,800 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:09:23,869 - INFO - Training GAT model...
2025-04-15 20:09:23,869 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:09:24,256 - INFO - Epoch 1/50, Train Loss: 50.9539, Val Loss: 57.3059
2025-04-15 20:09:24,623 - INFO - Epoch 2/50, Train Loss: 45.7532, Val Loss: 49.9482
2025-04-15 20:09:25,005 - INFO - Epoch 3/50, Train Loss: 38.9120, Val Loss: 41.7879
2025-04-15 20:09:25,395 - INFO - Epoch 4/50, Train Loss: 37.4974, Val Loss: 41.5929
2025-04-15 20:09:25,785 - INFO - Epoch 5/50, Train Loss: 35.9843, Val Loss: 33.3020
2025-04-15 20:09:26,183 - INFO - Epoch 6/50, Train Loss: 34.8885, Val Loss: 40.8932
2025-04-15 20:09:26,573 - INFO - Epoch 7/50, Train Loss: 35.8705, Val Loss: 31.4562
2025-04-15 20:09:26,960 - INFO - Epoch 8/50, Train Loss: 34.1731, Val Loss: 34.3807
2025-04-15 20:09:27,352 - INFO - Epoch 9/50, Train Loss: 31.4581, Val Loss: 30.5217
2025-04-15 20:09:27,748 - INFO - Epoch 10/50, Train Loss: 31.0325, Val Loss: 34.0633
2025-04-15 20:09:28,164 - INFO - Epoch 11/50, Train Loss: 33.3574, Val Loss: 30.8404
2025-04-15 20:09:28,575 - INFO - Epoch 12/50, Train Loss: 31.5956, Val Loss: 34.5546
2025-04-15 20:09:28,967 - INFO - Epoch 13/50, Train Loss: 30.7152, Val Loss: 28.7843
2025-04-15 20:09:29,388 - INFO - Epoch 14/50, Train Loss: 29.4094, Val Loss: 28.0802
2025-04-15 20:09:29,809 - INFO - Epoch 15/50, Train Loss: 28.0574, Val Loss: 27.7036
2025-04-15 20:09:30,231 - INFO - Epoch 16/50, Train Loss: 29.3710, Val Loss: 34.2995
2025-04-15 20:09:30,630 - INFO - Epoch 17/50, Train Loss: 28.4408, Val Loss: 26.1550
2025-04-15 20:09:31,051 - INFO - Epoch 18/50, Train Loss: 29.3252, Val Loss: 26.7982
2025-04-15 20:09:31,471 - INFO - Epoch 19/50, Train Loss: 29.3374, Val Loss: 26.6848
2025-04-15 20:09:31,891 - INFO - Epoch 20/50, Train Loss: 29.9105, Val Loss: 29.2284
2025-04-15 20:09:32,318 - INFO - Epoch 21/50, Train Loss: 27.2742, Val Loss: 25.6929
2025-04-15 20:09:32,734 - INFO - Epoch 22/50, Train Loss: 28.0957, Val Loss: 25.8079
2025-04-15 20:09:33,138 - INFO - Epoch 23/50, Train Loss: 28.4125, Val Loss: 28.7335
2025-04-15 20:09:33,527 - INFO - Epoch 24/50, Train Loss: 27.5959, Val Loss: 24.0793
2025-04-15 20:09:33,912 - INFO - Epoch 25/50, Train Loss: 27.6429, Val Loss: 26.9818
2025-04-15 20:09:34,304 - INFO - Epoch 26/50, Train Loss: 27.7048, Val Loss: 23.5948
2025-04-15 20:09:34,694 - INFO - Epoch 27/50, Train Loss: 26.6282, Val Loss: 28.0063
2025-04-15 20:09:35,101 - INFO - Epoch 28/50, Train Loss: 26.4084, Val Loss: 23.5108
2025-04-15 20:09:35,538 - INFO - Epoch 29/50, Train Loss: 26.9046, Val Loss: 25.9297
2025-04-15 20:09:35,957 - INFO - Epoch 30/50, Train Loss: 26.3446, Val Loss: 24.5439
2025-04-15 20:09:36,394 - INFO - Epoch 31/50, Train Loss: 26.3628, Val Loss: 27.7270
2025-04-15 20:09:36,826 - INFO - Epoch 32/50, Train Loss: 24.7636, Val Loss: 26.5660
2025-04-15 20:09:37,261 - INFO - Epoch 33/50, Train Loss: 25.6193, Val Loss: 23.8825
2025-04-15 20:09:37,703 - INFO - Epoch 34/50, Train Loss: 26.8493, Val Loss: 26.6265
2025-04-15 20:09:38,141 - INFO - Epoch 35/50, Train Loss: 27.7131, Val Loss: 24.7836
2025-04-15 20:09:38,557 - INFO - Epoch 36/50, Train Loss: 24.4404, Val Loss: 24.2384
2025-04-15 20:09:38,983 - INFO - Epoch 37/50, Train Loss: 25.1656, Val Loss: 22.3799
2025-04-15 20:09:39,410 - INFO - Epoch 38/50, Train Loss: 24.5815, Val Loss: 24.8237
2025-04-15 20:09:39,821 - INFO - Epoch 39/50, Train Loss: 23.9804, Val Loss: 24.5409
2025-04-15 20:09:40,232 - INFO - Epoch 40/50, Train Loss: 24.3875, Val Loss: 24.4681
2025-04-15 20:09:40,647 - INFO - Epoch 41/50, Train Loss: 22.4508, Val Loss: 24.6488
2025-04-15 20:09:41,068 - INFO - Epoch 42/50, Train Loss: 23.9851, Val Loss: 26.0385
2025-04-15 20:09:41,499 - INFO - Epoch 43/50, Train Loss: 23.4745, Val Loss: 25.0997
2025-04-15 20:09:41,904 - INFO - Epoch 44/50, Train Loss: 23.0553, Val Loss: 25.1600
2025-04-15 20:09:42,313 - INFO - Epoch 45/50, Train Loss: 23.9920, Val Loss: 25.0627
2025-04-15 20:09:42,730 - INFO - Epoch 46/50, Train Loss: 23.1718, Val Loss: 24.1138
2025-04-15 20:09:43,165 - INFO - Epoch 47/50, Train Loss: 23.4813, Val Loss: 25.6223
2025-04-15 20:09:43,165 - INFO - Early stopping at epoch 47. Best epoch: 37
2025-04-15 20:09:43,710 - INFO - Validation metrics - Horizontal: 19.46km, Depth: 8.35km, 3D: 22.38km
[I 2025-04-15 20:09:43,744] Trial 22 finished with value: 19.460182189941406 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 3, 'learning_rate': 0.0026154033981211277, 'batch_size': 8, 'weight_decay': 6.4617557814088705e-06}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:09:43,901 - INFO - 
Trial 23:
2025-04-15 20:09:43,901 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:09:43,901 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=2
2025-04-15 20:09:43,901 - INFO - Training params: lr=0.0027479090395656543, batch_size=8, weight_decay=4.544892144107916e-06
2025-04-15 20:09:43,948 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 127.34it/s]  7%|▋         | 27/411 [00:00<00:02, 133.02it/s] 10%|▉         | 41/411 [00:00<00:02, 130.58it/s] 13%|█▎        | 55/411 [00:00<00:02, 130.14it/s] 17%|█▋        | 69/411 [00:00<00:02, 131.34it/s] 20%|██        | 83/411 [00:00<00:02, 127.53it/s] 24%|██▎       | 97/411 [00:00<00:02, 130.80it/s] 27%|██▋       | 111/411 [00:00<00:02, 128.45it/s] 30%|███       | 124/411 [00:00<00:02, 124.73it/s] 33%|███▎      | 137/411 [00:01<00:02, 125.51it/s] 36%|███▋      | 150/411 [00:01<00:02, 124.00it/s] 40%|███▉      | 163/411 [00:01<00:02, 122.18it/s] 43%|████▎     | 176/411 [00:01<00:01, 121.43it/s] 46%|████▌     | 189/411 [00:01<00:01, 123.34it/s] 49%|████▉     | 203/411 [00:01<00:01, 125.28it/s] 53%|█████▎    | 216/411 [00:01<00:01, 124.68it/s] 56%|█████▌    | 229/411 [00:01<00:01, 124.34it/s] 59%|█████▉    | 243/411 [00:01<00:01, 128.22it/s] 62%|██████▏   | 256/411 [00:02<00:01, 126.51it/s] 66%|██████▌   | 270/411 [00:02<00:01, 128.46it/s] 69%|██████▉   | 283/411 [00:02<00:01, 126.63it/s] 72%|███████▏  | 296/411 [00:02<00:00, 126.21it/s] 75%|███████▌  | 309/411 [00:02<00:00, 122.00it/s] 78%|███████▊  | 322/411 [00:02<00:00, 121.16it/s] 82%|████████▏ | 335/411 [00:02<00:00, 121.04it/s] 85%|████████▍ | 348/411 [00:02<00:00, 118.46it/s] 88%|████████▊ | 361/411 [00:02<00:00, 121.57it/s] 91%|█████████ | 374/411 [00:02<00:00, 122.83it/s] 94%|█████████▍| 387/411 [00:03<00:00, 121.76it/s] 97%|█████████▋| 400/411 [00:03<00:00, 123.24it/s]100%|██████████| 411/411 [00:03<00:00, 124.74it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 557.52it/s] 27%|██▋       | 112/409 [00:00<00:00, 545.08it/s] 41%|████      | 167/409 [00:00<00:00, 464.94it/s] 53%|█████▎    | 215/409 [00:00<00:00, 386.88it/s] 63%|██████▎   | 256/409 [00:00<00:00, 347.54it/s] 72%|███████▏  | 293/409 [00:00<00:00, 291.01it/s] 79%|███████▉  | 324/409 [00:01<00:00, 248.62it/s] 86%|████████▌ | 351/409 [00:01<00:00, 229.28it/s] 92%|█████████▏| 375/409 [00:01<00:00, 224.24it/s] 98%|█████████▊| 399/409 [00:01<00:00, 227.07it/s]100%|██████████| 409/409 [00:01<00:00, 289.23it/s]
2025-04-15 20:09:48,678 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:09:48,746 - INFO - Training GAT model...
2025-04-15 20:09:48,746 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:09:49,024 - INFO - Epoch 1/50, Train Loss: 50.8179, Val Loss: 53.2845
2025-04-15 20:09:49,312 - INFO - Epoch 2/50, Train Loss: 42.5922, Val Loss: 43.8297
2025-04-15 20:09:49,581 - INFO - Epoch 3/50, Train Loss: 39.9306, Val Loss: 44.1111
2025-04-15 20:09:49,856 - INFO - Epoch 4/50, Train Loss: 34.6637, Val Loss: 44.5624
2025-04-15 20:09:50,137 - INFO - Epoch 5/50, Train Loss: 36.2592, Val Loss: 39.3244
2025-04-15 20:09:50,413 - INFO - Epoch 6/50, Train Loss: 34.2097, Val Loss: 38.5726
2025-04-15 20:09:50,688 - INFO - Epoch 7/50, Train Loss: 32.9116, Val Loss: 38.1798
2025-04-15 20:09:50,963 - INFO - Epoch 8/50, Train Loss: 30.7487, Val Loss: 37.2997
2025-04-15 20:09:51,248 - INFO - Epoch 9/50, Train Loss: 29.8845, Val Loss: 36.2525
2025-04-15 20:09:51,521 - INFO - Epoch 10/50, Train Loss: 28.5850, Val Loss: 35.6925
2025-04-15 20:09:51,793 - INFO - Epoch 11/50, Train Loss: 29.4201, Val Loss: 31.3410
2025-04-15 20:09:52,067 - INFO - Epoch 12/50, Train Loss: 29.2480, Val Loss: 33.9810
2025-04-15 20:09:52,345 - INFO - Epoch 13/50, Train Loss: 29.1529, Val Loss: 32.0798
2025-04-15 20:09:52,621 - INFO - Epoch 14/50, Train Loss: 27.3250, Val Loss: 29.7893
2025-04-15 20:09:52,911 - INFO - Epoch 15/50, Train Loss: 28.2547, Val Loss: 30.1373
2025-04-15 20:09:53,198 - INFO - Epoch 16/50, Train Loss: 27.5234, Val Loss: 33.0253
2025-04-15 20:09:53,468 - INFO - Epoch 17/50, Train Loss: 25.6320, Val Loss: 32.4965
2025-04-15 20:09:53,738 - INFO - Epoch 18/50, Train Loss: 26.4053, Val Loss: 30.1732
2025-04-15 20:09:54,005 - INFO - Epoch 19/50, Train Loss: 27.6318, Val Loss: 30.0137
2025-04-15 20:09:54,284 - INFO - Epoch 20/50, Train Loss: 26.2041, Val Loss: 31.1481
2025-04-15 20:09:54,557 - INFO - Epoch 21/50, Train Loss: 26.3376, Val Loss: 30.6732
2025-04-15 20:09:54,835 - INFO - Epoch 22/50, Train Loss: 24.7107, Val Loss: 26.6751
2025-04-15 20:09:55,113 - INFO - Epoch 23/50, Train Loss: 24.1485, Val Loss: 28.7846
2025-04-15 20:09:55,390 - INFO - Epoch 24/50, Train Loss: 24.0700, Val Loss: 28.8263
2025-04-15 20:09:55,669 - INFO - Epoch 25/50, Train Loss: 23.5778, Val Loss: 24.5506
2025-04-15 20:09:55,944 - INFO - Epoch 26/50, Train Loss: 23.3149, Val Loss: 27.6882
2025-04-15 20:09:56,226 - INFO - Epoch 27/50, Train Loss: 22.3684, Val Loss: 26.5329
2025-04-15 20:09:56,499 - INFO - Epoch 28/50, Train Loss: 22.7863, Val Loss: 27.8415
2025-04-15 20:09:56,774 - INFO - Epoch 29/50, Train Loss: 21.7263, Val Loss: 25.7433
2025-04-15 20:09:57,061 - INFO - Epoch 30/50, Train Loss: 23.0681, Val Loss: 25.3761
2025-04-15 20:09:57,344 - INFO - Epoch 31/50, Train Loss: 22.0512, Val Loss: 27.1415
2025-04-15 20:09:57,640 - INFO - Epoch 32/50, Train Loss: 22.6698, Val Loss: 25.7856
2025-04-15 20:09:57,929 - INFO - Epoch 33/50, Train Loss: 22.8832, Val Loss: 26.4854
2025-04-15 20:09:58,211 - INFO - Epoch 34/50, Train Loss: 21.5478, Val Loss: 27.7642
2025-04-15 20:09:58,500 - INFO - Epoch 35/50, Train Loss: 22.2285, Val Loss: 28.3941
2025-04-15 20:09:58,500 - INFO - Early stopping at epoch 35. Best epoch: 25
2025-04-15 20:09:59,042 - INFO - Validation metrics - Horizontal: 21.71km, Depth: 8.46km, 3D: 24.55km
[I 2025-04-15 20:09:59,074] Trial 23 finished with value: 21.71381187438965 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 2, 'learning_rate': 0.0027479090395656543, 'batch_size': 8, 'weight_decay': 4.544892144107916e-06}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:09:59,224 - INFO - 
Trial 24:
2025-04-15 20:09:59,224 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:09:59,224 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=3
2025-04-15 20:09:59,224 - INFO - Training params: lr=0.0007568837455875826, batch_size=8, weight_decay=2.8834634950449222e-06
2025-04-15 20:09:59,268 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 13/411 [00:00<00:03, 127.33it/s]  7%|▋         | 28/411 [00:00<00:02, 136.70it/s] 10%|█         | 42/411 [00:00<00:02, 134.98it/s] 14%|█▎        | 56/411 [00:00<00:02, 133.51it/s] 17%|█▋        | 70/411 [00:00<00:02, 134.68it/s] 20%|██        | 84/411 [00:00<00:02, 132.31it/s] 24%|██▍       | 98/411 [00:00<00:02, 132.94it/s] 27%|██▋       | 112/411 [00:00<00:02, 128.46it/s] 30%|███       | 125/411 [00:00<00:02, 126.53it/s] 34%|███▎      | 138/411 [00:01<00:02, 125.83it/s] 37%|███▋      | 151/411 [00:01<00:02, 126.45it/s] 40%|███▉      | 164/411 [00:01<00:01, 124.01it/s] 43%|████▎     | 177/411 [00:01<00:01, 123.44it/s] 46%|████▌     | 190/411 [00:01<00:01, 125.17it/s] 50%|████▉     | 204/411 [00:01<00:01, 126.72it/s] 53%|█████▎    | 217/411 [00:01<00:01, 127.56it/s] 56%|█████▌    | 230/411 [00:01<00:01, 126.52it/s] 59%|█████▉    | 244/411 [00:01<00:01, 128.50it/s] 63%|██████▎   | 257/411 [00:02<00:01, 126.80it/s] 66%|██████▌   | 272/411 [00:02<00:01, 132.65it/s] 70%|██████▉   | 286/411 [00:02<00:00, 128.46it/s] 73%|███████▎  | 299/411 [00:02<00:00, 124.58it/s] 76%|███████▌  | 312/411 [00:02<00:00, 123.40it/s] 79%|███████▉  | 325/411 [00:02<00:00, 123.72it/s] 82%|████████▏ | 338/411 [00:02<00:00, 120.05it/s] 85%|████████▌ | 351/411 [00:02<00:00, 117.28it/s] 89%|████████▉ | 365/411 [00:02<00:00, 123.23it/s] 92%|█████████▏| 378/411 [00:02<00:00, 120.42it/s] 95%|█████████▌| 391/411 [00:03<00:00, 120.56it/s] 99%|█████████▊| 405/411 [00:03<00:00, 123.98it/s]100%|██████████| 411/411 [00:03<00:00, 125.97it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▍        | 57/409 [00:00<00:00, 563.51it/s] 28%|██▊       | 114/409 [00:00<00:00, 551.01it/s] 42%|████▏     | 170/409 [00:00<00:00, 458.03it/s] 53%|█████▎    | 218/409 [00:00<00:00, 387.74it/s] 63%|██████▎   | 259/409 [00:00<00:00, 345.17it/s] 72%|███████▏  | 295/409 [00:00<00:00, 289.25it/s] 80%|███████▉  | 326/409 [00:01<00:00, 247.84it/s] 86%|████████▋ | 353/409 [00:01<00:00, 229.97it/s] 92%|█████████▏| 377/409 [00:01<00:00, 218.27it/s] 98%|█████████▊| 401/409 [00:01<00:00, 223.13it/s]100%|██████████| 409/409 [00:01<00:00, 287.38it/s]
2025-04-15 20:10:03,975 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:10:04,045 - INFO - Training GAT model...
2025-04-15 20:10:04,045 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:10:04,458 - INFO - Epoch 1/50, Train Loss: 55.1108, Val Loss: 66.9323
2025-04-15 20:10:04,844 - INFO - Epoch 2/50, Train Loss: 51.8062, Val Loss: 60.3604
2025-04-15 20:10:05,234 - INFO - Epoch 3/50, Train Loss: 46.1571, Val Loss: 54.8435
2025-04-15 20:10:05,628 - INFO - Epoch 4/50, Train Loss: 41.2780, Val Loss: 47.5386
2025-04-15 20:10:06,017 - INFO - Epoch 5/50, Train Loss: 38.1055, Val Loss: 43.2724
2025-04-15 20:10:06,423 - INFO - Epoch 6/50, Train Loss: 35.4138, Val Loss: 40.6685
2025-04-15 20:10:06,810 - INFO - Epoch 7/50, Train Loss: 32.9637, Val Loss: 36.3833
2025-04-15 20:10:07,199 - INFO - Epoch 8/50, Train Loss: 32.0269, Val Loss: 40.2358
2025-04-15 20:10:07,577 - INFO - Epoch 9/50, Train Loss: 30.8617, Val Loss: 35.3409
2025-04-15 20:10:07,954 - INFO - Epoch 10/50, Train Loss: 31.7815, Val Loss: 37.3768
2025-04-15 20:10:08,337 - INFO - Epoch 11/50, Train Loss: 30.1940, Val Loss: 32.1037
2025-04-15 20:10:08,705 - INFO - Epoch 12/50, Train Loss: 29.1939, Val Loss: 36.0725
2025-04-15 20:10:09,086 - INFO - Epoch 13/50, Train Loss: 26.8102, Val Loss: 33.4141
2025-04-15 20:10:09,465 - INFO - Epoch 14/50, Train Loss: 27.5952, Val Loss: 31.6524
2025-04-15 20:10:09,830 - INFO - Epoch 15/50, Train Loss: 26.8024, Val Loss: 32.9264
2025-04-15 20:10:10,207 - INFO - Epoch 16/50, Train Loss: 27.9073, Val Loss: 31.4554
2025-04-15 20:10:10,583 - INFO - Epoch 17/50, Train Loss: 25.7803, Val Loss: 32.9759
2025-04-15 20:10:10,957 - INFO - Epoch 18/50, Train Loss: 26.1299, Val Loss: 30.6471
2025-04-15 20:10:11,346 - INFO - Epoch 19/50, Train Loss: 25.4050, Val Loss: 32.4428
2025-04-15 20:10:11,723 - INFO - Epoch 20/50, Train Loss: 26.9771, Val Loss: 28.6256
2025-04-15 20:10:12,097 - INFO - Epoch 21/50, Train Loss: 25.4205, Val Loss: 31.3248
2025-04-15 20:10:12,470 - INFO - Epoch 22/50, Train Loss: 25.9473, Val Loss: 31.0215
2025-04-15 20:10:12,862 - INFO - Epoch 23/50, Train Loss: 24.4676, Val Loss: 34.0531
2025-04-15 20:10:13,250 - INFO - Epoch 24/50, Train Loss: 24.6920, Val Loss: 31.4653
2025-04-15 20:10:13,626 - INFO - Epoch 25/50, Train Loss: 26.4315, Val Loss: 26.9847
2025-04-15 20:10:14,007 - INFO - Epoch 26/50, Train Loss: 26.7673, Val Loss: 29.6454
2025-04-15 20:10:14,393 - INFO - Epoch 27/50, Train Loss: 24.7387, Val Loss: 30.1346
2025-04-15 20:10:14,774 - INFO - Epoch 28/50, Train Loss: 23.6065, Val Loss: 27.6985
2025-04-15 20:10:15,159 - INFO - Epoch 29/50, Train Loss: 22.1230, Val Loss: 29.1464
2025-04-15 20:10:15,544 - INFO - Epoch 30/50, Train Loss: 23.5381, Val Loss: 29.3204
2025-04-15 20:10:15,922 - INFO - Epoch 31/50, Train Loss: 23.4953, Val Loss: 30.8439
2025-04-15 20:10:16,305 - INFO - Epoch 32/50, Train Loss: 24.4352, Val Loss: 26.8801
2025-04-15 20:10:16,681 - INFO - Epoch 33/50, Train Loss: 22.6048, Val Loss: 27.0489
2025-04-15 20:10:17,056 - INFO - Epoch 34/50, Train Loss: 22.9719, Val Loss: 27.1196
2025-04-15 20:10:17,428 - INFO - Epoch 35/50, Train Loss: 22.8218, Val Loss: 27.1974
2025-04-15 20:10:17,794 - INFO - Epoch 36/50, Train Loss: 22.0379, Val Loss: 28.7019
2025-04-15 20:10:18,173 - INFO - Epoch 37/50, Train Loss: 21.6912, Val Loss: 28.9696
2025-04-15 20:10:18,560 - INFO - Epoch 38/50, Train Loss: 22.9190, Val Loss: 27.1811
2025-04-15 20:10:18,947 - INFO - Epoch 39/50, Train Loss: 22.2826, Val Loss: 27.4461
2025-04-15 20:10:19,346 - INFO - Epoch 40/50, Train Loss: 22.2224, Val Loss: 27.8628
2025-04-15 20:10:19,734 - INFO - Epoch 41/50, Train Loss: 21.7132, Val Loss: 28.5845
2025-04-15 20:10:20,110 - INFO - Epoch 42/50, Train Loss: 21.0757, Val Loss: 29.4740
2025-04-15 20:10:20,110 - INFO - Early stopping at epoch 42. Best epoch: 32
2025-04-15 20:10:20,640 - INFO - Validation metrics - Horizontal: 24.15km, Depth: 8.71km, 3D: 26.88km
[I 2025-04-15 20:10:20,675] Trial 24 finished with value: 24.154870986938477 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 3, 'learning_rate': 0.0007568837455875826, 'batch_size': 8, 'weight_decay': 2.8834634950449222e-06}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:10:20,839 - INFO - 
Trial 25:
2025-04-15 20:10:20,839 - INFO - Graph params: time_window=72, spatial_threshold=150, min_connections=3
2025-04-15 20:10:20,839 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=2
2025-04-15 20:10:20,839 - INFO - Training params: lr=0.0023898798894455117, batch_size=16, weight_decay=1.1448045075275851e-05
2025-04-15 20:10:20,884 - INFO - Creating graphs with time_window=72h, spatial_threshold=150km, min_connections=3...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 72h, spatial threshold: 150km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 134.57it/s]  7%|▋         | 28/411 [00:00<00:02, 136.20it/s] 10%|█         | 42/411 [00:00<00:02, 133.45it/s] 14%|█▎        | 56/411 [00:00<00:02, 133.26it/s] 17%|█▋        | 70/411 [00:00<00:02, 134.60it/s] 20%|██        | 84/411 [00:00<00:02, 131.89it/s] 24%|██▍       | 98/411 [00:00<00:02, 133.40it/s] 27%|██▋       | 112/411 [00:00<00:02, 131.07it/s] 31%|███       | 126/411 [00:00<00:02, 128.94it/s] 34%|███▍      | 139/411 [00:01<00:02, 128.24it/s] 37%|███▋      | 152/411 [00:01<00:02, 127.65it/s] 40%|████      | 165/411 [00:01<00:01, 125.64it/s] 43%|████▎     | 178/411 [00:01<00:01, 124.82it/s] 47%|████▋     | 192/411 [00:01<00:01, 127.91it/s] 50%|████▉     | 205/411 [00:01<00:01, 127.12it/s] 53%|█████▎    | 218/411 [00:01<00:01, 127.95it/s] 56%|█████▌    | 231/411 [00:01<00:01, 127.06it/s] 60%|█████▉    | 245/411 [00:01<00:01, 128.41it/s] 63%|██████▎   | 258/411 [00:01<00:01, 128.62it/s] 66%|██████▋   | 273/411 [00:02<00:01, 132.83it/s] 70%|██████▉   | 287/411 [00:02<00:00, 129.87it/s] 73%|███████▎  | 301/411 [00:02<00:00, 123.46it/s] 76%|███████▋  | 314/411 [00:02<00:00, 123.32it/s] 80%|███████▉  | 328/411 [00:02<00:00, 125.05it/s] 83%|████████▎ | 341/411 [00:02<00:00, 122.09it/s] 86%|████████▌ | 354/411 [00:02<00:00, 120.25it/s] 90%|████████▉ | 369/411 [00:02<00:00, 126.87it/s] 93%|█████████▎| 382/411 [00:02<00:00, 124.54it/s] 96%|█████████▌| 395/411 [00:03<00:00, 125.91it/s]100%|█████████▉| 409/411 [00:03<00:00, 127.97it/s]100%|██████████| 411/411 [00:03<00:00, 127.81it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 15%|█▌        | 62/409 [00:00<00:00, 617.06it/s] 31%|███       | 125/409 [00:00<00:00, 621.75it/s] 46%|████▌     | 188/409 [00:00<00:00, 401.64it/s] 57%|█████▋    | 235/409 [00:00<00:00, 392.76it/s] 68%|██████▊   | 279/409 [00:00<00:00, 336.51it/s] 77%|███████▋  | 316/409 [00:00<00:00, 280.96it/s] 85%|████████▍ | 347/409 [00:01<00:00, 257.27it/s] 92%|█████████▏| 375/409 [00:01<00:00, 251.45it/s] 99%|█████████▊| 403/409 [00:01<00:00, 256.69it/s]100%|██████████| 409/409 [00:01<00:00, 311.73it/s]
2025-04-15 20:10:25,432 - INFO - Created 406 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:10:25,514 - INFO - Training GAT model...
2025-04-15 20:10:25,515 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:10:25,754 - INFO - Epoch 1/50, Train Loss: 66.1807, Val Loss: 77.1287
2025-04-15 20:10:25,993 - INFO - Epoch 2/50, Train Loss: 61.5067, Val Loss: 70.4800
2025-04-15 20:10:26,238 - INFO - Epoch 3/50, Train Loss: 60.6620, Val Loss: 76.7166
2025-04-15 20:10:26,479 - INFO - Epoch 4/50, Train Loss: 59.8306, Val Loss: 67.6761
2025-04-15 20:10:26,717 - INFO - Epoch 5/50, Train Loss: 57.6083, Val Loss: 66.5021
2025-04-15 20:10:26,960 - INFO - Epoch 6/50, Train Loss: 55.0121, Val Loss: 62.4620
2025-04-15 20:10:27,210 - INFO - Epoch 7/50, Train Loss: 55.1575, Val Loss: 59.8847
2025-04-15 20:10:27,449 - INFO - Epoch 8/50, Train Loss: 54.4879, Val Loss: 57.4630
2025-04-15 20:10:27,690 - INFO - Epoch 9/50, Train Loss: 53.5990, Val Loss: 56.9337
2025-04-15 20:10:27,933 - INFO - Epoch 10/50, Train Loss: 50.6990, Val Loss: 57.7791
2025-04-15 20:10:28,174 - INFO - Epoch 11/50, Train Loss: 51.1326, Val Loss: 54.8866
2025-04-15 20:10:28,420 - INFO - Epoch 12/50, Train Loss: 49.9762, Val Loss: 54.7785
2025-04-15 20:10:28,660 - INFO - Epoch 13/50, Train Loss: 50.8054, Val Loss: 54.2100
2025-04-15 20:10:28,894 - INFO - Epoch 14/50, Train Loss: 51.6336, Val Loss: 63.8203
2025-04-15 20:10:29,141 - INFO - Epoch 15/50, Train Loss: 51.2835, Val Loss: 61.8616
2025-04-15 20:10:29,385 - INFO - Epoch 16/50, Train Loss: 51.8932, Val Loss: 55.2762
2025-04-15 20:10:29,623 - INFO - Epoch 17/50, Train Loss: 49.1924, Val Loss: 54.6197
2025-04-15 20:10:29,867 - INFO - Epoch 18/50, Train Loss: 47.8571, Val Loss: 51.3798
2025-04-15 20:10:30,106 - INFO - Epoch 19/50, Train Loss: 49.0456, Val Loss: 58.4688
2025-04-15 20:10:30,351 - INFO - Epoch 20/50, Train Loss: 48.3254, Val Loss: 51.3557
2025-04-15 20:10:30,595 - INFO - Epoch 21/50, Train Loss: 50.1055, Val Loss: 51.0399
2025-04-15 20:10:30,833 - INFO - Epoch 22/50, Train Loss: 46.3780, Val Loss: 60.2119
2025-04-15 20:10:31,078 - INFO - Epoch 23/50, Train Loss: 51.0121, Val Loss: 59.1008
2025-04-15 20:10:31,323 - INFO - Epoch 24/50, Train Loss: 50.0733, Val Loss: 52.8938
2025-04-15 20:10:31,564 - INFO - Epoch 25/50, Train Loss: 48.5382, Val Loss: 58.6976
2025-04-15 20:10:31,812 - INFO - Epoch 26/50, Train Loss: 46.8236, Val Loss: 55.0507
2025-04-15 20:10:32,051 - INFO - Epoch 27/50, Train Loss: 45.0014, Val Loss: 57.0325
2025-04-15 20:10:32,304 - INFO - Epoch 28/50, Train Loss: 45.3824, Val Loss: 54.9131
2025-04-15 20:10:32,543 - INFO - Epoch 29/50, Train Loss: 44.4207, Val Loss: 53.5221
2025-04-15 20:10:32,782 - INFO - Epoch 30/50, Train Loss: 44.8482, Val Loss: 54.5174
2025-04-15 20:10:33,028 - INFO - Epoch 31/50, Train Loss: 43.5315, Val Loss: 51.1373
2025-04-15 20:10:33,029 - INFO - Early stopping at epoch 31. Best epoch: 21
2025-04-15 20:10:33,566 - INFO - Validation metrics - Horizontal: 48.20km, Depth: 13.76km, 3D: 51.04km
[I 2025-04-15 20:10:33,601] Trial 25 finished with value: 48.204227447509766 and parameters: {'time_window': 72, 'spatial_threshold': 150, 'min_connections': 3, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 2, 'learning_rate': 0.0023898798894455117, 'batch_size': 16, 'weight_decay': 1.1448045075275851e-05}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:10:33,759 - INFO - 
Trial 26:
2025-04-15 20:10:33,759 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=2
2025-04-15 20:10:33,759 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=3
2025-04-15 20:10:33,759 - INFO - Training params: lr=0.001195539292630013, batch_size=8, weight_decay=0.0009270568214639467
2025-04-15 20:10:33,804 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=2...
Created 406 causal graphs
First graph has 4 nodes and 3 edges
Chronological split - Train: 284, Val: 61, Test: 61 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 134.56it/s]  7%|▋         | 28/411 [00:00<00:02, 137.63it/s] 10%|█         | 42/411 [00:00<00:02, 135.02it/s] 14%|█▎        | 56/411 [00:00<00:02, 134.00it/s] 17%|█▋        | 70/411 [00:00<00:02, 133.59it/s] 20%|██        | 84/411 [00:00<00:02, 130.93it/s] 24%|██▍       | 98/411 [00:00<00:02, 131.30it/s] 27%|██▋       | 112/411 [00:00<00:02, 129.98it/s] 31%|███       | 126/411 [00:00<00:02, 128.29it/s] 34%|███▍      | 139/411 [00:01<00:02, 127.38it/s] 37%|███▋      | 152/411 [00:01<00:02, 127.59it/s] 40%|████      | 165/411 [00:01<00:01, 125.82it/s] 43%|████▎     | 178/411 [00:01<00:01, 125.41it/s] 47%|████▋     | 192/411 [00:01<00:01, 127.23it/s] 50%|████▉     | 205/411 [00:01<00:01, 127.27it/s] 53%|█████▎    | 218/411 [00:01<00:01, 127.85it/s] 56%|█████▌    | 231/411 [00:01<00:01, 127.64it/s] 60%|█████▉    | 245/411 [00:01<00:01, 129.69it/s] 63%|██████▎   | 259/411 [00:02<00:01, 129.62it/s] 67%|██████▋   | 274/411 [00:02<00:01, 133.48it/s] 70%|███████   | 288/411 [00:02<00:00, 133.56it/s] 73%|███████▎  | 302/411 [00:02<00:00, 125.49it/s] 77%|███████▋  | 315/411 [00:02<00:00, 125.77it/s] 80%|███████▉  | 328/411 [00:02<00:00, 126.57it/s] 83%|████████▎ | 341/411 [00:02<00:00, 123.40it/s] 86%|████████▌ | 354/411 [00:02<00:00, 120.87it/s] 90%|████████▉ | 369/411 [00:02<00:00, 127.04it/s] 93%|█████████▎| 382/411 [00:02<00:00, 125.08it/s] 96%|█████████▌| 395/411 [00:03<00:00, 125.89it/s]100%|█████████▉| 409/411 [00:03<00:00, 127.79it/s]100%|██████████| 411/411 [00:03<00:00, 128.20it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 558.98it/s] 27%|██▋       | 112/409 [00:00<00:00, 540.14it/s] 41%|████      | 167/409 [00:00<00:00, 458.67it/s] 53%|█████▎    | 215/409 [00:00<00:00, 383.65it/s] 63%|██████▎   | 256/409 [00:00<00:00, 345.46it/s] 71%|███████▏  | 292/409 [00:00<00:00, 291.03it/s] 79%|███████▉  | 323/409 [00:01<00:00, 248.87it/s] 86%|████████▌ | 350/409 [00:01<00:00, 229.10it/s] 91%|█████████▏| 374/409 [00:01<00:00, 223.36it/s] 97%|█████████▋| 398/409 [00:01<00:00, 225.98it/s]100%|██████████| 409/409 [00:01<00:00, 287.96it/s]
2025-04-15 20:10:38,451 - INFO - Created 388 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:10:38,531 - INFO - Training GAT model...
2025-04-15 20:10:38,531 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:10:38,950 - INFO - Epoch 1/50, Train Loss: 61.6306, Val Loss: 70.6387
2025-04-15 20:10:39,358 - INFO - Epoch 2/50, Train Loss: 53.8999, Val Loss: 60.7980
2025-04-15 20:10:39,753 - INFO - Epoch 3/50, Train Loss: 46.7511, Val Loss: 47.0721
2025-04-15 20:10:40,153 - INFO - Epoch 4/50, Train Loss: 44.8453, Val Loss: 45.6790
2025-04-15 20:10:40,559 - INFO - Epoch 5/50, Train Loss: 41.0830, Val Loss: 41.9074
2025-04-15 20:10:40,960 - INFO - Epoch 6/50, Train Loss: 38.6929, Val Loss: 38.5851
2025-04-15 20:10:41,373 - INFO - Epoch 7/50, Train Loss: 35.1677, Val Loss: 35.8194
2025-04-15 20:10:41,775 - INFO - Epoch 8/50, Train Loss: 34.8810, Val Loss: 30.9865
2025-04-15 20:10:42,174 - INFO - Epoch 9/50, Train Loss: 32.4935, Val Loss: 32.3832
2025-04-15 20:10:42,575 - INFO - Epoch 10/50, Train Loss: 30.7172, Val Loss: 32.8018
2025-04-15 20:10:42,985 - INFO - Epoch 11/50, Train Loss: 30.6852, Val Loss: 30.2170
2025-04-15 20:10:43,404 - INFO - Epoch 12/50, Train Loss: 29.1975, Val Loss: 27.9079
2025-04-15 20:10:43,804 - INFO - Epoch 13/50, Train Loss: 29.3969, Val Loss: 25.3630
2025-04-15 20:10:44,209 - INFO - Epoch 14/50, Train Loss: 28.1246, Val Loss: 28.2065
2025-04-15 20:10:44,611 - INFO - Epoch 15/50, Train Loss: 29.4837, Val Loss: 29.8525
2025-04-15 20:10:45,030 - INFO - Epoch 16/50, Train Loss: 26.7778, Val Loss: 26.1496
2025-04-15 20:10:45,445 - INFO - Epoch 17/50, Train Loss: 27.0511, Val Loss: 27.4987
2025-04-15 20:10:45,840 - INFO - Epoch 18/50, Train Loss: 27.1676, Val Loss: 28.3883
2025-04-15 20:10:46,258 - INFO - Epoch 19/50, Train Loss: 26.2103, Val Loss: 24.4749
2025-04-15 20:10:46,693 - INFO - Epoch 20/50, Train Loss: 25.7442, Val Loss: 26.5430
2025-04-15 20:10:47,112 - INFO - Epoch 21/50, Train Loss: 27.1965, Val Loss: 26.5033
2025-04-15 20:10:47,536 - INFO - Epoch 22/50, Train Loss: 25.8642, Val Loss: 26.9069
2025-04-15 20:10:47,942 - INFO - Epoch 23/50, Train Loss: 27.5179, Val Loss: 25.0385
2025-04-15 20:10:48,352 - INFO - Epoch 24/50, Train Loss: 26.0852, Val Loss: 28.9119
2025-04-15 20:10:48,748 - INFO - Epoch 25/50, Train Loss: 25.9922, Val Loss: 29.2228
2025-04-15 20:10:49,168 - INFO - Epoch 26/50, Train Loss: 26.4615, Val Loss: 23.9337
2025-04-15 20:10:49,573 - INFO - Epoch 27/50, Train Loss: 24.4299, Val Loss: 26.7674
2025-04-15 20:10:49,966 - INFO - Epoch 28/50, Train Loss: 24.5513, Val Loss: 26.9588
2025-04-15 20:10:50,378 - INFO - Epoch 29/50, Train Loss: 24.8087, Val Loss: 24.9607
2025-04-15 20:10:50,777 - INFO - Epoch 30/50, Train Loss: 24.9586, Val Loss: 24.4726
2025-04-15 20:10:51,181 - INFO - Epoch 31/50, Train Loss: 23.8697, Val Loss: 28.1426
2025-04-15 20:10:51,586 - INFO - Epoch 32/50, Train Loss: 23.9591, Val Loss: 24.2046
2025-04-15 20:10:51,980 - INFO - Epoch 33/50, Train Loss: 22.9125, Val Loss: 27.3410
2025-04-15 20:10:52,384 - INFO - Epoch 34/50, Train Loss: 23.5532, Val Loss: 26.4636
2025-04-15 20:10:52,785 - INFO - Epoch 35/50, Train Loss: 23.5300, Val Loss: 26.3186
2025-04-15 20:10:53,204 - INFO - Epoch 36/50, Train Loss: 23.0645, Val Loss: 25.4519
2025-04-15 20:10:53,204 - INFO - Early stopping at epoch 36. Best epoch: 26
2025-04-15 20:10:53,744 - INFO - Validation metrics - Horizontal: 20.91km, Depth: 8.14km, 3D: 23.93km
[I 2025-04-15 20:10:53,777] Trial 26 finished with value: 20.905805587768555 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 3, 'learning_rate': 0.001195539292630013, 'batch_size': 8, 'weight_decay': 0.0009270568214639467}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:10:53,921 - INFO - 
Trial 27:
2025-04-15 20:10:53,921 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:10:53,921 - INFO - Model params: gnn_type=gat, hidden_dim=128, num_layers=2
2025-04-15 20:10:53,921 - INFO - Training params: lr=0.007066918004600657, batch_size=8, weight_decay=5.782097991334961e-06
2025-04-15 20:10:53,965 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 388 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 271, Val: 58, Test: 59 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 137.77it/s]  7%|▋         | 29/411 [00:00<00:02, 139.84it/s] 10%|█         | 43/411 [00:00<00:02, 139.84it/s] 14%|█▍        | 57/411 [00:00<00:02, 136.44it/s] 18%|█▊        | 72/411 [00:00<00:02, 137.72it/s] 21%|██        | 86/411 [00:00<00:02, 137.53it/s] 24%|██▍       | 100/411 [00:00<00:02, 137.69it/s] 28%|██▊       | 114/411 [00:00<00:02, 134.45it/s] 31%|███       | 128/411 [00:00<00:02, 132.36it/s] 35%|███▍      | 142/411 [00:01<00:02, 130.49it/s] 38%|███▊      | 156/411 [00:01<00:01, 130.12it/s] 41%|████▏     | 170/411 [00:01<00:01, 128.03it/s] 45%|████▍     | 184/411 [00:01<00:01, 129.20it/s] 48%|████▊     | 198/411 [00:01<00:01, 131.86it/s] 52%|█████▏    | 212/411 [00:01<00:01, 130.15it/s] 55%|█████▍    | 226/411 [00:01<00:01, 130.62it/s] 58%|█████▊    | 240/411 [00:01<00:01, 132.24it/s] 62%|██████▏   | 254/411 [00:01<00:01, 131.74it/s] 65%|██████▌   | 269/411 [00:02<00:01, 135.08it/s] 69%|██████▉   | 283/411 [00:02<00:00, 134.35it/s] 72%|███████▏  | 297/411 [00:02<00:00, 133.02it/s] 76%|███████▌  | 311/411 [00:02<00:00, 128.78it/s] 79%|███████▉  | 325/411 [00:02<00:00, 130.10it/s] 82%|████████▏ | 339/411 [00:02<00:00, 125.67it/s] 86%|████████▌ | 352/411 [00:02<00:00, 123.76it/s] 89%|████████▉ | 367/411 [00:02<00:00, 130.51it/s] 93%|█████████▎| 381/411 [00:02<00:00, 127.38it/s] 96%|█████████▌| 395/411 [00:03<00:00, 128.40it/s]100%|█████████▉| 409/411 [00:03<00:00, 130.41it/s]100%|██████████| 411/411 [00:03<00:00, 131.48it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▍        | 57/409 [00:00<00:00, 560.51it/s] 28%|██▊       | 114/409 [00:00<00:00, 548.42it/s] 41%|████▏     | 169/409 [00:00<00:00, 459.14it/s] 53%|█████▎    | 217/409 [00:00<00:00, 386.62it/s] 63%|██████▎   | 258/409 [00:00<00:00, 345.24it/s] 72%|███████▏  | 294/409 [00:00<00:00, 289.59it/s] 79%|███████▉  | 325/409 [00:01<00:00, 247.29it/s] 86%|████████▌ | 352/409 [00:01<00:00, 228.71it/s] 92%|█████████▏| 376/409 [00:01<00:00, 223.83it/s] 98%|█████████▊| 400/409 [00:01<00:00, 226.97it/s]100%|██████████| 409/409 [00:01<00:00, 289.08it/s]
2025-04-15 20:10:58,527 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:10:58,598 - INFO - Training GAT model...
2025-04-15 20:10:58,598 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:10:58,872 - INFO - Epoch 1/50, Train Loss: 49.8124, Val Loss: 59.0253
2025-04-15 20:10:59,153 - INFO - Epoch 2/50, Train Loss: 44.2621, Val Loss: 46.2712
2025-04-15 20:10:59,479 - INFO - Epoch 3/50, Train Loss: 46.5454, Val Loss: 61.1510
2025-04-15 20:10:59,865 - INFO - Epoch 4/50, Train Loss: 43.1468, Val Loss: 50.1908
2025-04-15 20:11:00,246 - INFO - Epoch 5/50, Train Loss: 40.5562, Val Loss: 41.7692
2025-04-15 20:11:00,634 - INFO - Epoch 6/50, Train Loss: 38.1944, Val Loss: 42.6295
2025-04-15 20:11:01,030 - INFO - Epoch 7/50, Train Loss: 37.9992, Val Loss: 43.0581
2025-04-15 20:11:01,412 - INFO - Epoch 8/50, Train Loss: 37.5703, Val Loss: 43.8648
2025-04-15 20:11:01,804 - INFO - Epoch 9/50, Train Loss: 35.5450, Val Loss: 46.2443
2025-04-15 20:11:02,174 - INFO - Epoch 10/50, Train Loss: 35.6278, Val Loss: 36.4928
2025-04-15 20:11:02,584 - INFO - Epoch 11/50, Train Loss: 34.3796, Val Loss: 35.2037
2025-04-15 20:11:02,960 - INFO - Epoch 12/50, Train Loss: 36.3099, Val Loss: 40.1608
2025-04-15 20:11:03,340 - INFO - Epoch 13/50, Train Loss: 34.2647, Val Loss: 33.6221
2025-04-15 20:11:03,725 - INFO - Epoch 14/50, Train Loss: 33.8885, Val Loss: 35.7282
2025-04-15 20:11:04,102 - INFO - Epoch 15/50, Train Loss: 34.8063, Val Loss: 39.7952
2025-04-15 20:11:04,492 - INFO - Epoch 16/50, Train Loss: 32.7641, Val Loss: 32.9573
2025-04-15 20:11:04,857 - INFO - Epoch 17/50, Train Loss: 32.1313, Val Loss: 35.0911
2025-04-15 20:11:05,220 - INFO - Epoch 18/50, Train Loss: 32.8483, Val Loss: 37.1297
2025-04-15 20:11:05,598 - INFO - Epoch 19/50, Train Loss: 34.1227, Val Loss: 41.5511
2025-04-15 20:11:05,966 - INFO - Epoch 20/50, Train Loss: 34.2729, Val Loss: 38.9441
2025-04-15 20:11:06,351 - INFO - Epoch 21/50, Train Loss: 33.9332, Val Loss: 33.1441
2025-04-15 20:11:06,718 - INFO - Epoch 22/50, Train Loss: 32.5510, Val Loss: 30.7895
2025-04-15 20:11:07,095 - INFO - Epoch 23/50, Train Loss: 33.7104, Val Loss: 33.0987
2025-04-15 20:11:07,457 - INFO - Epoch 24/50, Train Loss: 33.7216, Val Loss: 33.5417
2025-04-15 20:11:07,827 - INFO - Epoch 25/50, Train Loss: 33.8743, Val Loss: 33.4475
2025-04-15 20:11:08,201 - INFO - Epoch 26/50, Train Loss: 32.6451, Val Loss: 32.8148
2025-04-15 20:11:08,565 - INFO - Epoch 27/50, Train Loss: 34.6390, Val Loss: 37.5431
2025-04-15 20:11:08,926 - INFO - Epoch 28/50, Train Loss: 34.7487, Val Loss: 38.7868
2025-04-15 20:11:09,299 - INFO - Epoch 29/50, Train Loss: 33.9897, Val Loss: 39.6481
2025-04-15 20:11:09,668 - INFO - Epoch 30/50, Train Loss: 32.4412, Val Loss: 37.7585
2025-04-15 20:11:10,028 - INFO - Epoch 31/50, Train Loss: 33.7426, Val Loss: 35.8196
2025-04-15 20:11:10,400 - INFO - Epoch 32/50, Train Loss: 33.1897, Val Loss: 33.6218
2025-04-15 20:11:10,401 - INFO - Early stopping at epoch 32. Best epoch: 22
2025-04-15 20:11:10,947 - INFO - Validation metrics - Horizontal: 28.80km, Depth: 7.55km, 3D: 30.79km
[I 2025-04-15 20:11:10,980] Trial 27 finished with value: 28.799522399902344 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 128, 'num_layers': 2, 'learning_rate': 0.007066918004600657, 'batch_size': 8, 'weight_decay': 5.782097991334961e-06}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:11:11,148 - INFO - 
Trial 28:
2025-04-15 20:11:11,148 - INFO - Graph params: time_window=120, spatial_threshold=75, min_connections=5
2025-04-15 20:11:11,148 - INFO - Model params: gnn_type=gat, hidden_dim=64, num_layers=3
2025-04-15 20:11:11,148 - INFO - Training params: lr=0.00035327259938684437, batch_size=16, weight_decay=2.201456056842808e-05
2025-04-15 20:11:11,193 - INFO - Creating graphs with time_window=120h, spatial_threshold=75km, min_connections=5...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 137.09it/s]  7%|▋         | 29/411 [00:00<00:02, 139.54it/s] 10%|█         | 43/411 [00:00<00:02, 139.48it/s] 14%|█▍        | 57/411 [00:00<00:02, 136.32it/s] 18%|█▊        | 72/411 [00:00<00:02, 137.13it/s] 21%|██        | 86/411 [00:00<00:02, 136.63it/s] 24%|██▍       | 100/411 [00:00<00:02, 136.92it/s] 28%|██▊       | 114/411 [00:00<00:02, 134.26it/s] 31%|███       | 128/411 [00:00<00:02, 131.84it/s] 35%|███▍      | 142/411 [00:01<00:02, 130.01it/s] 38%|███▊      | 156/411 [00:01<00:01, 129.44it/s] 41%|████      | 169/411 [00:01<00:01, 127.55it/s] 45%|████▍     | 183/411 [00:01<00:01, 128.81it/s] 48%|████▊     | 197/411 [00:01<00:01, 130.91it/s] 51%|█████▏    | 211/411 [00:01<00:01, 130.26it/s] 55%|█████▍    | 225/411 [00:01<00:01, 129.33it/s] 58%|█████▊    | 239/411 [00:01<00:01, 129.86it/s] 61%|██████▏   | 252/411 [00:01<00:01, 129.58it/s] 65%|██████▍   | 267/411 [00:02<00:01, 133.47it/s] 68%|██████▊   | 281/411 [00:02<00:00, 134.56it/s] 72%|███████▏  | 295/411 [00:02<00:00, 133.13it/s] 75%|███████▌  | 309/411 [00:02<00:00, 129.69it/s] 78%|███████▊  | 322/411 [00:02<00:00, 128.43it/s] 82%|████████▏ | 335/411 [00:02<00:00, 127.66it/s] 85%|████████▍ | 348/411 [00:02<00:00, 125.21it/s] 88%|████████▊ | 362/411 [00:02<00:00, 129.42it/s] 91%|█████████ | 375/411 [00:02<00:00, 128.34it/s] 94%|█████████▍| 388/411 [00:02<00:00, 127.90it/s] 98%|█████████▊| 402/411 [00:03<00:00, 130.87it/s]100%|██████████| 411/411 [00:03<00:00, 131.04it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▎        | 56/409 [00:00<00:00, 559.70it/s] 27%|██▋       | 112/409 [00:00<00:00, 546.12it/s] 41%|████      | 167/409 [00:00<00:00, 464.58it/s] 53%|█████▎    | 215/409 [00:00<00:00, 386.10it/s] 63%|██████▎   | 256/409 [00:00<00:00, 345.86it/s] 72%|███████▏  | 293/409 [00:00<00:00, 289.78it/s] 79%|███████▉  | 324/409 [00:01<00:00, 248.39it/s] 86%|████████▌ | 351/409 [00:01<00:00, 229.32it/s] 92%|█████████▏| 375/409 [00:01<00:00, 223.84it/s] 98%|█████████▊| 399/409 [00:01<00:00, 226.66it/s]100%|██████████| 409/409 [00:01<00:00, 288.63it/s]
2025-04-15 20:11:15,768 - INFO - Created 335 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:11:15,836 - INFO - Training GAT model...
2025-04-15 20:11:15,836 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:11:16,026 - INFO - Epoch 1/50, Train Loss: 55.9472, Val Loss: 70.5740
2025-04-15 20:11:16,219 - INFO - Epoch 2/50, Train Loss: 55.6853, Val Loss: 70.1496
2025-04-15 20:11:16,408 - INFO - Epoch 3/50, Train Loss: 55.3922, Val Loss: 69.5837
2025-04-15 20:11:16,607 - INFO - Epoch 4/50, Train Loss: 55.0369, Val Loss: 68.8970
2025-04-15 20:11:16,802 - INFO - Epoch 5/50, Train Loss: 54.5367, Val Loss: 68.1381
2025-04-15 20:11:16,987 - INFO - Epoch 6/50, Train Loss: 53.9816, Val Loss: 67.2585
2025-04-15 20:11:17,181 - INFO - Epoch 7/50, Train Loss: 53.1888, Val Loss: 66.2591
2025-04-15 20:11:17,379 - INFO - Epoch 8/50, Train Loss: 52.4266, Val Loss: 65.1877
2025-04-15 20:11:17,573 - INFO - Epoch 9/50, Train Loss: 51.7143, Val Loss: 64.1444
2025-04-15 20:11:17,764 - INFO - Epoch 10/50, Train Loss: 50.7682, Val Loss: 63.0448
2025-04-15 20:11:17,960 - INFO - Epoch 11/50, Train Loss: 49.8599, Val Loss: 61.8786
2025-04-15 20:11:18,153 - INFO - Epoch 12/50, Train Loss: 49.0655, Val Loss: 60.6332
2025-04-15 20:11:18,357 - INFO - Epoch 13/50, Train Loss: 48.0143, Val Loss: 59.4797
2025-04-15 20:11:18,557 - INFO - Epoch 14/50, Train Loss: 46.8617, Val Loss: 58.2509
2025-04-15 20:11:18,767 - INFO - Epoch 15/50, Train Loss: 46.1586, Val Loss: 57.0522
2025-04-15 20:11:18,970 - INFO - Epoch 16/50, Train Loss: 45.1590, Val Loss: 55.8140
2025-04-15 20:11:19,170 - INFO - Epoch 17/50, Train Loss: 43.9946, Val Loss: 54.5950
2025-04-15 20:11:19,362 - INFO - Epoch 18/50, Train Loss: 43.1953, Val Loss: 53.7644
2025-04-15 20:11:19,550 - INFO - Epoch 19/50, Train Loss: 42.0258, Val Loss: 52.5634
2025-04-15 20:11:19,740 - INFO - Epoch 20/50, Train Loss: 41.4430, Val Loss: 51.1893
2025-04-15 20:11:19,924 - INFO - Epoch 21/50, Train Loss: 41.0233, Val Loss: 49.9141
2025-04-15 20:11:20,113 - INFO - Epoch 22/50, Train Loss: 39.6174, Val Loss: 49.3667
2025-04-15 20:11:20,303 - INFO - Epoch 23/50, Train Loss: 38.8017, Val Loss: 48.4892
2025-04-15 20:11:20,489 - INFO - Epoch 24/50, Train Loss: 38.2527, Val Loss: 47.0716
2025-04-15 20:11:20,676 - INFO - Epoch 25/50, Train Loss: 37.0982, Val Loss: 46.0780
2025-04-15 20:11:20,862 - INFO - Epoch 26/50, Train Loss: 36.4834, Val Loss: 44.6551
2025-04-15 20:11:21,050 - INFO - Epoch 27/50, Train Loss: 35.7705, Val Loss: 44.6107
2025-04-15 20:11:21,240 - INFO - Epoch 28/50, Train Loss: 35.4929, Val Loss: 43.8116
2025-04-15 20:11:21,427 - INFO - Epoch 29/50, Train Loss: 34.4553, Val Loss: 42.9554
2025-04-15 20:11:21,613 - INFO - Epoch 30/50, Train Loss: 34.5183, Val Loss: 42.0976
2025-04-15 20:11:21,798 - INFO - Epoch 31/50, Train Loss: 32.6777, Val Loss: 40.9209
2025-04-15 20:11:21,982 - INFO - Epoch 32/50, Train Loss: 32.7588, Val Loss: 40.5427
2025-04-15 20:11:22,169 - INFO - Epoch 33/50, Train Loss: 32.5708, Val Loss: 40.7421
2025-04-15 20:11:22,354 - INFO - Epoch 34/50, Train Loss: 33.0227, Val Loss: 39.5589
2025-04-15 20:11:22,537 - INFO - Epoch 35/50, Train Loss: 31.2839, Val Loss: 39.7668
2025-04-15 20:11:22,729 - INFO - Epoch 36/50, Train Loss: 30.8697, Val Loss: 39.8171
2025-04-15 20:11:22,922 - INFO - Epoch 37/50, Train Loss: 31.4701, Val Loss: 39.1774
2025-04-15 20:11:23,118 - INFO - Epoch 38/50, Train Loss: 30.0385, Val Loss: 38.1870
2025-04-15 20:11:23,305 - INFO - Epoch 39/50, Train Loss: 29.8636, Val Loss: 38.2064
2025-04-15 20:11:23,488 - INFO - Epoch 40/50, Train Loss: 29.3243, Val Loss: 37.9945
2025-04-15 20:11:23,671 - INFO - Epoch 41/50, Train Loss: 28.7171, Val Loss: 37.9722
2025-04-15 20:11:23,855 - INFO - Epoch 42/50, Train Loss: 29.6318, Val Loss: 37.1679
2025-04-15 20:11:24,035 - INFO - Epoch 43/50, Train Loss: 28.5716, Val Loss: 37.1808
2025-04-15 20:11:24,221 - INFO - Epoch 44/50, Train Loss: 28.8327, Val Loss: 36.6736
2025-04-15 20:11:24,411 - INFO - Epoch 45/50, Train Loss: 28.4047, Val Loss: 35.8166
2025-04-15 20:11:24,596 - INFO - Epoch 46/50, Train Loss: 28.9219, Val Loss: 34.6801
2025-04-15 20:11:24,778 - INFO - Epoch 47/50, Train Loss: 29.6565, Val Loss: 34.9066
2025-04-15 20:11:24,959 - INFO - Epoch 48/50, Train Loss: 27.6222, Val Loss: 35.3818
2025-04-15 20:11:25,146 - INFO - Epoch 49/50, Train Loss: 29.0658, Val Loss: 34.7333
2025-04-15 20:11:25,335 - INFO - Epoch 50/50, Train Loss: 28.0802, Val Loss: 34.6299
2025-04-15 20:11:25,847 - INFO - Validation metrics - Horizontal: 32.82km, Depth: 9.81km, 3D: 34.63km
[I 2025-04-15 20:11:25,881] Trial 28 finished with value: 32.815773010253906 and parameters: {'time_window': 120, 'spatial_threshold': 75, 'min_connections': 5, 'gnn_type': 'gat', 'hidden_dim': 64, 'num_layers': 3, 'learning_rate': 0.00035327259938684437, 'batch_size': 16, 'weight_decay': 2.201456056842808e-05}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:11:26,061 - INFO - 
Trial 29:
2025-04-15 20:11:26,061 - INFO - Graph params: time_window=336, spatial_threshold=50, min_connections=2
2025-04-15 20:11:26,061 - INFO - Model params: gnn_type=gat, hidden_dim=256, num_layers=5
2025-04-15 20:11:26,061 - INFO - Training params: lr=0.0007860825720974972, batch_size=32, weight_decay=5.0990973178530225e-05
2025-04-15 20:11:26,106 - INFO - Creating graphs with time_window=336h, spatial_threshold=50km, min_connections=2...
Created 335 causal graphs
First graph has 6 nodes and 5 edges
Chronological split - Train: 234, Val: 50, Test: 51 graphs
Creating causal relative spatiotemporal graphs (time window: 336h, spatial threshold: 50km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 136.39it/s]  7%|▋         | 29/411 [00:00<00:02, 138.80it/s] 10%|█         | 43/411 [00:00<00:02, 138.70it/s] 14%|█▍        | 57/411 [00:00<00:02, 135.21it/s] 17%|█▋        | 71/411 [00:00<00:02, 136.25it/s] 21%|██        | 85/411 [00:00<00:02, 133.96it/s] 24%|██▍       | 100/411 [00:00<00:02, 135.40it/s] 28%|██▊       | 114/411 [00:00<00:02, 132.30it/s] 31%|███       | 128/411 [00:00<00:02, 129.64it/s] 34%|███▍      | 141/411 [00:01<00:02, 127.78it/s] 37%|███▋      | 154/411 [00:01<00:02, 127.32it/s] 41%|████      | 167/411 [00:01<00:01, 125.80it/s] 44%|████▍     | 181/411 [00:01<00:01, 127.41it/s] 47%|████▋     | 195/411 [00:01<00:01, 127.68it/s] 51%|█████     | 209/411 [00:01<00:01, 130.27it/s] 54%|█████▍    | 223/411 [00:01<00:01, 127.38it/s] 58%|█████▊    | 237/411 [00:01<00:01, 128.89it/s] 61%|██████    | 250/411 [00:01<00:01, 128.94it/s] 64%|██████▍   | 265/411 [00:02<00:01, 132.75it/s] 68%|██████▊   | 279/411 [00:02<00:01, 130.82it/s] 71%|███████▏  | 293/411 [00:02<00:00, 132.24it/s] 75%|███████▍  | 307/411 [00:02<00:00, 127.24it/s] 78%|███████▊  | 320/411 [00:02<00:00, 127.25it/s] 81%|████████  | 333/411 [00:02<00:00, 125.90it/s] 84%|████████▍ | 346/411 [00:02<00:00, 123.92it/s] 87%|████████▋ | 359/411 [00:02<00:00, 123.81it/s] 91%|█████████ | 373/411 [00:02<00:00, 126.40it/s] 94%|█████████▍| 386/411 [00:02<00:00, 125.61it/s] 97%|█████████▋| 400/411 [00:03<00:00, 128.37it/s]100%|██████████| 411/411 [00:03<00:00, 129.25it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 13%|█▎        | 55/409 [00:00<00:00, 537.30it/s] 27%|██▋       | 109/409 [00:00<00:00, 322.98it/s] 36%|███▌      | 146/409 [00:00<00:00, 313.61it/s] 44%|████▍     | 180/409 [00:00<00:00, 271.74it/s] 51%|█████     | 209/409 [00:00<00:00, 239.60it/s] 57%|█████▋    | 235/409 [00:00<00:00, 211.38it/s] 63%|██████▎   | 257/409 [00:01<00:00, 190.96it/s] 68%|██████▊   | 277/409 [00:01<00:00, 182.02it/s] 72%|███████▏  | 296/409 [00:01<00:00, 172.26it/s] 77%|███████▋  | 314/409 [00:01<00:00, 161.91it/s] 81%|████████  | 331/409 [00:01<00:00, 149.33it/s] 85%|████████▍ | 346/409 [00:01<00:00, 139.98it/s] 88%|████████▊ | 360/409 [00:01<00:00, 130.91it/s] 91%|█████████▏| 374/409 [00:01<00:00, 123.15it/s] 95%|█████████▍| 387/409 [00:02<00:00, 119.26it/s] 98%|█████████▊| 399/409 [00:02<00:00, 117.80it/s]100%|██████████| 409/409 [00:02<00:00, 177.54it/s]
2025-04-15 20:11:31,610 - INFO - Created 389 graphs, proceeding with model training
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/kalvisuser/miniconda3/envs/gnn/lib/python3.11/site-packages/torch_geometric/deprecation.py:26: UserWarning: 'data.DataLoader' is deprecated, use 'loader.DataLoader' instead
  warnings.warn(out)
2025-04-15 20:11:31,702 - INFO - Training GAT model...
2025-04-15 20:11:31,702 - INFO - Training Causal Relative GNN model (gat) for 50 epochs...
2025-04-15 20:11:32,563 - INFO - Epoch 1/50, Train Loss: 63.0658, Val Loss: 71.9803
2025-04-15 20:11:33,407 - INFO - Epoch 2/50, Train Loss: 58.5391, Val Loss: 66.5339
2025-04-15 20:11:34,251 - INFO - Epoch 3/50, Train Loss: 53.3557, Val Loss: 59.9112
2025-04-15 20:11:35,115 - INFO - Epoch 4/50, Train Loss: 48.1909, Val Loss: 55.0467
2025-04-15 20:11:35,978 - INFO - Epoch 5/50, Train Loss: 44.6352, Val Loss: 48.0559
2025-04-15 20:11:36,828 - INFO - Epoch 6/50, Train Loss: 41.1535, Val Loss: 44.2034
2025-04-15 20:11:37,692 - INFO - Epoch 7/50, Train Loss: 37.1586, Val Loss: 41.0122
2025-04-15 20:11:38,550 - INFO - Epoch 8/50, Train Loss: 35.8051, Val Loss: 38.8037
2025-04-15 20:11:39,423 - INFO - Epoch 9/50, Train Loss: 35.0134, Val Loss: 38.6853
2025-04-15 20:11:40,266 - INFO - Epoch 10/50, Train Loss: 31.9342, Val Loss: 37.4116
2025-04-15 20:11:41,110 - INFO - Epoch 11/50, Train Loss: 35.0071, Val Loss: 36.3482
2025-04-15 20:11:41,961 - INFO - Epoch 12/50, Train Loss: 31.3715, Val Loss: 30.7218
2025-04-15 20:11:42,785 - INFO - Epoch 13/50, Train Loss: 30.2232, Val Loss: 34.4320
2025-04-15 20:11:43,638 - INFO - Epoch 14/50, Train Loss: 27.6816, Val Loss: 29.9584
2025-04-15 20:11:44,506 - INFO - Epoch 15/50, Train Loss: 24.5384, Val Loss: 27.9904
2025-04-15 20:11:45,354 - INFO - Epoch 16/50, Train Loss: 22.9130, Val Loss: 27.3819
2025-04-15 20:11:46,209 - INFO - Epoch 17/50, Train Loss: 21.8623, Val Loss: 26.5928
2025-04-15 20:11:47,064 - INFO - Epoch 18/50, Train Loss: 22.3068, Val Loss: 26.6307
2025-04-15 20:11:47,910 - INFO - Epoch 19/50, Train Loss: 21.7501, Val Loss: 27.1930
2025-04-15 20:11:48,768 - INFO - Epoch 20/50, Train Loss: 22.4616, Val Loss: 28.2404
2025-04-15 20:11:49,620 - INFO - Epoch 21/50, Train Loss: 22.5331, Val Loss: 29.0625
2025-04-15 20:11:50,487 - INFO - Epoch 22/50, Train Loss: 24.2303, Val Loss: 27.5603
2025-04-15 20:11:51,338 - INFO - Epoch 23/50, Train Loss: 22.5865, Val Loss: 32.7030
2025-04-15 20:11:52,180 - INFO - Epoch 24/50, Train Loss: 22.8777, Val Loss: 26.9875
2025-04-15 20:11:53,029 - INFO - Epoch 25/50, Train Loss: 18.5279, Val Loss: 28.0880
2025-04-15 20:11:53,878 - INFO - Epoch 26/50, Train Loss: 18.4359, Val Loss: 26.7658
2025-04-15 20:11:54,731 - INFO - Epoch 27/50, Train Loss: 17.5164, Val Loss: 27.0282
2025-04-15 20:11:54,731 - INFO - Early stopping at epoch 27. Best epoch: 17
2025-04-15 20:11:55,550 - INFO - Validation metrics - Horizontal: 23.14km, Depth: 10.92km, 3D: 26.59km
[I 2025-04-15 20:11:55,584] Trial 29 finished with value: 23.137096405029297 and parameters: {'time_window': 336, 'spatial_threshold': 50, 'min_connections': 2, 'gnn_type': 'gat', 'hidden_dim': 256, 'num_layers': 5, 'learning_rate': 0.0007860825720974972, 'batch_size': 32, 'weight_decay': 5.0990973178530225e-05}. Best is trial 22 with value: 19.460182189941406.
2025-04-15 20:11:55,584 - INFO - 
Optimization completed in 0.20 hours
2025-04-15 20:11:55,584 - INFO - 
Best hyperparameters:
2025-04-15 20:11:55,589 - INFO -   time_window: 120
2025-04-15 20:11:55,589 - INFO -   spatial_threshold: 75
2025-04-15 20:11:55,589 - INFO -   min_connections: 5
2025-04-15 20:11:55,589 - INFO -   gnn_type: gat
2025-04-15 20:11:55,589 - INFO -   hidden_dim: 128
2025-04-15 20:11:55,589 - INFO -   num_layers: 3
2025-04-15 20:11:55,589 - INFO -   learning_rate: 0.0026154033981211277
2025-04-15 20:11:55,589 - INFO -   batch_size: 8
2025-04-15 20:11:55,589 - INFO -   weight_decay: 6.4617557814088705e-06
2025-04-15 20:11:55,594 - INFO - 
Best validation error: 19.46 km
2025-04-15 20:11:55,611 - INFO - Creating visualizations...
2025-04-15 20:11:55,693 - ERROR - Error creating visualizations: Tried to import 'plotly' but failed. Please make sure that the package is installed correctly to use this feature. Actual error: No module named 'plotly'.
2025-04-15 20:11:55,693 - INFO - Optimization results saved.
2025-04-15 20:11:55,693 - INFO - 
Training final model with best parameters...
2025-04-15 20:11:55,737 - INFO - Creating graphs with best parameters...
Created 389 causal graphs
First graph has 3 nodes and 2 edges
Chronological split - Train: 272, Val: 58, Test: 59 graphs
Creating causal relative spatiotemporal graphs (time window: 120h, spatial threshold: 75km)...
0
Reference event coordinates: Lat=-19.9858, Lon=-70.5115, Depth=37.91km
Computing relative coordinates...
Extracting waveform features for nodes...
  0%|          | 0/411 [00:00<?, ?it/s]  3%|▎         | 14/411 [00:00<00:02, 137.13it/s]  7%|▋         | 29/411 [00:00<00:02, 139.87it/s] 10%|█         | 43/411 [00:00<00:02, 138.92it/s] 14%|█▍        | 57/411 [00:00<00:02, 135.54it/s] 17%|█▋        | 71/411 [00:00<00:02, 136.05it/s] 21%|██        | 85/411 [00:00<00:02, 134.36it/s] 24%|██▍       | 100/411 [00:00<00:02, 135.83it/s] 28%|██▊       | 114/411 [00:00<00:02, 133.12it/s] 31%|███       | 128/411 [00:00<00:02, 131.09it/s] 35%|███▍      | 142/411 [00:01<00:02, 129.42it/s] 38%|███▊      | 156/411 [00:01<00:01, 129.45it/s] 41%|████      | 169/411 [00:01<00:01, 127.34it/s] 44%|████▍     | 182/411 [00:01<00:01, 127.74it/s] 48%|████▊     | 196/411 [00:01<00:01, 129.04it/s] 51%|█████     | 210/411 [00:01<00:01, 130.10it/s] 55%|█████▍    | 224/411 [00:01<00:01, 128.11it/s] 58%|█████▊    | 238/411 [00:01<00:01, 129.76it/s] 61%|██████▏   | 252/411 [00:01<00:01, 129.53it/s] 65%|██████▍   | 267/411 [00:02<00:01, 133.04it/s] 68%|██████▊   | 281/411 [00:02<00:00, 133.71it/s] 72%|███████▏  | 295/411 [00:02<00:00, 132.45it/s] 75%|███████▌  | 309/411 [00:02<00:00, 128.60it/s] 78%|███████▊  | 322/411 [00:02<00:00, 126.71it/s] 82%|████████▏ | 335/411 [00:02<00:00, 124.96it/s] 85%|████████▍ | 348/411 [00:02<00:00, 123.22it/s] 88%|████████▊ | 362/411 [00:02<00:00, 127.58it/s] 91%|█████████ | 375/411 [00:02<00:00, 126.53it/s] 94%|█████████▍| 388/411 [00:02<00:00, 125.46it/s] 98%|█████████▊| 402/411 [00:03<00:00, 129.02it/s]100%|██████████| 411/411 [00:03<00:00, 129.90it/s]
  0%|          | 0/409 [00:00<?, ?it/s] 14%|█▍        | 57/409 [00:00<00:00, 567.47it/s] 28%|██▊       | 114/409 [00:00<00:00, 555.70it/s] 42%|████▏     | 170/409 [00:00<00:00, 461.17it/s] 53%|█████▎    | 218/409 [00:00<00:00, 387.42it/s] 63%|██████▎   | 259/409 [00:00<00:00, 347.10it/s] 72%|███████▏  | 296/409 [00:00<00:00, 290.57it/s] 80%|███████▉  | 327/409 [00:01<00:00, 249.63it/s] 87%|████████▋ | 354/409 [00:01<00:00, 233.00it/s] 93%|█████████▎| 379/409 [00:01<00:00, 226.58it/s] 99%|█████████▊| 403/409 [00:01<00:00, 229.61it/s]100%|██████████| 409/409 [00:01<00:00, 292.15it/s]
2025-04-15 20:12:00,336 - INFO - Created 335 graphs for final model
2025-04-15 20:12:00,342 - ERROR - Error training final model: RelativeGNNAftershockPredictor.__init__() got an unexpected keyword argument 'time_window'
2025-04-15 20:12:00,343 - ERROR - Traceback (most recent call last):
  File "/home/kalvisuser/sandbox/gnn-aftershock/new/hyperparameter.py", line 245, in main
    final_model = RelativeGNNAftershockPredictor(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: RelativeGNNAftershockPredictor.__init__() got an unexpected keyword argument 'time_window'

2025-04-15 20:12:00,343 - INFO - Hyperparameter optimization process complete.
Created 335 causal graphs
First graph has 6 nodes and 5 edges
